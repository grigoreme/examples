{"version":3,"sources":["webpack://dojo2_todo_mvc/./src/main.ts","webpack://dojo2_todo_mvc/d.ts","webpack://dojo2_todo_mvc/WidgetBase.ts","webpack://dojo2_todo_mvc/Map.ts","webpack://dojo2_todo_mvc/Themed.ts","webpack://dojo2_todo_mvc/Registry.ts","webpack://dojo2_todo_mvc/Evented.ts","webpack://dojo2_todo_mvc/handleDecorator.ts","webpack://dojo2_todo_mvc/WeakMap.ts","webpack://dojo2_todo_mvc/iterator.ts","webpack://dojo2_todo_mvc/diff.ts","webpack://dojo2_todo_mvc/Promise.ts","webpack://dojo2_todo_mvc/beforeProperties.ts","webpack://dojo2_todo_mvc/diffProperty.ts","webpack://dojo2_todo_mvc/Outlet.ts","webpack://dojo2_todo_mvc/vdom.ts","webpack://dojo2_todo_mvc/string.ts","webpack://dojo2_todo_mvc/cssTransitions.ts","webpack://dojo2_todo_mvc/object.ts","webpack://dojo2_todo_mvc/Destroyable.ts","webpack://dojo2_todo_mvc/RegistryHandler.ts","webpack://dojo2_todo_mvc/NodeHandler.ts","webpack://dojo2_todo_mvc/RouterInjector.ts","webpack://dojo2_todo_mvc/Router.ts","webpack://dojo2_todo_mvc/QueuingEvented.ts","webpack://dojo2_todo_mvc/HashHistory.ts","webpack://dojo2_todo_mvc/./src/widgets/TodoApp.ts","webpack://dojo2_todo_mvc/util.ts","webpack://dojo2_todo_mvc/Injector.ts","webpack://dojo2_todo_mvc/inject.ts","webpack://dojo2_todo_mvc/alwaysRender.ts","webpack://dojo2_todo_mvc/./src/widgets/TodoHeader.ts","webpack://dojo2_todo_mvc/./src/widgets/styles/todoHeader.m.css","webpack://dojo2_todo_mvc/./src/widgets/TodoList.ts","webpack://dojo2_todo_mvc/array.ts","webpack://dojo2_todo_mvc/number.ts","webpack://dojo2_todo_mvc/./src/widgets/styles/todoList.m.css","webpack://dojo2_todo_mvc/./src/widgets/TodoItem.ts?85b8","webpack://dojo2_todo_mvc/./src/widgets/styles/todoApp.m.css","webpack://dojo2_todo_mvc/./src/widgets/TodoFooter.ts?7a63"],"names":["vdom_1","__webpack_require__","d_1","RouterInjector_1","TodoApp_1","registry","default","registerRouterInjector","path","outlet","defaultParams","filter","defaultRoute","w","mount","isWNode","child","Boolean","type","exports","WNODE","isVNode","VNODE","DOMVNODE","isElementNode","value","tagName","isDomVNode","decorate","dNodes","optionsOrModifier","predicate","modifier","shallow","nodes","Array","isArray","tslib_1","__spread","breaker","length","node","shift","children","widgetConstructorOrNode","properties","__assign","widgetConstructor","v","tag","propertiesOrChildren","undefined","deferredPropertiesCallback","_a","classes","_b","styles","newProperties","__rest","_c","_d","nodeClasses","_e","nodeStyles","nodeProperties","originalProperties","dom","attrs","props","on","diffType","onAttach","toLowerCase","attributes","events","domNode","text","data","Map_1","WeakMap_1","diff_1","RegistryHandler_1","NodeHandler_1","Registry_1","lazyWidgetId","lazyWidgetIdMap","decoratorMap","builtDecoratorMap","widgetInstanceMap","boundAuto","auto","bind","noBind","WidgetBase","_this","this","_initialProperties","_changedPropertyKeys","_nodeHandler","_handles","_children","_decoratorCache","_properties","_boundRenderFunc","render","_boundInvalidate","invalidate","set","dirty","onDetach","destroy","nodeHandler","rendering","inputProperties","own","delete","clear","_runAfterConstructors","prototype","meta","MetaType","_metaMap","cached","get","Object","defineProperty","__setProperties__","instanceData","_runBeforeProperties","registeredDiffPropertyNames","getDecorator","changedPropertyKeys","propertyNames","keys","allProperties","checkedProperties","diffPropertyResults_1","runReactions","i","propertyName","indexOf","push","previousProperty","newProperty","_bindFunctionProperty","diffFunctions","i_1","result","changed","reactionFunctions","executedReactions_1","forEach","reaction","propertyChanged","reactionRun","call","__setChildren__","_filterAndConvert","item","filteredNodes","convertedNodes","isWidgetBaseConstructor","id","define","label","registryItem","has","__render__","_runBeforeRenders","dNode","_runAfterRenders","addDecorator","decoratorKey","hasOwnProperty","decoratorList","constructor","specificDecoratorList","apply","decorators","_buildDecoratorList","allDecorators","instanceMap","unshift","getPrototypeOf","buildDecorators","decoratorCache","property","_bindFunctionPropertyMap","bindInfo","boundFunc","scope","_registry","beforeProperties","reduce","beforePropertiesFunction","beforeRenders","beforeRenderFunction","updatedRender","console","warn","afterRenders","afterRenderFunction","afterRender","isDomMeta","afterConstructors","afterConstructor","handle","pop","_type","WIDGET_BASE_TYPE","iterator_1","global_1","object_1","has_1","Map","iterable","_keys","_values","Symbol","toStringTag","isArrayLike","iterable_1","__values","iterable_1_1","next","done","_indexOfKey","key","length_1","is","index","splice","entries","values","map","ShimIterator","callback","context","length_2","iterator","species","Injector_1","inject_1","handleDecorator_1","diffProperty_1","THEME_KEY","ThemedMixin","Base","_super","Themed","arguments","_registeredBaseThemeKeys","_recalculateClasses","_theme","__extends","theme","_recalculateThemeClasses","className","_getThemeClass","onPropertiesChanged","extraClasses","themeClassName","_baseThemeClassesReverseLookup","resultClassNames","_classes","classNames","extraClass","_registeredBaseTheme","join","baseThemes","finalBaseTheme","baseTheme","currentClassNames","baseClass","createThemeClassesLookup","themeKey","computed","__decorate","diffProperty","inject","name","INJECTED_THEME_KEY","getProperties","handleDecorator","target","registerThemeInjector","themeRegistry","themeInjector","Injector","defineInjector","invalidator","setInvalidator","Promise_1","Evented_1","isWidgetConstructorDefaultExport","Registry","emitLoadedEvent","widgetLabel","emit","action","_widgetRegistry","Error","toString","then","widgetCtor","error","injectorFactory","_injectorRegistry","Evented","injectorItem","injector","promise","getInjector","hasInjector","Destroyable_1","regexMap","isGlobMatch","globString","targetString","regex","RegExp","replace","test","listenersMap","event","methods","method","listener","handles_1","_addListener","listeners","Destroyable","handler","propertyKey","descriptor","startId","WeakMap","DELETED_1","generateName_1","Math","floor","Date","now","random","_name","_frozenEntries","__read","_getFrozenEntryIndex","entry","frozenIndex","TypeError","create","isFrozen","string_1","staticDone","list","_nextIndex","isIterable","_nativeIterator","_list","forOf","thisArg","broken","doBreak","l","char","code","charCodeAt","HIGH_SURROGATE_MIN","HIGH_SURROGATE_MAX","isObjectOrArray","ignore","reference","validOldProperty","validNewProperty","previousKeys","newKeys","some","always","queue_1","ShimPromise","Promise","isThenable","executor","state","isChained","callbacks","whenFinished","settle","newState","resolvedValue","queueMicroTask","count","resolve","onFulfilled","onRejected","reject","all","complete","total","populating","fulfill","finish","race","iterable_2","iterable_2_1","reason","catch","finally","onFinally","diffFunction","reactionFunction","WidgetBase_1","alwaysRender_1","Outlet","onRouterKeyChange","current","routerKey","_handle","renderer","router","outletContext","getOutlet","queryParams","params","isError","isExact","alwaysRender","cssTransitions_1","EMPTY_ARRAY","nodeOperations","NAMESPACE_SVG","NAMESPACE_W3","NAMESPACE_XLINK","isWNodeWrapper","isVNodeWrapper","buildPreviousProperties","propName","attrName","getAttribute","same","dnode1","dnode2","instance","findIndexOfChild","sameAs","start","createClassPropValue","trim","updateAttribute","attrValue","namespace","setAttributeNS","removeAttribute","setAttribute","runEnterAnimation","transitions","enterAnimation","enter","runExitAnimation","exitAnimation","removeDomNode","parentNode","removeChild","exit","arrayFrom","arr","slice","_renderScheduled","parentInvalidate","_mountOptions","sync","merge","transition","document","body","_invalidationQueue","_processQueue","_applicationQueue","_eventMap","_instanceToWrapperMap","_parentWrapperMap","_wrapperSiblingMap","_insertBeforeMap","_afterRenderCallbacks","_deferredRenderCallbacks","_allMergedNodes","nodeOperation","propValue","previousValue","updateEvent","eventName","currentValue","previousEvent","removeEventListener","evt","addEventListener","removeOrphanedEvents","previousProperties","onlyEvents","isEvent","substr","eventCallback","renderedToWrapper","rendered","parent","currentParent","previousItem","requiresInsertBefore","hasPreviousSiblings","depth","wrappedRendered","hasParentWNode","hasCurrentParentChildren","childrenWrappers","insertBefore","renderedItem","wrapper","order","hasAnimations","nextParent","findParentWNodeWrapper","currentNode","parentWNodeWrapper","parentWrapper","findParentDomNode","parentDomNode","runDeferredProperties","properties_1","processProperties","findInsertBefore","searchNode","nextSibling","setValue","domValue","onInputValue","onSelectValue","setProperties","currentProperties","nextWrapper","includesEventsAndAttributes","propNames","propCount","previousClassString","currentClassString","merged","domClasses","split","styleNames","styleCount","j","styleName","newStyleValue","style","lastIndexOf","previousAttributes","attrNames","attrCount","updateAttributes","events_1","_runInvalidationQueue","invalidationQueue","previouslyRendered","sort","a","b","parent_1","sibling","item_1","_updateWidget","_runProcessQueue","_runDomInstructionQueue","_runCallbacks","_process","reverse","parentElement","add","inserted","parent_2","instanceData_1","addRoot","attached","run","requestIdleCallback","setTimeout","runAfterRenderCallbacks","requestAnimationFrame","runDeferredRenderCallbacks","mergeNodes","oldIndex","newIndex","currentLength","nextLength","instructions","currentWrapper","domElement","toUpperCase","mergeNodeIndex","_processMergeNodes","_processOne","widget","childNodes","createElementNS","createElement","createTextNode","_createDom","base","_createWidget","updatedTextNode","ownerDocument","replaceChild","_updateDom","wrappers","_removeDom","_removeWidget","mountOptions","mergedNode","class_1","wrapNodes","util_1","LOW_SURROGATE_MIN","LOW_SURROGATE_MAX","fromCodePoint","String","raw","codePointAt","wrapNative","endsWith","includes","normalize","repeat","startsWith","normalizeSubstringArgs_1","search","position","isEnd","min","max","codePoints","_i","fromCharCode","codeUnits","codePoint","Number","isFinite","RangeError","highSurrogate","lowSurrogate","callSite","substitutions","rawStrings","numSubstitutions","first","second","endPosition","isNaN","Infinity","end","padEnd","padStart","maxLength","fillString","strText","padding","browserSpecificTransitionEndEventName","browserSpecificAnimationEndEventName","initialize","element","determineBrowserStyleNames","runAndCleanUp","startAnimation","finishAnimation","finished","transitionEnd","activeClass","enterAnimationActive","classList","remove","removeNode","exitAnimationActive","Symbol_1","globalObject","assign","getOwnPropertyDescriptor","getOwnPropertyNames","getOwnPropertySymbols","o","match","sources","to","nextSource","nextKey","prop","isSymbol","for","substring","value1","value2","getOwnPropertyDescriptors","previous","noop","destroyed","handles","RegistryHandler","_registryWidgetLabelMap","_registryInjectorLabelMap","baseRegistry","globalPrecedence","_get","getFunctionName","labelMap","registries","registeredLabels","NodeEventType","NodeHandler","_nodeMap","Widget","addProjector","Projector","Router_1","config","options","routerOptions","Router","QueuingEvented_1","HashHistory_1","PARAM","paramRegExp","matchingParams","previousParams","every","_routes","_outletMap","_matchedOutlets","_currentParams","_currentQueryParams","_onChange","requestedPath","_stripLeadingSlash","previousMatchedOutlets","queryParamString","_getQueryParams","routeConfig","segments","routeConfigs","route","matchedRoutes","segments_1","segmentIndex","paramIndex","routeMatch","segment","childRoute","matchedOutletName","matchedRoute","score","matchedOutlet","previousMatchedOutlet","errorOutlet","previousMatchedOutletKeys","HistoryManager","HashHistory","window","_register","_history","onChange","_defaultOutlet","link","setPath","linkPath","fullPath","fullQueryParams","param","fullParams","prefix","outletIdentifier","routes","parentRoute","parsedPath","queryParam","queryParameters","QueuingEvented","_queue","maxEvents","hasMatch","queue","listenerType","queuedType","normalizePath","_window","location","hash","_current","_onChangeFunction","Themed_1","Outlet_1","TodoHeader_1","TodoList_1","css","TodoApp","todos","todoItem","completedCount","updated","uuid","removeTodo","todo","completed","onUpdate","toggleTodo","setTodo","toggleAllTodos","size","editTodo","editing","clearCompleted","updateTodo","allCompleted","activeCount","completedItems","todoapp","addTodo","activeFilter","__autoRegistryItems","TodoFooter","shouldDeepCopyObject","copyArray","array","inherited","_mixin","deep","kwArgs","copied","copiedClone","source","targetValue","guaranteeMinimumTimeout","delay","timerId","startTime","timeoutHandler","delta","clearTimeout","deepAssign","deepMixin","mixin","partial","targetFunction","suppliedArgs","args","concat","debounce","timer","throttle","ran","c","r","payload","_payload","_invalidator","beforeProperties_1","registeredInjectorsMap","registeredInjectors","TodoHeader","newTodoProperties","focus","newTodo","onkeyup","oninput","placeholder","title","onchange","checked","toggleAll","which","module"," _key","array_1","TodoList","todoItems","from","filterName","todoList","TodoItem","number_1","of","copyWithin","fill","find","findIndex","toLength_1","MAX_SAFE_INTEGER","toInteger_1","abs","normalizeOffset_1","arrayLike","mapFunction","arrayLike_1","arrayLike_1_1","items","offset","direction","searchElement","fromIndex","len","currentElement","isInteger","EPSILON","pow","MIN_SAFE_INTEGER","isSafeInteger","e","require","oe","main"],"mappings":"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","file":"main.bf478875a76107e8516d.bundle.js","sourcesContent":["import renderer from '@dojo/framework/widget-core/vdom';\nimport { w } from '@dojo/framework/widget-core/d';\nimport { registerRouterInjector } from '@dojo/framework/routing/RouterInjector';\nimport TodoApp from './widgets/TodoApp';\nimport Registry from '@dojo/framework/widget-core/Registry';\n\nconst registry = new Registry();\nconst router = registerRouterInjector([\n\t{\n\t\tpath: 'filter/{filter}',\n\t\toutlet: 'filter',\n\t\tdefaultParams: { filter: 'all' },\n\t\tdefaultRoute: true\n\t}\n], registry);\n\nconst r = renderer(() => w(TodoApp, {}));\nr.mount({ registry });\n","import {\n\tConstructor,\n\tDefaultWidgetBaseInterface,\n\tDeferredVirtualProperties,\n\tDNode,\n\tVNode,\n\tRegistryLabel,\n\tVNodeProperties,\n\tWidgetBaseInterface,\n\tWNode,\n\tDomOptions,\n\tRenderResult,\n\tDomVNode,\n\tLazyWidget,\n\tLazyDefine\n} from './interfaces';\n\n/**\n * The identifier for a WNode type\n */\nexport const WNODE = '__WNODE_TYPE';\n\n/**\n * The identifier for a VNode type\n */\nexport const VNODE = '__VNODE_TYPE';\n\n/**\n * The identifier for a VNode type created using dom()\n */\nexport const DOMVNODE = '__DOMVNODE_TYPE';\n\n/**\n * Helper function that returns true if the `DNode` is a `WNode` using the `type` property\n */\nexport function isWNode<W extends WidgetBaseInterface = DefaultWidgetBaseInterface>(\n\tchild: DNode<W> | any\n): child is WNode<W> {\n\treturn Boolean(child && child !== true && typeof child !== 'string' && child.type === WNODE);\n}\n\n/**\n * Helper function that returns true if the `DNode` is a `VNode` using the `type` property\n */\nexport function isVNode(child: DNode): child is VNode {\n\treturn Boolean(\n\t\tchild && child !== true && typeof child !== 'string' && (child.type === VNODE || child.type === DOMVNODE)\n\t);\n}\n\n/**\n * Helper function that returns true if the `DNode` is a `VNode` created with `dom()` using the `type` property\n */\nexport function isDomVNode(child: DNode): child is DomVNode {\n\treturn Boolean(child && child !== true && typeof child !== 'string' && child.type === DOMVNODE);\n}\n\nexport function isElementNode(value: any): value is Element {\n\treturn !!value.tagName;\n}\n\n/**\n * Interface for the decorate modifier\n */\nexport interface Modifier<T extends DNode> {\n\t(dNode: T, breaker: () => void): void;\n}\n\n/**\n * The predicate function for decorate\n */\nexport interface Predicate<T extends DNode> {\n\t(dNode: DNode): dNode is T;\n}\n\n/**\n * Decorator options\n */\nexport interface DecorateOptions<T extends DNode> {\n\tmodifier: Modifier<T>;\n\tpredicate?: Predicate<T>;\n\tshallow?: boolean;\n}\n\n/**\n * Generic decorate function for DNodes. The nodes are modified in place based on the provided predicate\n * and modifier functions.\n *\n * The children of each node are flattened and added to the array for decoration.\n *\n * If no predicate is supplied then the modifier will be executed on all nodes. A `breaker` function is passed to the\n * modifier which will drain the nodes array and exit the decoration.\n *\n * When the `shallow` options is set to `true` the only the top node or nodes will be decorated (only supported using\n * `DecorateOptions`).\n */\nexport function decorate<T extends DNode>(dNodes: DNode, options: DecorateOptions<T>): DNode;\nexport function decorate<T extends DNode>(dNodes: DNode[], options: DecorateOptions<T>): DNode[];\nexport function decorate<T extends DNode>(dNodes: DNode | DNode[], options: DecorateOptions<T>): DNode | DNode[];\nexport function decorate<T extends DNode>(dNodes: DNode, modifier: Modifier<T>, predicate: Predicate<T>): DNode;\nexport function decorate<T extends DNode>(dNodes: DNode[], modifier: Modifier<T>, predicate: Predicate<T>): DNode[];\nexport function decorate<T extends DNode>(\n\tdNodes: RenderResult,\n\tmodifier: Modifier<T>,\n\tpredicate: Predicate<T>\n): RenderResult;\nexport function decorate(dNodes: DNode, modifier: Modifier<DNode>): DNode;\nexport function decorate(dNodes: DNode[], modifier: Modifier<DNode>): DNode[];\nexport function decorate(dNodes: RenderResult, modifier: Modifier<DNode>): RenderResult;\nexport function decorate(\n\tdNodes: DNode | DNode[],\n\toptionsOrModifier: Modifier<DNode> | DecorateOptions<DNode>,\n\tpredicate?: Predicate<DNode>\n): DNode | DNode[] {\n\tlet shallow = false;\n\tlet modifier;\n\tif (typeof optionsOrModifier === 'function') {\n\t\tmodifier = optionsOrModifier;\n\t} else {\n\t\tmodifier = optionsOrModifier.modifier;\n\t\tpredicate = optionsOrModifier.predicate;\n\t\tshallow = optionsOrModifier.shallow || false;\n\t}\n\n\tlet nodes = Array.isArray(dNodes) ? [...dNodes] : [dNodes];\n\tfunction breaker() {\n\t\tnodes = [];\n\t}\n\twhile (nodes.length) {\n\t\tconst node = nodes.shift();\n\t\tif (node && node !== true) {\n\t\t\tif (!shallow && (isWNode(node) || isVNode(node)) && node.children) {\n\t\t\t\tnodes = [...nodes, ...node.children];\n\t\t\t}\n\t\t\tif (!predicate || predicate(node)) {\n\t\t\t\tmodifier(node, breaker);\n\t\t\t}\n\t\t}\n\t}\n\treturn dNodes;\n}\n\n/**\n * Wrapper function for calls to create a widget.\n */\nexport function w<W extends WidgetBaseInterface>(\n\tnode: WNode<W>,\n\tproperties: Partial<W['properties']>,\n\tchildren?: W['children']\n): WNode<W>;\nexport function w<W extends WidgetBaseInterface>(\n\twidgetConstructor: Constructor<W> | RegistryLabel | LazyWidget<W> | LazyDefine<W>,\n\tproperties: W['properties'],\n\tchildren?: W['children']\n): WNode<W>;\nexport function w<W extends WidgetBaseInterface>(\n\twidgetConstructorOrNode: Constructor<W> | RegistryLabel | WNode<W> | LazyWidget<W> | LazyDefine<W>,\n\tproperties: W['properties'],\n\tchildren?: W['children']\n): WNode<W> {\n\tif (isWNode(widgetConstructorOrNode)) {\n\t\tproperties = { ...(widgetConstructorOrNode.properties as any), ...(properties as any) };\n\t\tchildren = children ? children : widgetConstructorOrNode.children;\n\t\twidgetConstructorOrNode = widgetConstructorOrNode.widgetConstructor;\n\t}\n\n\treturn {\n\t\tchildren: children || [],\n\t\twidgetConstructor: widgetConstructorOrNode,\n\t\tproperties,\n\t\ttype: WNODE\n\t};\n}\n\n/**\n * Wrapper function for calls to create VNodes.\n */\nexport function v(node: VNode, properties: VNodeProperties, children: undefined | DNode[]): VNode;\nexport function v(node: VNode, properties: VNodeProperties): VNode;\nexport function v(tag: string, children: undefined | DNode[]): VNode;\nexport function v(tag: string, properties: DeferredVirtualProperties | VNodeProperties, children?: DNode[]): VNode;\nexport function v(tag: string): VNode;\nexport function v(\n\ttag: string | VNode,\n\tpropertiesOrChildren: VNodeProperties | DeferredVirtualProperties | DNode[] = {},\n\tchildren: undefined | DNode[] = undefined\n): VNode {\n\tlet properties: VNodeProperties | DeferredVirtualProperties = propertiesOrChildren;\n\tlet deferredPropertiesCallback;\n\n\tif (Array.isArray(propertiesOrChildren)) {\n\t\tchildren = propertiesOrChildren;\n\t\tproperties = {};\n\t}\n\n\tif (typeof properties === 'function') {\n\t\tdeferredPropertiesCallback = properties;\n\t\tproperties = {};\n\t}\n\n\tif (isVNode(tag)) {\n\t\tlet { classes = [], styles = {}, ...newProperties } = properties;\n\t\tlet { classes: nodeClasses = [], styles: nodeStyles = {}, ...nodeProperties } = tag.properties;\n\t\tnodeClasses = Array.isArray(nodeClasses) ? nodeClasses : [nodeClasses];\n\t\tclasses = Array.isArray(classes) ? classes : [classes];\n\t\tstyles = { ...nodeStyles, ...styles };\n\t\tproperties = { ...nodeProperties, ...newProperties, classes: [...nodeClasses, ...classes], styles };\n\t\tchildren = children ? children : tag.children;\n\t\ttag = tag.tag;\n\t}\n\n\treturn {\n\t\ttag,\n\t\tdeferredPropertiesCallback,\n\t\toriginalProperties: {},\n\t\tchildren,\n\t\tproperties,\n\t\ttype: VNODE\n\t};\n}\n\n/**\n * Create a VNode for an existing DOM Node.\n */\nexport function dom(\n\t{ node, attrs = {}, props = {}, on = {}, diffType = 'none', onAttach }: DomOptions,\n\tchildren?: DNode[]\n): DomVNode {\n\treturn {\n\t\ttag: isElementNode(node) ? node.tagName.toLowerCase() : '',\n\t\tproperties: props,\n\t\tattributes: attrs,\n\t\tevents: on,\n\t\tchildren,\n\t\ttype: DOMVNODE,\n\t\tdomNode: node,\n\t\ttext: isElementNode(node) ? undefined : node.data,\n\t\tdiffType,\n\t\tonAttach\n\t};\n}\n","import Map from '../shim/Map';\nimport WeakMap from '../shim/WeakMap';\nimport { v, VNODE, isVNode, isWNode } from './d';\nimport { auto } from './diff';\nimport {\n\tAfterRender,\n\tBeforeProperties,\n\tBeforeRender,\n\tDiffPropertyReaction,\n\tDNode,\n\tDefaultWidgetBaseInterface,\n\tLazyWidget,\n\tRender,\n\tWidgetMetaConstructor,\n\tWidgetBaseInterface,\n\tWidgetProperties,\n\tWNode,\n\tVNode,\n\tLazyDefine,\n\tMetaBase\n} from './interfaces';\nimport RegistryHandler from './RegistryHandler';\nimport NodeHandler from './NodeHandler';\nimport { isWidgetBaseConstructor, WIDGET_BASE_TYPE } from './Registry';\nimport { Handle } from '../core/Destroyable';\nimport { Base } from './meta/Base';\n\ninterface ReactionFunctionConfig {\n\tpropertyName: string;\n\treaction: DiffPropertyReaction;\n}\n\nexport interface WidgetData {\n\tonDetach: () => void;\n\tonAttach: () => void;\n\tdirty: boolean;\n\tnodeHandler: NodeHandler;\n\tinvalidate?: Function;\n\trendering: boolean;\n\tinputProperties: any;\n}\n\nexport type BoundFunctionData = { boundFunc: (...args: any[]) => any; scope: any };\n\nlet lazyWidgetId = 0;\nconst lazyWidgetIdMap = new WeakMap<LazyWidget, string>();\nconst decoratorMap = new WeakMap<Function, Map<string, any[]>>();\nconst builtDecoratorMap = new WeakMap<Function, Map<string, any[]>>();\nexport const widgetInstanceMap = new WeakMap<\n\tWidgetBase<WidgetProperties, DNode<DefaultWidgetBaseInterface>>,\n\tWidgetData\n>();\nconst boundAuto = auto.bind(null);\n\nexport const noBind = '__dojo_no_bind';\n\nfunction toTextVNode(data: any): VNode {\n\treturn {\n\t\ttag: '',\n\t\tproperties: {},\n\t\tchildren: undefined,\n\t\ttext: `${data}`,\n\t\ttype: VNODE\n\t};\n}\n\nfunction isLazyDefine(item: any): item is LazyDefine {\n\treturn Boolean(item && item.label);\n}\n\nfunction isDomMeta(meta: any): meta is Base {\n\treturn Boolean(meta.afterRender);\n}\n\n/**\n * Main widget base for all widgets to extend\n */\nexport class WidgetBase<P = WidgetProperties, C extends DNode = DNode> implements WidgetBaseInterface<P, C> {\n\t/**\n\t * static identifier\n\t */\n\tstatic _type = WIDGET_BASE_TYPE;\n\n\t/**\n\t * children array\n\t */\n\tprivate _children: (C | null)[];\n\n\t/**\n\t * Indicates if it is the initial set properties cycle\n\t */\n\tprivate _initialProperties = true;\n\n\t/**\n\t * internal widget properties\n\t */\n\tprivate _properties: P & WidgetProperties & { [index: string]: any };\n\n\t/**\n\t * Array of property keys considered changed from the previous set properties\n\t */\n\tprivate _changedPropertyKeys: string[] = [];\n\n\t/**\n\t * map of decorators that are applied to this widget\n\t */\n\tprivate _decoratorCache: Map<string, any[]>;\n\n\tprivate _registry: RegistryHandler | undefined;\n\n\t/**\n\t * Map of functions properties for the bound function\n\t */\n\tprivate _bindFunctionPropertyMap: WeakMap<(...args: any[]) => any, BoundFunctionData> | undefined;\n\n\tprivate _metaMap: Map<WidgetMetaConstructor<any>, MetaBase> | undefined;\n\n\tprivate _boundRenderFunc: Render;\n\n\tprivate _boundInvalidate: () => void;\n\n\tprivate _nodeHandler: NodeHandler = new NodeHandler();\n\n\tprivate _handles: Handle[] = [];\n\n\t/**\n\t * @constructor\n\t */\n\tconstructor() {\n\t\tthis._children = [];\n\t\tthis._decoratorCache = new Map<string, any[]>();\n\t\tthis._properties = {} as P;\n\t\tthis._boundRenderFunc = this.render.bind(this);\n\t\tthis._boundInvalidate = this.invalidate.bind(this);\n\n\t\twidgetInstanceMap.set(this, {\n\t\t\tdirty: true,\n\t\t\tonAttach: (): void => {\n\t\t\t\tthis.onAttach();\n\t\t\t},\n\t\t\tonDetach: (): void => {\n\t\t\t\tthis.onDetach();\n\t\t\t\tthis.destroy();\n\t\t\t},\n\t\t\tnodeHandler: this._nodeHandler,\n\t\t\trendering: false,\n\t\t\tinputProperties: {}\n\t\t});\n\n\t\tthis.own({\n\t\t\tdestroy: () => {\n\t\t\t\twidgetInstanceMap.delete(this);\n\t\t\t\tthis._nodeHandler.clear();\n\t\t\t\tthis._nodeHandler.destroy();\n\t\t\t}\n\t\t});\n\n\t\tthis._runAfterConstructors();\n\t}\n\n\tprotected meta<T extends MetaBase>(MetaType: WidgetMetaConstructor<T>): T {\n\t\tif (this._metaMap === undefined) {\n\t\t\tthis._metaMap = new Map<WidgetMetaConstructor<any>, MetaBase>();\n\t\t}\n\t\tlet cached = this._metaMap.get(MetaType);\n\t\tif (!cached) {\n\t\t\tcached = new MetaType({\n\t\t\t\tinvalidate: this._boundInvalidate,\n\t\t\t\tnodeHandler: this._nodeHandler,\n\t\t\t\tbind: this\n\t\t\t});\n\t\t\tthis.own(cached);\n\t\t\tthis._metaMap.set(MetaType, cached);\n\t\t}\n\n\t\treturn cached as T;\n\t}\n\n\tprotected onAttach(): void {\n\t\t// Do nothing by default.\n\t}\n\n\tprotected onDetach(): void {\n\t\t// Do nothing by default.\n\t}\n\n\tpublic get properties(): Readonly<P> & Readonly<WidgetProperties> {\n\t\treturn this._properties;\n\t}\n\n\tpublic get changedPropertyKeys(): string[] {\n\t\treturn [...this._changedPropertyKeys];\n\t}\n\n\tpublic __setProperties__(originalProperties: this['properties'], bind?: WidgetBaseInterface): void {\n\t\tconst instanceData = widgetInstanceMap.get(this);\n\t\tif (instanceData) {\n\t\t\tinstanceData.inputProperties = originalProperties;\n\t\t}\n\t\tconst properties = this._runBeforeProperties(originalProperties);\n\t\tconst registeredDiffPropertyNames = this.getDecorator('registeredDiffProperty');\n\t\tconst changedPropertyKeys: string[] = [];\n\t\tconst propertyNames = Object.keys(properties);\n\n\t\tif (this._initialProperties === false || registeredDiffPropertyNames.length !== 0) {\n\t\t\tconst allProperties = [...propertyNames, ...Object.keys(this._properties)];\n\t\t\tconst checkedProperties: (string | number)[] = [];\n\t\t\tconst diffPropertyResults: any = {};\n\t\t\tlet runReactions = false;\n\n\t\t\tfor (let i = 0; i < allProperties.length; i++) {\n\t\t\t\tconst propertyName = allProperties[i];\n\t\t\t\tif (checkedProperties.indexOf(propertyName) !== -1) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tcheckedProperties.push(propertyName);\n\t\t\t\tconst previousProperty = this._properties[propertyName];\n\t\t\t\tconst newProperty = this._bindFunctionProperty(properties[propertyName], bind);\n\t\t\t\tif (registeredDiffPropertyNames.indexOf(propertyName) !== -1) {\n\t\t\t\t\trunReactions = true;\n\t\t\t\t\tconst diffFunctions = this.getDecorator(`diffProperty:${propertyName}`);\n\t\t\t\t\tfor (let i = 0; i < diffFunctions.length; i++) {\n\t\t\t\t\t\tconst result = diffFunctions[i](previousProperty, newProperty);\n\t\t\t\t\t\tif (result.changed && changedPropertyKeys.indexOf(propertyName) === -1) {\n\t\t\t\t\t\t\tchangedPropertyKeys.push(propertyName);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (propertyName in properties) {\n\t\t\t\t\t\t\tdiffPropertyResults[propertyName] = result.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst result = boundAuto(previousProperty, newProperty);\n\t\t\t\t\tif (result.changed && changedPropertyKeys.indexOf(propertyName) === -1) {\n\t\t\t\t\t\tchangedPropertyKeys.push(propertyName);\n\t\t\t\t\t}\n\t\t\t\t\tif (propertyName in properties) {\n\t\t\t\t\t\tdiffPropertyResults[propertyName] = result.value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (runReactions) {\n\t\t\t\tconst reactionFunctions: ReactionFunctionConfig[] = this.getDecorator('diffReaction');\n\t\t\t\tconst executedReactions: Function[] = [];\n\t\t\t\treactionFunctions.forEach(({ reaction, propertyName }) => {\n\t\t\t\t\tconst propertyChanged = changedPropertyKeys.indexOf(propertyName) !== -1;\n\t\t\t\t\tconst reactionRun = executedReactions.indexOf(reaction) !== -1;\n\t\t\t\t\tif (propertyChanged && !reactionRun) {\n\t\t\t\t\t\treaction.call(this, this._properties, diffPropertyResults);\n\t\t\t\t\t\texecutedReactions.push(reaction);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._properties = diffPropertyResults;\n\t\t\tthis._changedPropertyKeys = changedPropertyKeys;\n\t\t} else {\n\t\t\tthis._initialProperties = false;\n\t\t\tfor (let i = 0; i < propertyNames.length; i++) {\n\t\t\t\tconst propertyName = propertyNames[i];\n\t\t\t\tif (typeof properties[propertyName] === 'function') {\n\t\t\t\t\tproperties[propertyName] = this._bindFunctionProperty(properties[propertyName], bind);\n\t\t\t\t} else {\n\t\t\t\t\tchangedPropertyKeys.push(propertyName);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._changedPropertyKeys = changedPropertyKeys;\n\t\t\tthis._properties = { ...properties };\n\t\t}\n\n\t\tif (this._changedPropertyKeys.length > 0) {\n\t\t\tthis.invalidate();\n\t\t}\n\t}\n\n\tpublic get children(): (C | null)[] {\n\t\treturn this._children;\n\t}\n\n\tpublic __setChildren__(children: (C | null)[]): void {\n\t\tif (this._children.length > 0 || children.length > 0) {\n\t\t\tthis._children = children;\n\t\t\tthis.invalidate();\n\t\t}\n\t}\n\n\tprivate _filterAndConvert(nodes: DNode[]): (WNode | VNode)[];\n\tprivate _filterAndConvert(nodes: DNode): WNode | VNode;\n\tprivate _filterAndConvert(nodes: DNode | DNode[]): (WNode | VNode) | (WNode | VNode)[];\n\tprivate _filterAndConvert(nodes: DNode | DNode[]): (WNode | VNode) | (WNode | VNode)[] {\n\t\tconst isArray = Array.isArray(nodes);\n\t\tconst filteredNodes = Array.isArray(nodes) ? nodes : [nodes];\n\t\tconst convertedNodes: (WNode | VNode)[] = [];\n\t\tfor (let i = 0; i < filteredNodes.length; i++) {\n\t\t\tconst node = filteredNodes[i];\n\t\t\tif (!node || node === true) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (typeof node === 'string') {\n\t\t\t\tconvertedNodes.push(toTextVNode(node));\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (isVNode(node) && node.deferredPropertiesCallback) {\n\t\t\t\tconst properties = node.deferredPropertiesCallback(false);\n\t\t\t\tnode.originalProperties = node.properties;\n\t\t\t\tnode.properties = { ...properties, ...node.properties };\n\t\t\t}\n\t\t\tif (isWNode(node) && !isWidgetBaseConstructor(node.widgetConstructor)) {\n\t\t\t\tif (typeof node.widgetConstructor === 'function') {\n\t\t\t\t\tlet id = lazyWidgetIdMap.get(node.widgetConstructor);\n\t\t\t\t\tif (!id) {\n\t\t\t\t\t\tid = `__lazy_widget_${lazyWidgetId++}`;\n\t\t\t\t\t\tlazyWidgetIdMap.set(node.widgetConstructor, id);\n\t\t\t\t\t\tthis.registry.define(id, node.widgetConstructor);\n\t\t\t\t\t}\n\t\t\t\t\tnode.widgetConstructor = id;\n\t\t\t\t} else if (isLazyDefine(node.widgetConstructor)) {\n\t\t\t\t\tconst { label, registryItem } = node.widgetConstructor;\n\t\t\t\t\tif (!this.registry.has(label)) {\n\t\t\t\t\t\tthis.registry.define(label, registryItem);\n\t\t\t\t\t}\n\t\t\t\t\tnode.widgetConstructor = label;\n\t\t\t\t}\n\n\t\t\t\tnode.widgetConstructor =\n\t\t\t\t\tthis.registry.get<WidgetBase>(node.widgetConstructor) || node.widgetConstructor;\n\t\t\t}\n\t\t\tif (!node.bind) {\n\t\t\t\tnode.bind = this;\n\t\t\t}\n\t\t\tconvertedNodes.push(node);\n\t\t\tif (node.children && node.children.length) {\n\t\t\t\tnode.children = this._filterAndConvert(node.children);\n\t\t\t}\n\t\t}\n\t\treturn isArray ? convertedNodes : convertedNodes[0];\n\t}\n\n\tpublic __render__(): (WNode | VNode) | (WNode | VNode)[] {\n\t\tconst instanceData = widgetInstanceMap.get(this);\n\t\tif (instanceData) {\n\t\t\tinstanceData.dirty = false;\n\t\t}\n\t\tconst render = this._runBeforeRenders();\n\t\tconst dNode = this._filterAndConvert(this._runAfterRenders(render()));\n\t\tthis._nodeHandler.clear();\n\t\treturn dNode;\n\t}\n\n\tpublic invalidate(): void {\n\t\tconst instanceData = widgetInstanceMap.get(this);\n\t\tif (instanceData && instanceData.invalidate) {\n\t\t\tinstanceData.invalidate();\n\t\t}\n\t}\n\n\tprotected render(): DNode | DNode[] {\n\t\treturn v('div', {}, this.children);\n\t}\n\n\t/**\n\t * Function to add decorators to WidgetBase\n\t *\n\t * @param decoratorKey The key of the decorator\n\t * @param value The value of the decorator\n\t */\n\tprotected addDecorator(decoratorKey: string, value: any): void {\n\t\tvalue = Array.isArray(value) ? value : [value];\n\t\tif (this.hasOwnProperty('constructor')) {\n\t\t\tlet decoratorList = decoratorMap.get(this.constructor);\n\t\t\tif (!decoratorList) {\n\t\t\t\tdecoratorList = new Map<string, any[]>();\n\t\t\t\tdecoratorMap.set(this.constructor, decoratorList);\n\t\t\t}\n\n\t\t\tlet specificDecoratorList = decoratorList.get(decoratorKey);\n\t\t\tif (!specificDecoratorList) {\n\t\t\t\tspecificDecoratorList = [];\n\t\t\t\tdecoratorList.set(decoratorKey, specificDecoratorList);\n\t\t\t}\n\t\t\tspecificDecoratorList.push(...value);\n\t\t} else {\n\t\t\tconst decorators = this.getDecorator(decoratorKey);\n\t\t\tthis._decoratorCache.set(decoratorKey, [...decorators, ...value]);\n\t\t}\n\t}\n\n\t/**\n\t * Function to build the list of decorators from the global decorator map.\n\t *\n\t * @param decoratorKey  The key of the decorator\n\t * @return An array of decorator values\n\t * @private\n\t */\n\tprivate _buildDecoratorList(decoratorKey: string): any[] {\n\t\tconst allDecorators = [];\n\n\t\tlet constructor = this.constructor;\n\n\t\twhile (constructor) {\n\t\t\tconst instanceMap = decoratorMap.get(constructor);\n\t\t\tif (instanceMap) {\n\t\t\t\tconst decorators = instanceMap.get(decoratorKey);\n\n\t\t\t\tif (decorators) {\n\t\t\t\t\tallDecorators.unshift(...decorators);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconstructor = Object.getPrototypeOf(constructor);\n\t\t}\n\n\t\tconst buildDecorators = builtDecoratorMap.get(this.constructor) || new Map();\n\t\tbuildDecorators.set(decoratorKey, allDecorators);\n\t\tbuiltDecoratorMap.set(this.constructor, buildDecorators);\n\t\treturn allDecorators;\n\t}\n\n\t/**\n\t * Function to retrieve decorator values\n\t *\n\t * @param decoratorKey The key of the decorator\n\t * @returns An array of decorator values\n\t */\n\tprotected getDecorator(decoratorKey: string): any[] {\n\t\tlet decoratorCache = builtDecoratorMap.get(this.constructor);\n\t\tlet allDecorators =\n\t\t\tthis._decoratorCache.get(decoratorKey) || (decoratorCache && decoratorCache.get(decoratorKey));\n\n\t\tif (allDecorators !== undefined) {\n\t\t\treturn allDecorators;\n\t\t}\n\n\t\tallDecorators = this._buildDecoratorList(decoratorKey);\n\n\t\tallDecorators = [...allDecorators];\n\t\tthis._decoratorCache.set(decoratorKey, allDecorators);\n\t\treturn allDecorators;\n\t}\n\n\t/**\n\t * Binds unbound property functions to the specified `bind` property\n\t *\n\t * @param properties properties to check for functions\n\t */\n\tprivate _bindFunctionProperty(property: any, bind: any): any {\n\t\tif (typeof property === 'function' && !property[noBind] && isWidgetBaseConstructor(property) === false) {\n\t\t\tif (this._bindFunctionPropertyMap === undefined) {\n\t\t\t\tthis._bindFunctionPropertyMap = new WeakMap<\n\t\t\t\t\t(...args: any[]) => any,\n\t\t\t\t\t{ boundFunc: (...args: any[]) => any; scope: any }\n\t\t\t\t>();\n\t\t\t}\n\t\t\tconst bindInfo: Partial<BoundFunctionData> = this._bindFunctionPropertyMap.get(property) || {};\n\t\t\tlet { boundFunc, scope } = bindInfo;\n\n\t\t\tif (boundFunc === undefined || scope !== bind) {\n\t\t\t\tboundFunc = property.bind(bind) as (...args: any[]) => any;\n\t\t\t\tthis._bindFunctionPropertyMap.set(property, { boundFunc, scope: bind });\n\t\t\t}\n\t\t\treturn boundFunc;\n\t\t}\n\t\treturn property;\n\t}\n\n\tpublic get registry(): RegistryHandler {\n\t\tif (this._registry === undefined) {\n\t\t\tthis._registry = new RegistryHandler();\n\t\t\tthis.own(this._registry);\n\t\t\tthis.own(this._registry.on('invalidate', this._boundInvalidate));\n\t\t}\n\t\treturn this._registry;\n\t}\n\n\tprivate _runBeforeProperties(properties: any) {\n\t\tconst beforeProperties: BeforeProperties[] = this.getDecorator('beforeProperties');\n\t\tif (beforeProperties.length > 0) {\n\t\t\treturn beforeProperties.reduce(\n\t\t\t\t(properties, beforePropertiesFunction) => {\n\t\t\t\t\treturn { ...properties, ...beforePropertiesFunction.call(this, properties) };\n\t\t\t\t},\n\t\t\t\t{ ...properties }\n\t\t\t);\n\t\t}\n\t\treturn properties;\n\t}\n\n\t/**\n\t * Run all registered before renders and return the updated render method\n\t */\n\tprivate _runBeforeRenders(): Render {\n\t\tconst beforeRenders = this.getDecorator('beforeRender');\n\n\t\tif (beforeRenders.length > 0) {\n\t\t\treturn beforeRenders.reduce((render: Render, beforeRenderFunction: BeforeRender) => {\n\t\t\t\tconst updatedRender = beforeRenderFunction.call(this, render, this._properties, this._children);\n\t\t\t\tif (!updatedRender) {\n\t\t\t\t\tconsole.warn('Render function not returned from beforeRender, using previous render');\n\t\t\t\t\treturn render;\n\t\t\t\t}\n\t\t\t\treturn updatedRender;\n\t\t\t}, this._boundRenderFunc);\n\t\t}\n\t\treturn this._boundRenderFunc;\n\t}\n\n\t/**\n\t * Run all registered after renders and return the decorated DNodes\n\t *\n\t * @param dNode The DNodes to run through the after renders\n\t */\n\tprivate _runAfterRenders(dNode: DNode | DNode[]): DNode | DNode[] {\n\t\tconst afterRenders = this.getDecorator('afterRender');\n\n\t\tif (afterRenders.length > 0) {\n\t\t\tdNode = afterRenders.reduce((dNode: DNode | DNode[], afterRenderFunction: AfterRender) => {\n\t\t\t\treturn afterRenderFunction.call(this, dNode);\n\t\t\t}, dNode);\n\t\t}\n\n\t\tif (this._metaMap !== undefined) {\n\t\t\tthis._metaMap.forEach((meta) => {\n\t\t\t\tisDomMeta(meta) && meta.afterRender();\n\t\t\t});\n\t\t}\n\n\t\treturn dNode;\n\t}\n\n\tprivate _runAfterConstructors(): void {\n\t\tconst afterConstructors = this.getDecorator('afterConstructor');\n\n\t\tif (afterConstructors.length > 0) {\n\t\t\tafterConstructors.forEach((afterConstructor) => afterConstructor.call(this));\n\t\t}\n\t}\n\n\tprotected own(handle: Handle): void {\n\t\tthis._handles.push(handle);\n\t}\n\n\tprotected destroy() {\n\t\twhile (this._handles.length > 0) {\n\t\t\tconst handle = this._handles.pop();\n\t\t\tif (handle) {\n\t\t\t\thandle.destroy();\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport default WidgetBase;\n","import { isArrayLike, Iterable, IterableIterator, ShimIterator } from './iterator';\nimport global from './global';\nimport { is as objectIs } from './object';\nimport has from '../has/has';\nimport './Symbol';\n\nexport interface Map<K, V> {\n\t/**\n\t * Deletes all keys and their associated values.\n\t */\n\tclear(): void;\n\n\t/**\n\t * Deletes a given key and its associated value.\n\t *\n\t * @param key The key to delete\n\t * @return true if the key exists, false if it does not\n\t */\n\tdelete(key: K): boolean;\n\n\t/**\n\t * Returns an iterator that yields each key/value pair as an array.\n\t *\n\t * @return An iterator for each key/value pair in the instance.\n\t */\n\tentries(): IterableIterator<[K, V]>;\n\n\t/**\n\t * Executes a given function for each map entry. The function\n\t * is invoked with three arguments: the element value, the\n\t * element key, and the associated Map instance.\n\t *\n\t * @param callbackfn The function to execute for each map entry,\n\t * @param thisArg The value to use for `this` for each execution of the calback\n\t */\n\tforEach(callbackfn: (value: V, key: K, map: Map<K, V>) => void, thisArg?: any): void;\n\n\t/**\n\t * Returns the value associated with a given key.\n\t *\n\t * @param key The key to look up\n\t * @return The value if one exists or undefined\n\t */\n\tget(key: K): V | undefined;\n\n\t/**\n\t * Returns an iterator that yields each key in the map.\n\t *\n\t * @return An iterator containing the instance's keys.\n\t */\n\tkeys(): IterableIterator<K>;\n\n\t/**\n\t * Checks for the presence of a given key.\n\t *\n\t * @param key The key to check for\n\t * @return true if the key exists, false if it does not\n\t */\n\thas(key: K): boolean;\n\n\t/**\n\t * Sets the value associated with a given key.\n\t *\n\t * @param key The key to define a value to\n\t * @param value The value to assign\n\t * @return The Map instance\n\t */\n\tset(key: K, value: V): this;\n\n\t/**\n\t * Returns the number of key / value pairs in the Map.\n\t */\n\treadonly size: number;\n\n\t/**\n\t * Returns an iterator that yields each value in the map.\n\t *\n\t * @return An iterator containing the instance's values.\n\t */\n\tvalues(): IterableIterator<V>;\n\n\t/** Returns an iterable of entries in the map. */\n\t[Symbol.iterator](): IterableIterator<[K, V]>;\n\n\treadonly [Symbol.toStringTag]: string;\n}\n\nexport interface MapConstructor {\n\t/**\n\t * Creates a new Map\n\t *\n\t * @constructor\n\t */\n\tnew (): Map<any, any>;\n\n\t/**\n\t * Creates a new Map\n\t *\n\t * @constructor\n\t *\n\t * @param iterator\n\t * Array or iterator containing two-item tuples used to initially populate the map.\n\t * The first item in each tuple corresponds to the key of the map entry.\n\t * The second item corresponds to the value of the map entry.\n\t */\n\tnew <K, V>(iterator?: [K, V][]): Map<K, V>;\n\n\t/**\n\t * Creates a new Map\n\t *\n\t * @constructor\n\t *\n\t * @param iterator\n\t * Array or iterator containing two-item tuples used to initially populate the map.\n\t * The first item in each tuple corresponds to the key of the map entry.\n\t * The second item corresponds to the value of the map entry.\n\t */\n\tnew <K, V>(iterator: Iterable<[K, V]>): Map<K, V>;\n\n\treadonly prototype: Map<any, any>;\n\n\treadonly [Symbol.species]: MapConstructor;\n}\n\nexport let Map: MapConstructor = global.Map;\n\nif (!has('es6-map')) {\n\tMap = class Map<K, V> {\n\t\tprotected readonly _keys: K[] = [];\n\t\tprotected readonly _values: V[] = [];\n\n\t\t/**\n\t\t * An alternative to Array.prototype.indexOf using Object.is\n\t\t * to check for equality. See http://mzl.la/1zuKO2V\n\t\t */\n\t\tprotected _indexOfKey(keys: K[], key: K): number {\n\t\t\tfor (let i = 0, length = keys.length; i < length; i++) {\n\t\t\t\tif (objectIs(keys[i], key)) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\n\t\tstatic [Symbol.species] = Map;\n\n\t\tconstructor(iterable?: ArrayLike<[K, V]> | Iterable<[K, V]>) {\n\t\t\tif (iterable) {\n\t\t\t\tif (isArrayLike(iterable)) {\n\t\t\t\t\tfor (let i = 0; i < iterable.length; i++) {\n\t\t\t\t\t\tconst value = iterable[i];\n\t\t\t\t\t\tthis.set(value[0], value[1]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (const value of iterable) {\n\t\t\t\t\t\tthis.set(value[0], value[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tget size(): number {\n\t\t\treturn this._keys.length;\n\t\t}\n\n\t\tclear(): void {\n\t\t\tthis._keys.length = this._values.length = 0;\n\t\t}\n\n\t\tdelete(key: K): boolean {\n\t\t\tconst index = this._indexOfKey(this._keys, key);\n\t\t\tif (index < 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis._keys.splice(index, 1);\n\t\t\tthis._values.splice(index, 1);\n\t\t\treturn true;\n\t\t}\n\n\t\tentries(): IterableIterator<[K, V]> {\n\t\t\tconst values = this._keys.map(\n\t\t\t\t(key: K, i: number): [K, V] => {\n\t\t\t\t\treturn [key, this._values[i]];\n\t\t\t\t}\n\t\t\t);\n\n\t\t\treturn new ShimIterator(values);\n\t\t}\n\n\t\tforEach(callback: (value: V, key: K, mapInstance: Map<K, V>) => any, context?: {}) {\n\t\t\tconst keys = this._keys;\n\t\t\tconst values = this._values;\n\t\t\tfor (let i = 0, length = keys.length; i < length; i++) {\n\t\t\t\tcallback.call(context, values[i], keys[i], this);\n\t\t\t}\n\t\t}\n\n\t\tget(key: K): V | undefined {\n\t\t\tconst index = this._indexOfKey(this._keys, key);\n\t\t\treturn index < 0 ? undefined : this._values[index];\n\t\t}\n\n\t\thas(key: K): boolean {\n\t\t\treturn this._indexOfKey(this._keys, key) > -1;\n\t\t}\n\n\t\tkeys(): IterableIterator<K> {\n\t\t\treturn new ShimIterator(this._keys);\n\t\t}\n\n\t\tset(key: K, value: V): Map<K, V> {\n\t\t\tlet index = this._indexOfKey(this._keys, key);\n\t\t\tindex = index < 0 ? this._keys.length : index;\n\t\t\tthis._keys[index] = key;\n\t\t\tthis._values[index] = value;\n\t\t\treturn this;\n\t\t}\n\n\t\tvalues(): IterableIterator<V> {\n\t\t\treturn new ShimIterator(this._values);\n\t\t}\n\n\t\t[Symbol.iterator](): IterableIterator<[K, V]> {\n\t\t\treturn this.entries();\n\t\t}\n\n\t\t[Symbol.toStringTag]: 'Map' = 'Map';\n\t};\n}\n\nexport default Map;\n","import { Constructor, WidgetProperties, SupportedClassName } from './../interfaces';\nimport { Registry } from './../Registry';\nimport { Injector } from './../Injector';\nimport { inject } from './../decorators/inject';\nimport { WidgetBase } from './../WidgetBase';\nimport { handleDecorator } from './../decorators/handleDecorator';\nimport { diffProperty } from './../decorators/diffProperty';\nimport { shallow } from './../diff';\n\n/**\n * A lookup object for available class names\n */\nexport type ClassNames = {\n\t[key: string]: string;\n};\n\n/**\n * A lookup object for available widget classes names\n */\nexport interface Theme {\n\t[key: string]: object;\n}\n\n/**\n * Classes property interface\n */\nexport interface Classes {\n\t[widgetKey: string]: {\n\t\t[classKey: string]: SupportedClassName[];\n\t};\n}\n\n/**\n * Properties required for the Themed mixin\n */\nexport interface ThemedProperties<T = ClassNames> extends WidgetProperties {\n\ttheme?: Theme;\n\tclasses?: Classes;\n\textraClasses?: { [P in keyof T]?: string };\n}\n\nconst THEME_KEY = ' _key';\n\nexport const INJECTED_THEME_KEY = '__theme_injector';\n\n/**\n * Interface for the ThemedMixin\n */\nexport interface ThemedMixin<T = ClassNames> {\n\ttheme(classes: SupportedClassName): SupportedClassName;\n\ttheme(classes: SupportedClassName[]): SupportedClassName[];\n\tproperties: ThemedProperties<T>;\n}\n\n/**\n * Decorator for base css classes\n */\nexport function theme(theme: {}) {\n\treturn handleDecorator((target) => {\n\t\ttarget.addDecorator('baseThemeClasses', theme);\n\t});\n}\n\n/**\n * Creates a reverse lookup for the classes passed in via the `theme` function.\n *\n * @param classes The baseClasses object\n * @requires\n */\nfunction createThemeClassesLookup(classes: ClassNames[]): ClassNames {\n\treturn classes.reduce(\n\t\t(currentClassNames, baseClass) => {\n\t\t\tObject.keys(baseClass).forEach((key: string) => {\n\t\t\t\tcurrentClassNames[baseClass[key]] = key;\n\t\t\t});\n\t\t\treturn currentClassNames;\n\t\t},\n\t\t<ClassNames>{}\n\t);\n}\n\n/**\n * Convenience function that is given a theme and an optional registry, the theme\n * injector is defined against the registry, returning the theme.\n *\n * @param theme the theme to set\n * @param themeRegistry registry to define the theme injector against. Defaults\n * to the global registry\n *\n * @returns the theme injector used to set the theme\n */\nexport function registerThemeInjector(theme: any, themeRegistry: Registry): Injector {\n\tconst themeInjector = new Injector(theme);\n\tthemeRegistry.defineInjector(INJECTED_THEME_KEY, (invalidator) => {\n\t\tthemeInjector.setInvalidator(invalidator);\n\t\treturn () => themeInjector.get();\n\t});\n\treturn themeInjector;\n}\n\n/**\n * Function that returns a class decorated with with Themed functionality\n */\n\nexport function ThemedMixin<E, T extends Constructor<WidgetBase<ThemedProperties<E>>>>(\n\tBase: T\n): Constructor<ThemedMixin<E>> & T {\n\t@inject({\n\t\tname: INJECTED_THEME_KEY,\n\t\tgetProperties: (theme: Theme, properties: ThemedProperties): ThemedProperties => {\n\t\t\tif (!properties.theme) {\n\t\t\t\treturn { theme };\n\t\t\t}\n\t\t\treturn {};\n\t\t}\n\t})\n\tabstract class Themed extends Base {\n\t\tpublic abstract properties: ThemedProperties<E>;\n\n\t\t/**\n\t\t * The Themed baseClasses\n\t\t */\n\t\tprivate _registeredBaseTheme: ClassNames | undefined;\n\n\t\t/**\n\t\t * Registered base theme keys\n\t\t */\n\t\tprivate _registeredBaseThemeKeys: string[] = [];\n\n\t\t/**\n\t\t * Reverse lookup of the theme classes\n\t\t */\n\t\tprivate _baseThemeClassesReverseLookup: ClassNames | undefined;\n\n\t\t/**\n\t\t * Indicates if classes meta data need to be calculated.\n\t\t */\n\t\tprivate _recalculateClasses = true;\n\n\t\t/**\n\t\t * Extra classes map\n\t\t */\n\t\tprivate _classes: Classes;\n\n\t\t/**\n\t\t * Loaded theme\n\t\t */\n\t\tprivate _theme: ClassNames = {};\n\n\t\tpublic theme(classes: SupportedClassName): SupportedClassName;\n\t\tpublic theme(classes: SupportedClassName[]): SupportedClassName[];\n\t\tpublic theme(classes: SupportedClassName | SupportedClassName[]): SupportedClassName | SupportedClassName[] {\n\t\t\tif (this._recalculateClasses) {\n\t\t\t\tthis._recalculateThemeClasses();\n\t\t\t}\n\t\t\tif (Array.isArray(classes)) {\n\t\t\t\treturn classes.map((className) => this._getThemeClass(className));\n\t\t\t}\n\t\t\treturn this._getThemeClass(classes);\n\t\t}\n\n\t\t/**\n\t\t * Function fired when `theme` or `extraClasses` are changed.\n\t\t */\n\t\t@diffProperty('theme', shallow)\n\t\t@diffProperty('extraClasses', shallow)\n\t\t@diffProperty('classes', shallow)\n\t\tprotected onPropertiesChanged() {\n\t\t\tthis._recalculateClasses = true;\n\t\t}\n\n\t\tprivate _getThemeClass(className: SupportedClassName): SupportedClassName {\n\t\t\tif (className === undefined || className === null || className === false || className === true) {\n\t\t\t\treturn className;\n\t\t\t}\n\n\t\t\tconst extraClasses = this.properties.extraClasses || ({} as any);\n\t\t\tconst themeClassName = this._baseThemeClassesReverseLookup![className];\n\t\t\tlet resultClassNames: string[] = [];\n\t\t\tif (!themeClassName) {\n\t\t\t\tconsole.warn(`Class name: '${className}' not found in theme`);\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (this._classes) {\n\t\t\t\tconst classes = Object.keys(this._classes).reduce(\n\t\t\t\t\t(classes, key) => {\n\t\t\t\t\t\tconst classNames = Object.keys(this._classes[key]);\n\t\t\t\t\t\tfor (let i = 0; i < classNames.length; i++) {\n\t\t\t\t\t\t\tconst extraClass = this._classes[key][classNames[i]];\n\t\t\t\t\t\t\tif (classNames[i] === themeClassName && extraClass) {\n\t\t\t\t\t\t\t\textraClass.forEach((className) => {\n\t\t\t\t\t\t\t\t\tif (className && className !== true) {\n\t\t\t\t\t\t\t\t\t\tclasses.push(className);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn classes;\n\t\t\t\t\t},\n\t\t\t\t\t[] as string[]\n\t\t\t\t);\n\n\t\t\t\tresultClassNames.push(...classes);\n\t\t\t}\n\n\t\t\tif (extraClasses[themeClassName]) {\n\t\t\t\tresultClassNames.push(extraClasses[themeClassName]);\n\t\t\t}\n\n\t\t\tif (this._theme[themeClassName]) {\n\t\t\t\tresultClassNames.push(this._theme[themeClassName]);\n\t\t\t} else {\n\t\t\t\tresultClassNames.push(this._registeredBaseTheme![themeClassName]);\n\t\t\t}\n\t\t\treturn resultClassNames.join(' ');\n\t\t}\n\n\t\tprivate _recalculateThemeClasses() {\n\t\t\tconst { theme = {}, classes = {} } = this.properties;\n\t\t\tif (!this._registeredBaseTheme) {\n\t\t\t\tconst baseThemes = this.getDecorator('baseThemeClasses');\n\t\t\t\tif (baseThemes.length === 0) {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t'A base theme has not been provided to this widget. Please use the @theme decorator to add a theme.'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis._registeredBaseTheme = baseThemes.reduce((finalBaseTheme, baseTheme) => {\n\t\t\t\t\tconst { [THEME_KEY]: key, ...classes } = baseTheme;\n\t\t\t\t\tthis._registeredBaseThemeKeys.push(key);\n\t\t\t\t\treturn { ...finalBaseTheme, ...classes };\n\t\t\t\t}, {});\n\t\t\t\tthis._baseThemeClassesReverseLookup = createThemeClassesLookup(baseThemes);\n\t\t\t}\n\n\t\t\tthis._theme = this._registeredBaseThemeKeys.reduce((baseTheme, themeKey) => {\n\t\t\t\treturn { ...baseTheme, ...theme[themeKey] };\n\t\t\t}, {});\n\n\t\t\tthis._classes = Object.keys(classes).reduce((computed, key) => {\n\t\t\t\tif (this._registeredBaseThemeKeys.indexOf(key) > -1) {\n\t\t\t\t\tcomputed = { ...computed, [key]: classes[key] };\n\t\t\t\t}\n\t\t\t\treturn computed;\n\t\t\t}, {});\n\n\t\t\tthis._recalculateClasses = false;\n\t\t}\n\t}\n\n\treturn Themed;\n}\n\nexport default ThemedMixin;\n","import Promise from '../shim/Promise';\nimport Map from '../shim/Map';\nimport { Evented, EventObject } from '../core/Evented';\nimport {\n\tConstructor,\n\tInjectorFactory,\n\tInjectorItem,\n\tRegistryLabel,\n\tWidgetBaseConstructor,\n\tWidgetBaseInterface,\n\tESMDefaultWidgetBase,\n\tWidgetBaseConstructorFunction,\n\tESMDefaultWidgetBaseFunction\n} from './interfaces';\n\nexport type RegistryItem =\n\t| WidgetBaseConstructor\n\t| Promise<WidgetBaseConstructor>\n\t| WidgetBaseConstructorFunction\n\t| ESMDefaultWidgetBaseFunction;\n\n/**\n * Widget base type\n */\nexport const WIDGET_BASE_TYPE = '__widget_base_type';\n\nexport interface RegistryEventObject extends EventObject<RegistryLabel> {\n\taction: string;\n\titem: WidgetBaseConstructor | InjectorItem;\n}\n/**\n * Widget Registry Interface\n */\nexport interface RegistryInterface {\n\t/**\n\t * Define a WidgetRegistryItem against a label\n\t *\n\t * @param label The label of the widget to register\n\t * @param registryItem The registry item to define\n\t */\n\tdefine(label: RegistryLabel, registryItem: RegistryItem): void;\n\n\t/**\n\t * Return a RegistryItem for the given label, null if an entry doesn't exist\n\t *\n\t * @param widgetLabel The label of the widget to return\n\t * @returns The RegistryItem for the widgetLabel, `null` if no entry exists\n\t */\n\tget<T extends WidgetBaseInterface = WidgetBaseInterface>(label: RegistryLabel): Constructor<T> | null;\n\n\t/**\n\t * Returns a boolean if an entry for the label exists\n\t *\n\t * @param widgetLabel The label to search for\n\t * @returns boolean indicating if a widget registry item exists\n\t */\n\thas(label: RegistryLabel): boolean;\n\n\t/**\n\t * Define an Injector against a label\n\t *\n\t * @param label The label of the injector to register\n\t * @param registryItem The injector factory\n\t */\n\tdefineInjector(label: RegistryLabel, injectorFactory: InjectorFactory): void;\n\n\t/**\n\t * Return an Injector registry item for the given label, null if an entry doesn't exist\n\t *\n\t * @param label The label of the injector to return\n\t * @returns The RegistryItem for the widgetLabel, `null` if no entry exists\n\t */\n\tgetInjector<T>(label: RegistryLabel): InjectorItem<T> | null;\n\n\t/**\n\t * Returns a boolean if an injector for the label exists\n\t *\n\t * @param widgetLabel The label to search for\n\t * @returns boolean indicating if a injector registry item exists\n\t */\n\thasInjector(label: RegistryLabel): boolean;\n}\n\n/**\n * Checks is the item is a subclass of WidgetBase (or a WidgetBase)\n *\n * @param item the item to check\n * @returns true/false indicating if the item is a WidgetBaseConstructor\n */\nexport function isWidgetBaseConstructor<T extends WidgetBaseInterface>(item: any): item is Constructor<T> {\n\treturn Boolean(item && item._type === WIDGET_BASE_TYPE);\n}\n\nexport function isWidgetConstructorDefaultExport<T>(item: any): item is ESMDefaultWidgetBase<T> {\n\treturn Boolean(\n\t\titem &&\n\t\t\titem.hasOwnProperty('__esModule') &&\n\t\t\titem.hasOwnProperty('default') &&\n\t\t\tisWidgetBaseConstructor(item.default)\n\t);\n}\n\n/**\n * The Registry implementation\n */\nexport class Registry extends Evented<{}, RegistryLabel, RegistryEventObject> implements RegistryInterface {\n\t/**\n\t * internal map of labels and RegistryItem\n\t */\n\tprivate _widgetRegistry: Map<RegistryLabel, RegistryItem> | undefined;\n\n\tprivate _injectorRegistry: Map<RegistryLabel, InjectorItem> | undefined;\n\n\t/**\n\t * Emit loaded event for registry label\n\t */\n\tprivate emitLoadedEvent(widgetLabel: RegistryLabel, item: WidgetBaseConstructor | InjectorItem): void {\n\t\tthis.emit({\n\t\t\ttype: widgetLabel,\n\t\t\taction: 'loaded',\n\t\t\titem\n\t\t});\n\t}\n\n\tpublic define(label: RegistryLabel, item: RegistryItem): void {\n\t\tif (this._widgetRegistry === undefined) {\n\t\t\tthis._widgetRegistry = new Map();\n\t\t}\n\n\t\tif (this._widgetRegistry.has(label)) {\n\t\t\tthrow new Error(`widget has already been registered for '${label.toString()}'`);\n\t\t}\n\n\t\tthis._widgetRegistry.set(label, item);\n\n\t\tif (item instanceof Promise) {\n\t\t\titem.then(\n\t\t\t\t(widgetCtor) => {\n\t\t\t\t\tthis._widgetRegistry!.set(label, widgetCtor);\n\t\t\t\t\tthis.emitLoadedEvent(label, widgetCtor);\n\t\t\t\t\treturn widgetCtor;\n\t\t\t\t},\n\t\t\t\t(error) => {\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t);\n\t\t} else if (isWidgetBaseConstructor(item)) {\n\t\t\tthis.emitLoadedEvent(label, item);\n\t\t}\n\t}\n\n\tpublic defineInjector(label: RegistryLabel, injectorFactory: InjectorFactory): void {\n\t\tif (this._injectorRegistry === undefined) {\n\t\t\tthis._injectorRegistry = new Map();\n\t\t}\n\n\t\tif (this._injectorRegistry.has(label)) {\n\t\t\tthrow new Error(`injector has already been registered for '${label.toString()}'`);\n\t\t}\n\n\t\tconst invalidator = new Evented();\n\n\t\tconst injectorItem: InjectorItem = {\n\t\t\tinjector: injectorFactory(() => invalidator.emit({ type: 'invalidate' })),\n\t\t\tinvalidator\n\t\t};\n\n\t\tthis._injectorRegistry.set(label, injectorItem);\n\t\tthis.emitLoadedEvent(label, injectorItem);\n\t}\n\n\tpublic get<T extends WidgetBaseInterface = WidgetBaseInterface>(label: RegistryLabel): Constructor<T> | null {\n\t\tif (!this._widgetRegistry || !this.has(label)) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst item = this._widgetRegistry.get(label);\n\n\t\tif (isWidgetBaseConstructor<T>(item)) {\n\t\t\treturn item;\n\t\t}\n\n\t\tif (item instanceof Promise) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst promise = (<WidgetBaseConstructorFunction>item)();\n\t\tthis._widgetRegistry.set(label, promise);\n\n\t\tpromise.then(\n\t\t\t(widgetCtor) => {\n\t\t\t\tif (isWidgetConstructorDefaultExport<T>(widgetCtor)) {\n\t\t\t\t\twidgetCtor = widgetCtor.default;\n\t\t\t\t}\n\n\t\t\t\tthis._widgetRegistry!.set(label, widgetCtor);\n\t\t\t\tthis.emitLoadedEvent(label, widgetCtor);\n\t\t\t\treturn widgetCtor;\n\t\t\t},\n\t\t\t(error) => {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t);\n\n\t\treturn null;\n\t}\n\n\tpublic getInjector<T>(label: RegistryLabel): InjectorItem<T> | null {\n\t\tif (!this._injectorRegistry || !this.hasInjector(label)) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this._injectorRegistry.get(label)!;\n\t}\n\n\tpublic has(label: RegistryLabel): boolean {\n\t\treturn Boolean(this._widgetRegistry && this._widgetRegistry.has(label));\n\t}\n\n\tpublic hasInjector(label: RegistryLabel): boolean {\n\t\treturn Boolean(this._injectorRegistry && this._injectorRegistry.has(label));\n\t}\n}\n\nexport default Registry;\n","import Map from '../shim/Map';\nimport { Destroyable, Handle } from './Destroyable';\n\n/**\n * Map of computed regular expressions, keyed by string\n */\nconst regexMap = new Map<string, RegExp>();\n\nexport type EventType = string | symbol;\n\n/**\n * The base event object, which provides a `type` property\n */\nexport interface EventObject<T = EventType> {\n\t/**\n\t * The type of the event\n\t */\n\treadonly type: T;\n}\n\n/**\n * Determines if the event type glob has been matched\n *\n * @returns boolean that indicates if the glob is matched\n */\nexport function isGlobMatch(globString: string | symbol, targetString: string | symbol): boolean {\n\tif (typeof targetString === 'string' && typeof globString === 'string' && globString.indexOf('*') !== -1) {\n\t\tlet regex: RegExp;\n\t\tif (regexMap.has(globString)) {\n\t\t\tregex = regexMap.get(globString)!;\n\t\t} else {\n\t\t\tregex = new RegExp(`^${globString.replace(/\\*/g, '.*')}$`);\n\t\t\tregexMap.set(globString, regex);\n\t\t}\n\t\treturn regex.test(targetString);\n\t} else {\n\t\treturn globString === targetString;\n\t}\n}\n\nexport type EventedCallback<T = EventType, E extends EventObject<T> = EventObject<T>> = {\n\t/**\n\t * A callback that takes an `event` argument\n\t *\n\t * @param event The event object\n\t */\n\n\t(event: E): boolean | void;\n};\n\nexport interface CustomEventTypes<T extends EventObject<any> = EventObject<any>> {\n\t[index: string]: T;\n}\n\n/**\n * A type which is either a targeted event listener or an array of listeners\n * @template T The type of target for the events\n * @template E The event type for the events\n */\nexport type EventedCallbackOrArray<T = EventType, E extends EventObject<T> = EventObject<T>> =\n\t| EventedCallback<T, E>\n\t| EventedCallback<T, E>[];\n\n/**\n * Event Class\n */\nexport class Evented<\n\tM extends CustomEventTypes = {},\n\tT = EventType,\n\tO extends EventObject<T> = EventObject<T>\n> extends Destroyable {\n\t// The following member is purely so TypeScript remembers the type of `M` when extending so\n\t// that the utilities in `on.ts` will work https://github.com/Microsoft/TypeScript/issues/20348\n\t// tslint:disable-next-line\n\tprotected __typeMap__?: M;\n\t/**\n\t * map of listeners keyed by event type\n\t */\n\tprotected listenersMap: Map<T | keyof M, EventedCallback<T, O>[]> = new Map();\n\n\t/**\n\t * Emits the event object for the specified type\n\t *\n\t * @param event the event to emit\n\t */\n\temit<K extends keyof M>(event: M[K]): void;\n\temit(event: O): void;\n\temit(event: any): void {\n\t\tthis.listenersMap.forEach((methods, type) => {\n\t\t\tif (isGlobMatch(type as any, event.type)) {\n\t\t\t\t[...methods].forEach((method) => {\n\t\t\t\t\tmethod.call(this, event);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Catch all handler for various call signatures. The signatures are defined in\n\t * `BaseEventedEvents`.  You can add your own event type -> handler types by extending\n\t * `BaseEventedEvents`.  See example for details.\n\t *\n\t * @param args\n\t *\n\t * @example\n\t *\n\t * interface WidgetBaseEvents extends BaseEventedEvents {\n\t *     (type: 'properties:changed', handler: PropertiesChangedHandler): Handle;\n\t * }\n\t * class WidgetBase extends Evented {\n\t *    on: WidgetBaseEvents;\n\t * }\n\t *\n\t * @return {any}\n\t */\n\ton<K extends keyof M>(type: K, listener: EventedCallbackOrArray<K, M[K]>): Handle;\n\ton(type: T, listener: EventedCallbackOrArray<T, O>): Handle;\n\ton(type: any, listener: EventedCallbackOrArray<any, any>): Handle {\n\t\tif (Array.isArray(listener)) {\n\t\t\tconst handles = listener.map((listener) => this._addListener(type, listener));\n\t\t\treturn {\n\t\t\t\tdestroy() {\n\t\t\t\t\thandles.forEach((handle) => handle.destroy());\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\treturn this._addListener(type, listener);\n\t}\n\n\tprivate _addListener(type: T | keyof M, listener: EventedCallback<T, O>) {\n\t\tconst listeners = this.listenersMap.get(type) || [];\n\t\tlisteners.push(listener);\n\t\tthis.listenersMap.set(type, listeners);\n\t\treturn {\n\t\t\tdestroy: () => {\n\t\t\t\tconst listeners = this.listenersMap.get(type) || [];\n\t\t\t\tlisteners.splice(listeners.indexOf(listener), 1);\n\t\t\t}\n\t\t};\n\t}\n}\n\nexport default Evented;\n","export type DecoratorHandler = (target: any, propertyKey?: string) => void;\n\n/**\n * Generic decorator handler to take care of whether or not the decorator was called at the class level\n * or the method level.\n *\n * @param handler\n */\nexport function handleDecorator(handler: DecoratorHandler) {\n\treturn function(target: any, propertyKey?: string, descriptor?: PropertyDescriptor) {\n\t\tif (typeof target === 'function') {\n\t\t\thandler(target.prototype, undefined);\n\t\t} else {\n\t\t\thandler(target, propertyKey);\n\t\t}\n\t};\n}\n\nexport default handleDecorator;\n","import global from './global';\nimport { isArrayLike, Iterable } from './iterator';\nimport has from '../has/has';\nimport './Symbol';\n\nexport interface WeakMap<K extends object, V> {\n\t/**\n\t * Remove a `key` from the map\n\t *\n\t * @param key The key to remove\n\t * @return `true` if the value was removed, otherwise `false`\n\t */\n\tdelete(key: K): boolean;\n\n\t/**\n\t * Retrieve the value, based on the supplied `key`\n\t *\n\t * @param key The key to retrieve the `value` for\n\t * @return the `value` based on the `key` if found, otherwise `false`\n\t */\n\tget(key: K): V | undefined;\n\n\t/**\n\t * Determines if a `key` is present in the map\n\t *\n\t * @param key The `key` to check\n\t * @return `true` if the key is part of the map, otherwise `false`.\n\t */\n\thas(key: K): boolean;\n\n\t/**\n\t * Set a `value` for a particular `key`.\n\t *\n\t * @param key The `key` to set the `value` for\n\t * @param value The `value` to set\n\t * @return the instances\n\t */\n\tset(key: K, value: V): this;\n\n\treadonly [Symbol.toStringTag]: 'WeakMap';\n}\n\nexport interface WeakMapConstructor {\n\t/**\n\t * Create a new instance of a `WeakMap`\n\t *\n\t * @constructor\n\t */\n\tnew (): WeakMap<object, any>;\n\n\t/**\n\t * Create a new instance of a `WeakMap`\n\t *\n\t * @constructor\n\t *\n\t * @param iterable An iterable that contains yields up key/value pair entries\n\t */\n\tnew <K extends object, V>(iterable?: [K, V][]): WeakMap<K, V>;\n\n\t/**\n\t * Create a new instance of a `WeakMap`\n\t *\n\t * @constructor\n\t *\n\t * @param iterable An iterable that contains yields up key/value pair entries\n\t */\n\tnew <K extends object, V>(iterable: Iterable<[K, V]>): WeakMap<K, V>;\n\n\treadonly prototype: WeakMap<object, any>;\n}\n\nexport let WeakMap: WeakMapConstructor = global.WeakMap;\n\ninterface Entry<K, V> {\n\tkey: K;\n\tvalue: V;\n}\n\nif (!has('es6-weakmap')) {\n\tconst DELETED: any = {};\n\n\tconst getUID = function getUID(): number {\n\t\treturn Math.floor(Math.random() * 100000000);\n\t};\n\n\tconst generateName = (function() {\n\t\tlet startId = Math.floor(Date.now() % 100000000);\n\n\t\treturn function generateName(): string {\n\t\t\treturn '__wm' + getUID() + (startId++ + '__');\n\t\t};\n\t})();\n\n\tWeakMap = class WeakMap<K, V> {\n\t\tprivate readonly _name: string;\n\t\tprivate readonly _frozenEntries: Entry<K, V>[];\n\n\t\tconstructor(iterable?: ArrayLike<[K, V]> | Iterable<[K, V]>) {\n\t\t\tthis._name = generateName();\n\n\t\t\tthis._frozenEntries = [];\n\n\t\t\tif (iterable) {\n\t\t\t\tif (isArrayLike(iterable)) {\n\t\t\t\t\tfor (let i = 0; i < iterable.length; i++) {\n\t\t\t\t\t\tconst item = iterable[i];\n\t\t\t\t\t\tthis.set(item[0], item[1]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (const [key, value] of iterable) {\n\t\t\t\t\t\tthis.set(key, value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprivate _getFrozenEntryIndex(key: any): number {\n\t\t\tfor (let i = 0; i < this._frozenEntries.length; i++) {\n\t\t\t\tif (this._frozenEntries[i].key === key) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn -1;\n\t\t}\n\n\t\tdelete(key: any): boolean {\n\t\t\tif (key === undefined || key === null) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst entry: Entry<K, V> = key[this._name];\n\t\t\tif (entry && entry.key === key && entry.value !== DELETED) {\n\t\t\t\tentry.value = DELETED;\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst frozenIndex = this._getFrozenEntryIndex(key);\n\t\t\tif (frozenIndex >= 0) {\n\t\t\t\tthis._frozenEntries.splice(frozenIndex, 1);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tget(key: any): V | undefined {\n\t\t\tif (key === undefined || key === null) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst entry: Entry<K, V> = key[this._name];\n\t\t\tif (entry && entry.key === key && entry.value !== DELETED) {\n\t\t\t\treturn entry.value;\n\t\t\t}\n\n\t\t\tconst frozenIndex = this._getFrozenEntryIndex(key);\n\t\t\tif (frozenIndex >= 0) {\n\t\t\t\treturn this._frozenEntries[frozenIndex].value;\n\t\t\t}\n\t\t}\n\n\t\thas(key: any): boolean {\n\t\t\tif (key === undefined || key === null) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst entry: Entry<K, V> = key[this._name];\n\t\t\tif (Boolean(entry && entry.key === key && entry.value !== DELETED)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst frozenIndex = this._getFrozenEntryIndex(key);\n\t\t\tif (frozenIndex >= 0) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tset(key: any, value?: any): this {\n\t\t\tif (!key || (typeof key !== 'object' && typeof key !== 'function')) {\n\t\t\t\tthrow new TypeError('Invalid value used as weak map key');\n\t\t\t}\n\t\t\tlet entry: Entry<K, V> = key[this._name];\n\t\t\tif (!entry || entry.key !== key) {\n\t\t\t\tentry = Object.create(null, {\n\t\t\t\t\tkey: { value: key }\n\t\t\t\t});\n\n\t\t\t\tif (Object.isFrozen(key)) {\n\t\t\t\t\tthis._frozenEntries.push(entry);\n\t\t\t\t} else {\n\t\t\t\t\tObject.defineProperty(key, this._name, {\n\t\t\t\t\t\tvalue: entry\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tentry.value = value;\n\t\t\treturn this;\n\t\t}\n\n\t\t[Symbol.toStringTag]: 'WeakMap' = 'WeakMap';\n\t};\n}\n\nexport default WeakMap;\n","import './Symbol';\nimport { HIGH_SURROGATE_MAX, HIGH_SURROGATE_MIN } from './string';\n\nexport interface IteratorResult<T> {\n\treadonly done: boolean;\n\treadonly value: T;\n}\n\nexport interface Iterator<T> {\n\tnext(value?: any): IteratorResult<T>;\n\n\treturn?(value?: any): IteratorResult<T>;\n\n\tthrow?(e?: any): IteratorResult<T>;\n}\n\nexport interface Iterable<T> {\n\t[Symbol.iterator](): Iterator<T>;\n}\n\nexport interface IterableIterator<T> extends Iterator<T> {\n\t[Symbol.iterator](): IterableIterator<T>;\n}\n\nconst staticDone: IteratorResult<any> = { done: true, value: undefined };\n\n/**\n * A class that _shims_ an iterator interface on array like objects.\n */\nexport class ShimIterator<T> {\n\tprivate _list: ArrayLike<T> | undefined;\n\tprivate _nextIndex = -1;\n\tprivate _nativeIterator: Iterator<T> | undefined;\n\n\tconstructor(list: ArrayLike<T> | Iterable<T>) {\n\t\tif (isIterable(list)) {\n\t\t\tthis._nativeIterator = list[Symbol.iterator]();\n\t\t} else {\n\t\t\tthis._list = list;\n\t\t}\n\t}\n\n\t/**\n\t * Return the next iteration result for the Iterator\n\t */\n\tnext(): IteratorResult<T> {\n\t\tif (this._nativeIterator) {\n\t\t\treturn this._nativeIterator.next();\n\t\t}\n\t\tif (!this._list) {\n\t\t\treturn staticDone;\n\t\t}\n\t\tif (++this._nextIndex < this._list.length) {\n\t\t\treturn {\n\t\t\t\tdone: false,\n\t\t\t\tvalue: this._list[this._nextIndex]\n\t\t\t};\n\t\t}\n\t\treturn staticDone;\n\t}\n\n\t[Symbol.iterator](): IterableIterator<T> {\n\t\treturn this;\n\t}\n}\n\n/**\n * A type guard for checking if something has an Iterable interface\n *\n * @param value The value to type guard against\n */\nexport function isIterable(value: any): value is Iterable<any> {\n\treturn value && typeof value[Symbol.iterator] === 'function';\n}\n\n/**\n * A type guard for checking if something is ArrayLike\n *\n * @param value The value to type guard against\n */\nexport function isArrayLike(value: any): value is ArrayLike<any> {\n\treturn value && typeof value.length === 'number';\n}\n\n/**\n * Returns the iterator for an object\n *\n * @param iterable The iterable object to return the iterator for\n */\nexport function get<T>(iterable: Iterable<T> | ArrayLike<T>): Iterator<T> | undefined {\n\tif (isIterable(iterable)) {\n\t\treturn iterable[Symbol.iterator]();\n\t} else if (isArrayLike(iterable)) {\n\t\treturn new ShimIterator(iterable);\n\t}\n}\n\nexport interface ForOfCallback<T> {\n\t/**\n\t * A callback function for a forOf() iteration\n\t *\n\t * @param value The current value\n\t * @param object The object being iterated over\n\t * @param doBreak A function, if called, will stop the iteration\n\t */\n\t(value: T, object: Iterable<T> | ArrayLike<T> | string, doBreak: () => void): void;\n}\n\n/**\n * Shims the functionality of `for ... of` blocks\n *\n * @param iterable The object the provides an interator interface\n * @param callback The callback which will be called for each item of the iterable\n * @param thisArg Optional scope to pass the callback\n */\nexport function forOf<T>(\n\titerable: Iterable<T> | ArrayLike<T> | string,\n\tcallback: ForOfCallback<T>,\n\tthisArg?: any\n): void {\n\tlet broken = false;\n\n\tfunction doBreak() {\n\t\tbroken = true;\n\t}\n\n\t/* We need to handle iteration of double byte strings properly */\n\tif (isArrayLike(iterable) && typeof iterable === 'string') {\n\t\tconst l = iterable.length;\n\t\tfor (let i = 0; i < l; ++i) {\n\t\t\tlet char = iterable[i];\n\t\t\tif (i + 1 < l) {\n\t\t\t\tconst code = char.charCodeAt(0);\n\t\t\t\tif (code >= HIGH_SURROGATE_MIN && code <= HIGH_SURROGATE_MAX) {\n\t\t\t\t\tchar += iterable[++i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tcallback.call(thisArg, char, iterable, doBreak);\n\t\t\tif (broken) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tconst iterator = get(iterable);\n\t\tif (iterator) {\n\t\t\tlet result = iterator.next();\n\n\t\t\twhile (!result.done) {\n\t\t\t\tcallback.call(thisArg, result.value, iterable, doBreak);\n\t\t\t\tif (broken) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tresult = iterator.next();\n\t\t\t}\n\t\t}\n\t}\n}\n","import { PropertyChangeRecord } from './interfaces';\nimport { WIDGET_BASE_TYPE } from './Registry';\n\nfunction isObjectOrArray(value: any): boolean {\n\treturn Object.prototype.toString.call(value) === '[object Object]' || Array.isArray(value);\n}\n\nexport function always(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\treturn {\n\t\tchanged: true,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function ignore(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\treturn {\n\t\tchanged: false,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function reference(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\treturn {\n\t\tchanged: previousProperty !== newProperty,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function shallow(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\tlet changed = false;\n\n\tconst validOldProperty = previousProperty && isObjectOrArray(previousProperty);\n\tconst validNewProperty = newProperty && isObjectOrArray(newProperty);\n\n\tif (!validOldProperty || !validNewProperty) {\n\t\treturn {\n\t\t\tchanged: true,\n\t\t\tvalue: newProperty\n\t\t};\n\t}\n\n\tconst previousKeys = Object.keys(previousProperty);\n\tconst newKeys = Object.keys(newProperty);\n\n\tif (previousKeys.length !== newKeys.length) {\n\t\tchanged = true;\n\t} else {\n\t\tchanged = newKeys.some((key) => {\n\t\t\treturn newProperty[key] !== previousProperty[key];\n\t\t});\n\t}\n\treturn {\n\t\tchanged,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function auto(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\tlet result;\n\tif (typeof newProperty === 'function') {\n\t\tif (newProperty._type === WIDGET_BASE_TYPE) {\n\t\t\tresult = reference(previousProperty, newProperty);\n\t\t} else {\n\t\t\tresult = ignore(previousProperty, newProperty);\n\t\t}\n\t} else if (isObjectOrArray(newProperty)) {\n\t\tresult = shallow(previousProperty, newProperty);\n\t} else {\n\t\tresult = reference(previousProperty, newProperty);\n\t}\n\treturn result;\n}\n","import { Thenable } from './interfaces';\nimport global from './global';\nimport { queueMicroTask } from './support/queue';\nimport { Iterable } from './iterator';\nimport './Symbol';\nimport has from '../has/has';\n\n/**\n * Executor is the interface for functions used to initialize a Promise.\n */\nexport interface Executor<T> {\n\t/**\n\t * The executor for the promise\n\t *\n\t * @param resolve The resolver callback of the promise\n\t * @param reject The rejector callback of the promise\n\t */\n\t(resolve: (value?: T | PromiseLike<T>) => void, reject: (reason?: any) => void): void;\n}\n\ndeclare global {\n\tinterface Promise<T> {\n\t\tfinally(onfinally?: (() => void) | undefined | null): Promise<T>;\n\t}\n}\n\nexport let ShimPromise: typeof Promise = global.Promise;\n\nexport const isThenable = function isThenable<T>(value: any): value is PromiseLike<T> {\n\treturn value && typeof value.then === 'function';\n};\n\nif (!has('es6-promise')) {\n\tconst enum State {\n\t\tFulfilled,\n\t\tPending,\n\t\tRejected\n\t}\n\n\tglobal.Promise = ShimPromise = class Promise<T> implements Thenable<T> {\n\t\tstatic all(iterable: Iterable<any | PromiseLike<any>> | (any | PromiseLike<any>)[]): Promise<any> {\n\t\t\treturn new this(function(resolve, reject) {\n\t\t\t\tconst values: any[] = [];\n\t\t\t\tlet complete = 0;\n\t\t\t\tlet total = 0;\n\t\t\t\tlet populating = true;\n\n\t\t\t\tfunction fulfill(index: number, value: any): void {\n\t\t\t\t\tvalues[index] = value;\n\t\t\t\t\t++complete;\n\t\t\t\t\tfinish();\n\t\t\t\t}\n\n\t\t\t\tfunction finish(): void {\n\t\t\t\t\tif (populating || complete < total) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tresolve(values);\n\t\t\t\t}\n\n\t\t\t\tfunction processItem(index: number, item: any): void {\n\t\t\t\t\t++total;\n\t\t\t\t\tif (isThenable(item)) {\n\t\t\t\t\t\t// If an item Promise rejects, this Promise is immediately rejected with the item\n\t\t\t\t\t\t// Promise's rejection error.\n\t\t\t\t\t\titem.then(fulfill.bind(null, index), reject);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tPromise.resolve(item).then(fulfill.bind(null, index));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet i = 0;\n\t\t\t\tfor (const value of iterable) {\n\t\t\t\t\tprocessItem(i, value);\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t\tpopulating = false;\n\n\t\t\t\tfinish();\n\t\t\t});\n\t\t}\n\n\t\tstatic race<T>(iterable: Iterable<T | PromiseLike<T>> | (T | PromiseLike<T>)[]): Promise<T[]> {\n\t\t\treturn new this(function(resolve: (value?: any) => void, reject) {\n\t\t\t\tfor (const item of iterable) {\n\t\t\t\t\tif (item instanceof Promise) {\n\t\t\t\t\t\t// If a Promise item rejects, this Promise is immediately rejected with the item\n\t\t\t\t\t\t// Promise's rejection error.\n\t\t\t\t\t\titem.then(resolve, reject);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tPromise.resolve(item).then(resolve);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tstatic reject(reason?: any): Promise<never> {\n\t\t\treturn new this(function(resolve, reject) {\n\t\t\t\treject(reason);\n\t\t\t});\n\t\t}\n\n\t\tstatic resolve(): Promise<void>;\n\t\tstatic resolve<T>(value: T | PromiseLike<T>): Promise<T>;\n\t\tstatic resolve<T>(value?: any): Promise<T> {\n\t\t\treturn new this(function(resolve) {\n\t\t\t\tresolve(<T>value);\n\t\t\t});\n\t\t}\n\n\t\tstatic [Symbol.species]: PromiseConstructor = ShimPromise as PromiseConstructor;\n\n\t\t/**\n\t\t * Creates a new Promise.\n\t\t *\n\t\t * @constructor\n\t\t *\n\t\t * @param executor\n\t\t * The executor function is called immediately when the Promise is instantiated. It is responsible for\n\t\t * starting the asynchronous operation when it is invoked.\n\t\t *\n\t\t * The executor must call either the passed `resolve` function when the asynchronous operation has completed\n\t\t * successfully, or the `reject` function when the operation fails.\n\t\t */\n\t\tconstructor(executor: Executor<T>) {\n\t\t\t/**\n\t\t\t * If true, the resolution of this promise is chained (\"locked in\") to another promise.\n\t\t\t */\n\t\t\tlet isChained = false;\n\n\t\t\t/**\n\t\t\t * Whether or not this promise is in a resolved state.\n\t\t\t */\n\t\t\tconst isResolved = (): boolean => {\n\t\t\t\treturn this.state !== State.Pending || isChained;\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Callbacks that should be invoked once the asynchronous operation has completed.\n\t\t\t */\n\t\t\tlet callbacks: null | (Array<() => void>) = [];\n\n\t\t\t/**\n\t\t\t * Initially pushes callbacks onto a queue for execution once this promise settles. After the promise settles,\n\t\t\t * enqueues callbacks for execution on the next event loop turn.\n\t\t\t */\n\t\t\tlet whenFinished = function(callback: () => void): void {\n\t\t\t\tif (callbacks) {\n\t\t\t\t\tcallbacks.push(callback);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Settles this promise.\n\t\t\t *\n\t\t\t * @param newState The resolved state for this promise.\n\t\t\t * @param {T|any} value The resolved value for this promise.\n\t\t\t */\n\t\t\tconst settle = (newState: State, value: any): void => {\n\t\t\t\t// A promise can only be settled once.\n\t\t\t\tif (this.state !== State.Pending) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.state = newState;\n\t\t\t\tthis.resolvedValue = value;\n\t\t\t\twhenFinished = queueMicroTask;\n\n\t\t\t\t// Only enqueue a callback runner if there are callbacks so that initially fulfilled Promises don't have to\n\t\t\t\t// wait an extra turn.\n\t\t\t\tif (callbacks && callbacks.length > 0) {\n\t\t\t\t\tqueueMicroTask(function(): void {\n\t\t\t\t\t\tif (callbacks) {\n\t\t\t\t\t\t\tlet count = callbacks.length;\n\t\t\t\t\t\t\tfor (let i = 0; i < count; ++i) {\n\t\t\t\t\t\t\t\tcallbacks[i].call(null);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcallbacks = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Resolves this promise.\n\t\t\t *\n\t\t\t * @param newState The resolved state for this promise.\n\t\t\t * @param {T|any} value The resolved value for this promise.\n\t\t\t */\n\t\t\tconst resolve = (newState: State, value: any): void => {\n\t\t\t\tif (isResolved()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (isThenable(value)) {\n\t\t\t\t\tvalue.then(settle.bind(null, State.Fulfilled), settle.bind(null, State.Rejected));\n\t\t\t\t\tisChained = true;\n\t\t\t\t} else {\n\t\t\t\t\tsettle(newState, value);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.then = <TResult1 = T, TResult2 = never>(\n\t\t\t\tonFulfilled?: ((value: T) => TResult1 | PromiseLike<TResult1>) | undefined | null,\n\t\t\t\tonRejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | undefined | null\n\t\t\t): Promise<TResult1 | TResult2> => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t// whenFinished initially queues up callbacks for execution after the promise has settled. Once the\n\t\t\t\t\t// promise has settled, whenFinished will schedule callbacks for execution on the next turn through the\n\t\t\t\t\t// event loop.\n\t\t\t\t\twhenFinished(() => {\n\t\t\t\t\t\tconst callback: ((value?: any) => any) | undefined | null =\n\t\t\t\t\t\t\tthis.state === State.Rejected ? onRejected : onFulfilled;\n\n\t\t\t\t\t\tif (typeof callback === 'function') {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tresolve(callback(this.resolvedValue));\n\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\treject(error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (this.state === State.Rejected) {\n\t\t\t\t\t\t\treject(this.resolvedValue);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(this.resolvedValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\texecutor(resolve.bind(null, State.Fulfilled), resolve.bind(null, State.Rejected));\n\t\t\t} catch (error) {\n\t\t\t\tsettle(State.Rejected, error);\n\t\t\t}\n\t\t}\n\n\t\tcatch<TResult = never>(\n\t\t\tonRejected?: ((reason: any) => TResult | PromiseLike<TResult>) | undefined | null\n\t\t): Promise<T | TResult> {\n\t\t\treturn this.then(undefined, onRejected);\n\t\t}\n\n\t\t/**\n\t\t * The current state of this promise.\n\t\t */\n\t\tprivate state = State.Pending;\n\n\t\t/**\n\t\t * The resolved value for this promise.\n\t\t *\n\t\t * @type {T|any}\n\t\t */\n\t\tprivate resolvedValue: any;\n\n\t\tthen: <TResult1 = T, TResult2 = never>(\n\t\t\tonfulfilled?: ((value: T) => TResult1 | PromiseLike<TResult1>) | undefined | null,\n\t\t\tonrejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | undefined | null\n\t\t) => Promise<TResult1 | TResult2>;\n\n\t\t[Symbol.toStringTag]: 'Promise' = 'Promise';\n\t} as any;\n\t// this cast is needed in order to omit finally in the class declaration; this was done so the finally code\n\t// is not duplicated and always added in the conditional below\n}\n\nif (!has('es2018-promise-finally')) {\n\tglobal.Promise.prototype.finally = function<T>(\n\t\tthis: Promise<T>,\n\t\tonFinally: (() => any) | undefined | null\n\t): Promise<any> {\n\t\treturn this.then(\n\t\t\tonFinally && ((value: T) => Promise.resolve(onFinally()).then(() => value)),\n\t\t\tonFinally &&\n\t\t\t\t((reason: any) =>\n\t\t\t\t\tPromise.resolve(onFinally()).then(() => {\n\t\t\t\t\t\tthrow reason;\n\t\t\t\t\t}))\n\t\t);\n\t};\n}\n\nexport default ShimPromise;\n","import { handleDecorator } from './handleDecorator';\nimport { BeforeProperties } from './../interfaces';\n\n/**\n * Decorator that adds the function passed of target method to be run\n * in the `beforeProperties` lifecycle.\n */\nexport function beforeProperties(method: BeforeProperties): (target: any) => void;\nexport function beforeProperties(): (target: any, propertyKey: string) => void;\nexport function beforeProperties(method?: BeforeProperties) {\n\treturn handleDecorator((target, propertyKey) => {\n\t\ttarget.addDecorator('beforeProperties', propertyKey ? target[propertyKey] : method);\n\t});\n}\n\nexport default beforeProperties;\n","import { handleDecorator } from './handleDecorator';\nimport { DiffPropertyFunction } from './../interfaces';\nimport { auto } from './../diff';\n\n/**\n * Decorator that can be used to register a function as a specific property diff\n *\n * @param propertyName  The name of the property of which the diff function is applied\n * @param diffType      The diff type, default is DiffType.AUTO.\n * @param diffFunction  A diff function to run if diffType if DiffType.CUSTOM\n */\nexport function diffProperty(\n\tpropertyName: string,\n\tdiffFunction: DiffPropertyFunction = auto,\n\treactionFunction?: Function\n) {\n\treturn handleDecorator((target, propertyKey) => {\n\t\ttarget.addDecorator(`diffProperty:${propertyName}`, diffFunction.bind(null));\n\t\ttarget.addDecorator('registeredDiffProperty', propertyName);\n\t\tif (reactionFunction || propertyKey) {\n\t\t\ttarget.addDecorator('diffReaction', {\n\t\t\t\tpropertyName,\n\t\t\t\treaction: propertyKey ? target[propertyKey] : reactionFunction\n\t\t\t});\n\t\t}\n\t});\n}\n\nexport default diffProperty;\n","import { DNode } from '../widget-core/interfaces';\nimport { WidgetBase } from '../widget-core/WidgetBase';\nimport { alwaysRender } from '../widget-core/decorators/alwaysRender';\nimport { MatchDetails } from './interfaces';\nimport { Router } from './Router';\nimport { diffProperty } from '../widget-core/decorators/diffProperty';\nimport { Handle } from '../core/Destroyable';\n\nexport interface OutletProperties {\n\trenderer: (matchDetails: MatchDetails) => DNode | DNode[];\n\tid: string;\n\trouterKey?: string;\n}\n\n@alwaysRender()\nexport class Outlet extends WidgetBase<OutletProperties> {\n\tprivate _handle: Handle | undefined;\n\n\t@diffProperty('routerKey')\n\tprotected onRouterKeyChange(current: OutletProperties, next: OutletProperties) {\n\t\tconst { routerKey = 'router' } = next;\n\t\tconst item = this.registry.getInjector<Router>(routerKey);\n\t\tif (this._handle) {\n\t\t\tthis._handle.destroy();\n\t\t\tthis._handle = undefined;\n\t\t}\n\t\tif (item) {\n\t\t\tthis._handle = item.invalidator.on('invalidate', () => {\n\t\t\t\tthis.invalidate();\n\t\t\t});\n\t\t\tthis.own(this._handle);\n\t\t}\n\t}\n\n\tprotected onAttach() {\n\t\tif (!this._handle) {\n\t\t\tthis.onRouterKeyChange(this.properties, this.properties);\n\t\t}\n\t}\n\n\tprotected render(): DNode | DNode[] {\n\t\tconst { renderer, id, routerKey = 'router' } = this.properties;\n\t\tconst item = this.registry.getInjector<Router>(routerKey);\n\n\t\tif (item) {\n\t\t\tconst router = item.injector();\n\t\t\tconst outletContext = router.getOutlet(id);\n\t\t\tif (outletContext) {\n\t\t\t\tconst { queryParams, params, type, isError, isExact } = outletContext;\n\t\t\t\tconst result = renderer({ queryParams, params, type, isError, isExact, router });\n\t\t\t\tif (result) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}\n\nexport default Outlet;\n","import global from '../shim/global';\nimport has from '../has/has';\nimport { WeakMap } from '../shim/WeakMap';\nimport {\n\tWNode,\n\tVNode,\n\tDNode,\n\tVNodeProperties,\n\tWidgetBaseConstructor,\n\tTransitionStrategy,\n\tSupportedClassName,\n\tDomVNode\n} from './interfaces';\nimport transitionStrategy from './animations/cssTransitions';\nimport { isVNode, isWNode, WNODE, v, isDomVNode, w } from './d';\nimport { Registry, isWidgetBaseConstructor } from './Registry';\nimport { WidgetBase, widgetInstanceMap } from './WidgetBase';\n\nexport interface BaseNodeWrapper {\n\tnode: WNode | VNode;\n\tdomNode?: Node;\n\tchildrenWrappers?: DNodeWrapper[];\n\tdepth: number;\n\torder: number;\n\trequiresInsertBefore?: boolean;\n\thasPreviousSiblings?: boolean;\n\thasParentWNode?: boolean;\n\tnamespace?: string;\n\thasAnimations?: boolean;\n}\n\nexport interface WNodeWrapper extends BaseNodeWrapper {\n\tnode: WNode;\n\tinstance?: WidgetBase;\n\tmergeNodes?: Node[];\n\tnodeHandlerCalled?: boolean;\n}\n\nexport interface VNodeWrapper extends BaseNodeWrapper {\n\tnode: VNode | DomVNode;\n\tmerged?: boolean;\n\tdecoratedDeferredProperties?: VNodeProperties;\n\tinserted?: boolean;\n}\n\nexport type DNodeWrapper = VNodeWrapper | WNodeWrapper;\n\nexport interface MountOptions {\n\tsync: boolean;\n\tmerge: boolean;\n\ttransition: TransitionStrategy;\n\tdomNode: HTMLElement;\n\tregistry: Registry | null;\n}\n\nexport interface Renderer {\n\tinvalidate(): void;\n\tmount(mountOptions?: Partial<MountOptions>): void;\n}\n\ninterface ProcessItem {\n\tcurrent?: (WNodeWrapper | VNodeWrapper)[];\n\tnext?: (WNodeWrapper | VNodeWrapper)[];\n\tmeta: ProcessMeta;\n}\n\ninterface ProcessResult {\n\titem?: ProcessItem;\n\twidget?: AttachApplication | DetachApplication;\n\tdom?: ApplicationInstruction;\n}\n\ninterface ProcessMeta {\n\tmergeNodes?: Node[];\n\toldIndex?: number;\n\tnewIndex?: number;\n}\n\ninterface InvalidationQueueItem {\n\tinstance: WidgetBase;\n\tdepth: number;\n\torder: number;\n}\n\ninterface Instruction {\n\tcurrent: undefined | DNodeWrapper;\n\tnext: undefined | DNodeWrapper;\n}\n\ninterface CreateWidgetInstruction {\n\tnext: WNodeWrapper;\n}\n\ninterface UpdateWidgetInstruction {\n\tcurrent: WNodeWrapper;\n\tnext: WNodeWrapper;\n}\n\ninterface RemoveWidgetInstruction {\n\tcurrent: WNodeWrapper;\n}\n\ninterface CreateDomInstruction {\n\tnext: VNodeWrapper;\n}\n\ninterface UpdateDomInstruction {\n\tcurrent: VNodeWrapper;\n\tnext: VNodeWrapper;\n}\n\ninterface RemoveDomInstruction {\n\tcurrent: VNodeWrapper;\n}\n\ninterface AttachApplication {\n\ttype: 'attach';\n\tinstance: WidgetBase;\n\tattached: boolean;\n}\n\ninterface DetachApplication {\n\ttype: 'detach';\n\tcurrent: WNodeWrapper;\n}\n\ninterface CreateDomApplication {\n\ttype: 'create';\n\tcurrent?: VNodeWrapper;\n\tnext: VNodeWrapper;\n\tparentDomNode: Node;\n}\n\ninterface DeleteDomApplication {\n\ttype: 'delete';\n\tcurrent: VNodeWrapper;\n}\n\ninterface UpdateDomApplication {\n\ttype: 'update';\n\tcurrent: VNodeWrapper;\n\tnext: VNodeWrapper;\n}\n\ninterface PreviousProperties {\n\tproperties: any;\n\tattributes?: any;\n\tevents?: any;\n}\n\ntype ApplicationInstruction =\n\t| CreateDomApplication\n\t| UpdateDomApplication\n\t| DeleteDomApplication\n\t| AttachApplication\n\t| DetachApplication;\n\nconst EMPTY_ARRAY: DNodeWrapper[] = [];\nconst nodeOperations = ['focus', 'blur', 'scrollIntoView', 'click'];\nconst NAMESPACE_W3 = 'http://www.w3.org/';\nconst NAMESPACE_SVG = NAMESPACE_W3 + '2000/svg';\nconst NAMESPACE_XLINK = NAMESPACE_W3 + '1999/xlink';\n\nfunction isWNodeWrapper(child: DNodeWrapper): child is WNodeWrapper {\n\treturn child && isWNode(child.node);\n}\n\nfunction isVNodeWrapper(child?: DNodeWrapper | null): child is VNodeWrapper {\n\treturn !!child && isVNode(child.node);\n}\n\nfunction isAttachApplication(value: any): value is AttachApplication | DetachApplication {\n\treturn !!value.type;\n}\n\nfunction updateAttributes(\n\tdomNode: Element,\n\tpreviousAttributes: { [index: string]: string | undefined },\n\tattributes: { [index: string]: string | undefined },\n\tnamespace?: string\n) {\n\tconst attrNames = Object.keys(attributes);\n\tconst attrCount = attrNames.length;\n\tfor (let i = 0; i < attrCount; i++) {\n\t\tconst attrName = attrNames[i];\n\t\tconst attrValue = attributes[attrName];\n\t\tconst previousAttrValue = previousAttributes[attrName];\n\t\tif (attrValue !== previousAttrValue) {\n\t\t\tupdateAttribute(domNode, attrName, attrValue, namespace);\n\t\t}\n\t}\n}\n\nfunction buildPreviousProperties(domNode: any, current: VNodeWrapper, next: VNodeWrapper) {\n\tconst {\n\t\tnode: { diffType, properties, attributes }\n\t} = current;\n\tif (!diffType || diffType === 'vdom') {\n\t\treturn {\n\t\t\tproperties: current.node.properties,\n\t\t\tattributes: current.node.attributes,\n\t\t\tevents: current.node.events\n\t\t};\n\t} else if (diffType === 'none') {\n\t\treturn { properties: {}, attributes: current.node.attributes ? {} : undefined, events: current.node.events };\n\t}\n\tlet newProperties: any = {\n\t\tproperties: {}\n\t};\n\tif (attributes) {\n\t\tnewProperties.attributes = {};\n\t\tnewProperties.events = current.node.events;\n\t\tObject.keys(properties).forEach((propName) => {\n\t\t\tnewProperties.properties[propName] = domNode[propName];\n\t\t});\n\t\tObject.keys(attributes).forEach((attrName) => {\n\t\t\tnewProperties.attributes[attrName] = domNode.getAttribute(attrName);\n\t\t});\n\t\treturn newProperties;\n\t}\n\tnewProperties.properties = Object.keys(properties).reduce(\n\t\t(props, property) => {\n\t\t\tprops[property] = domNode.getAttribute(property) || domNode[property];\n\t\t\treturn props;\n\t\t},\n\t\t{} as any\n\t);\n\treturn newProperties;\n}\n\nfunction checkDistinguishable(wrappers: DNodeWrapper[], index: number, parentWNodeWrapper?: WNodeWrapper) {\n\tconst wrapperToCheck = wrappers[index];\n\tif (isVNodeWrapper(wrapperToCheck) && !wrapperToCheck.node.tag) {\n\t\treturn;\n\t}\n\tconst { key } = wrapperToCheck.node.properties;\n\tlet parentName = 'unknown';\n\tif (parentWNodeWrapper) {\n\t\tconst {\n\t\t\tnode: { widgetConstructor }\n\t\t} = parentWNodeWrapper;\n\t\tparentName = (widgetConstructor as any).name || 'unknown';\n\t}\n\n\tif (key === undefined || key === null) {\n\t\tfor (let i = 0; i < wrappers.length; i++) {\n\t\t\tif (i !== index) {\n\t\t\t\tconst wrapper = wrappers[i];\n\t\t\t\tif (same(wrapper, wrapperToCheck)) {\n\t\t\t\t\tlet nodeIdentifier: string;\n\t\t\t\t\tif (isWNodeWrapper(wrapper)) {\n\t\t\t\t\t\tnodeIdentifier = (wrapper.node.widgetConstructor as any).name || 'unknown';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnodeIdentifier = wrapper.node.tag;\n\t\t\t\t\t}\n\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t`A widget (${parentName}) has had a child added or removed, but they were not able to uniquely identified. It is recommended to provide a unique 'key' property when using the same widget or element (${nodeIdentifier}) multiple times as siblings`\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction same(dnode1: DNodeWrapper, dnode2: DNodeWrapper): boolean {\n\tif (isVNodeWrapper(dnode1) && isVNodeWrapper(dnode2)) {\n\t\tif (isDomVNode(dnode1.node) && isDomVNode(dnode2.node)) {\n\t\t\tif (dnode1.node.domNode !== dnode2.node.domNode) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\tif (dnode1.node.tag !== dnode2.node.tag) {\n\t\t\treturn false;\n\t\t}\n\t\tif (dnode1.node.properties.key !== dnode2.node.properties.key) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t} else if (isWNodeWrapper(dnode1) && isWNodeWrapper(dnode2)) {\n\t\tif (dnode1.instance === undefined && typeof dnode2.node.widgetConstructor === 'string') {\n\t\t\treturn false;\n\t\t}\n\t\tif (dnode1.node.widgetConstructor !== dnode2.node.widgetConstructor) {\n\t\t\treturn false;\n\t\t}\n\t\tif (dnode1.node.properties.key !== dnode2.node.properties.key) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction findIndexOfChild(children: DNodeWrapper[], sameAs: DNodeWrapper, start: number) {\n\tfor (let i = start; i < children.length; i++) {\n\t\tif (same(children[i], sameAs)) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\nfunction createClassPropValue(classes: SupportedClassName | SupportedClassName[] = []) {\n\tclasses = Array.isArray(classes) ? classes : [classes];\n\treturn classes\n\t\t.filter((className) => className && className !== true)\n\t\t.join(' ')\n\t\t.trim();\n}\n\nfunction updateAttribute(domNode: Element, attrName: string, attrValue: string | undefined, namespace?: string) {\n\tif (namespace === NAMESPACE_SVG && attrName === 'href' && attrValue) {\n\t\tdomNode.setAttributeNS(NAMESPACE_XLINK, attrName, attrValue);\n\t} else if ((attrName === 'role' && attrValue === '') || attrValue === undefined) {\n\t\tdomNode.removeAttribute(attrName);\n\t} else {\n\t\tdomNode.setAttribute(attrName, attrValue);\n\t}\n}\n\nfunction runEnterAnimation(next: VNodeWrapper, transitions: TransitionStrategy) {\n\tconst {\n\t\tdomNode,\n\t\tnode: { properties },\n\t\tnode: {\n\t\t\tproperties: { enterAnimation }\n\t\t}\n\t} = next;\n\tif (enterAnimation && enterAnimation !== true) {\n\t\tif (typeof enterAnimation === 'function') {\n\t\t\treturn enterAnimation(domNode as Element, properties);\n\t\t}\n\t\ttransitions.enter(domNode as Element, properties, enterAnimation);\n\t}\n}\n\nfunction runExitAnimation(current: VNodeWrapper, transitions: TransitionStrategy, exitAnimation: string | Function) {\n\tconst {\n\t\tdomNode,\n\t\tnode: { properties }\n\t} = current;\n\tconst removeDomNode = () => {\n\t\tdomNode && domNode.parentNode && domNode.parentNode.removeChild(domNode);\n\t\tcurrent.domNode = undefined;\n\t};\n\tif (typeof exitAnimation === 'function') {\n\t\treturn exitAnimation(domNode as Element, removeDomNode, properties);\n\t}\n\ttransitions.exit(domNode as Element, properties, exitAnimation, removeDomNode);\n}\n\nfunction arrayFrom(arr: any) {\n\treturn Array.prototype.slice.call(arr);\n}\n\nfunction wrapNodes(renderer: () => DNode) {\n\treturn class extends WidgetBase {\n\t\tpublic isWNodeWrapper = true;\n\n\t\tprotected render() {\n\t\t\tconst result = renderer();\n\t\t\tthis.isWNodeWrapper = isWNode(result);\n\t\t\treturn result;\n\t\t}\n\t};\n}\n\nexport function renderer(renderer: () => WNode | VNode): Renderer {\n\tlet _mountOptions: MountOptions = {\n\t\tsync: false,\n\t\tmerge: true,\n\t\ttransition: transitionStrategy,\n\t\tdomNode: global.document.body,\n\t\tregistry: null\n\t};\n\tlet _invalidationQueue: InvalidationQueueItem[] = [];\n\tlet _processQueue: (ProcessItem | DetachApplication | AttachApplication)[] = [];\n\tlet _applicationQueue: ApplicationInstruction[] = [];\n\tlet _eventMap = new WeakMap<Function, EventListener>();\n\tlet _instanceToWrapperMap = new WeakMap<WidgetBase, WNodeWrapper>();\n\tlet _parentWrapperMap = new WeakMap<DNodeWrapper, DNodeWrapper>();\n\tlet _wrapperSiblingMap = new WeakMap<DNodeWrapper, DNodeWrapper>();\n\tlet _insertBeforeMap: undefined | WeakMap<DNodeWrapper, Node> = new WeakMap<DNodeWrapper, Node>();\n\tlet _renderScheduled: number | undefined;\n\tlet _afterRenderCallbacks: Function[] = [];\n\tlet _deferredRenderCallbacks: Function[] = [];\n\tlet parentInvalidate: () => void;\n\tlet _allMergedNodes: Node[] = [];\n\n\tfunction nodeOperation(\n\t\tpropName: string,\n\t\tpropValue: (() => boolean) | boolean,\n\t\tpreviousValue: boolean,\n\t\tdomNode: HTMLElement & { [index: string]: any }\n\t): void {\n\t\tlet result = propValue && !previousValue;\n\t\tif (typeof propValue === 'function') {\n\t\t\tresult = propValue();\n\t\t}\n\t\tif (result === true) {\n\t\t\t_afterRenderCallbacks.push(() => {\n\t\t\t\tdomNode[propName]();\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction updateEvent(\n\t\tdomNode: Node,\n\t\teventName: string,\n\t\tcurrentValue: Function,\n\t\tbind: any,\n\t\tpreviousValue?: Function\n\t) {\n\t\tif (previousValue) {\n\t\t\tconst previousEvent = _eventMap.get(previousValue);\n\t\t\tdomNode.removeEventListener(eventName, previousEvent);\n\t\t}\n\n\t\tlet callback = currentValue.bind(bind);\n\n\t\tif (eventName === 'input') {\n\t\t\tcallback = function(this: any, evt: Event) {\n\t\t\t\tcurrentValue.call(this, evt);\n\t\t\t\t(evt.target as any)['oninput-value'] = (evt.target as HTMLInputElement).value;\n\t\t\t}.bind(bind);\n\t\t}\n\n\t\tdomNode.addEventListener(eventName, callback);\n\t\t_eventMap.set(currentValue, callback);\n\t}\n\n\tfunction removeOrphanedEvents(\n\t\tdomNode: Element,\n\t\tpreviousProperties: VNodeProperties,\n\t\tproperties: VNodeProperties,\n\t\tonlyEvents: boolean = false\n\t) {\n\t\tObject.keys(previousProperties).forEach((propName) => {\n\t\t\tconst isEvent = propName.substr(0, 2) === 'on' || onlyEvents;\n\t\t\tconst eventName = onlyEvents ? propName : propName.substr(2);\n\t\t\tif (isEvent && !properties[propName]) {\n\t\t\t\tconst eventCallback = _eventMap.get(previousProperties[propName]);\n\t\t\t\tif (eventCallback) {\n\t\t\t\t\tdomNode.removeEventListener(eventName, eventCallback);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction renderedToWrapper(\n\t\trendered: DNode[],\n\t\tparent: DNodeWrapper,\n\t\tcurrentParent: DNodeWrapper | null\n\t): DNodeWrapper[] {\n\t\tconst { requiresInsertBefore, hasPreviousSiblings, namespace, depth } = parent;\n\t\tconst wrappedRendered: DNodeWrapper[] = [];\n\t\tconst hasParentWNode = isWNodeWrapper(parent);\n\t\tconst currentParentChildren = (isVNodeWrapper(currentParent) && currentParent.childrenWrappers) || [];\n\t\tconst hasCurrentParentChildren = currentParentChildren.length > 0;\n\t\tconst insertBefore =\n\t\t\t((requiresInsertBefore || hasPreviousSiblings !== false) && hasParentWNode) ||\n\t\t\t(hasCurrentParentChildren && rendered.length > 1);\n\t\tlet previousItem: DNodeWrapper | undefined;\n\t\tfor (let i = 0; i < rendered.length; i++) {\n\t\t\tconst renderedItem = rendered[i];\n\t\t\tconst wrapper = {\n\t\t\t\tnode: renderedItem,\n\t\t\t\tdepth: depth + 1,\n\t\t\t\torder: i,\n\t\t\t\trequiresInsertBefore: insertBefore,\n\t\t\t\thasParentWNode,\n\t\t\t\tnamespace: namespace\n\t\t\t} as DNodeWrapper;\n\t\t\tif (isVNode(renderedItem) && renderedItem.properties.exitAnimation) {\n\t\t\t\tparent.hasAnimations = true;\n\t\t\t\tlet nextParent = _parentWrapperMap.get(parent);\n\t\t\t\twhile (nextParent) {\n\t\t\t\t\tif (nextParent.hasAnimations) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tnextParent.hasAnimations = true;\n\t\t\t\t\tnextParent = _parentWrapperMap.get(nextParent);\n\t\t\t\t}\n\t\t\t}\n\t\t\t_parentWrapperMap.set(wrapper, parent);\n\t\t\tif (previousItem) {\n\t\t\t\t_wrapperSiblingMap.set(previousItem, wrapper);\n\t\t\t}\n\t\t\twrappedRendered.push(wrapper);\n\t\t\tpreviousItem = wrapper;\n\t\t}\n\t\treturn wrappedRendered;\n\t}\n\n\tfunction findParentWNodeWrapper(currentNode: DNodeWrapper): WNodeWrapper | undefined {\n\t\tlet parentWNodeWrapper: WNodeWrapper | undefined;\n\t\tlet parentWrapper = _parentWrapperMap.get(currentNode);\n\n\t\twhile (!parentWNodeWrapper && parentWrapper) {\n\t\t\tif (!parentWNodeWrapper && isWNodeWrapper(parentWrapper)) {\n\t\t\t\tparentWNodeWrapper = parentWrapper;\n\t\t\t}\n\t\t\tparentWrapper = _parentWrapperMap.get(parentWrapper);\n\t\t}\n\t\treturn parentWNodeWrapper;\n\t}\n\n\tfunction findParentDomNode(currentNode: DNodeWrapper): Node | undefined {\n\t\tlet parentDomNode: Node | undefined;\n\t\tlet parentWrapper = _parentWrapperMap.get(currentNode);\n\n\t\twhile (!parentDomNode && parentWrapper) {\n\t\t\tif (!parentDomNode && isVNodeWrapper(parentWrapper) && parentWrapper.domNode) {\n\t\t\t\tparentDomNode = parentWrapper.domNode;\n\t\t\t}\n\t\t\tparentWrapper = _parentWrapperMap.get(parentWrapper);\n\t\t}\n\t\treturn parentDomNode;\n\t}\n\n\tfunction runDeferredProperties(next: VNodeWrapper) {\n\t\tif (next.node.deferredPropertiesCallback) {\n\t\t\tconst properties = next.node.properties;\n\t\t\tnext.node.properties = { ...next.node.deferredPropertiesCallback(true), ...next.node.originalProperties };\n\t\t\t_afterRenderCallbacks.push(() => {\n\t\t\t\tprocessProperties(next, { properties });\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction findInsertBefore(next: DNodeWrapper) {\n\t\tlet insertBefore: Node | null = null;\n\t\tlet searchNode: DNodeWrapper | undefined = next;\n\t\twhile (!insertBefore) {\n\t\t\tconst nextSibling = _wrapperSiblingMap.get(searchNode);\n\t\t\tif (nextSibling) {\n\t\t\t\tif (isVNodeWrapper(nextSibling)) {\n\t\t\t\t\tif (nextSibling.domNode && nextSibling.domNode.parentNode) {\n\t\t\t\t\t\tinsertBefore = nextSibling.domNode;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsearchNode = nextSibling;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (nextSibling.domNode && nextSibling.domNode.parentNode) {\n\t\t\t\t\tinsertBefore = nextSibling.domNode;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tsearchNode = nextSibling;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tsearchNode = _parentWrapperMap.get(searchNode);\n\t\t\tif (!searchNode || isVNodeWrapper(searchNode)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn insertBefore;\n\t}\n\n\tfunction setValue(domNode: any, propValue?: any, previousValue?: any) {\n\t\tconst domValue = domNode.value;\n\t\tconst onInputValue = domNode['oninput-value'];\n\t\tconst onSelectValue = domNode['select-value'];\n\n\t\tif (onSelectValue && domValue !== onSelectValue) {\n\t\t\tdomNode.value = onSelectValue;\n\t\t\tif (domNode.value === onSelectValue) {\n\t\t\t\tdomNode['select-value'] = undefined;\n\t\t\t}\n\t\t} else if ((onInputValue && domValue === onInputValue) || propValue !== previousValue) {\n\t\t\tdomNode.value = propValue;\n\t\t\tdomNode['oninput-value'] = undefined;\n\t\t}\n\t}\n\n\tfunction setProperties(\n\t\tdomNode: HTMLElement,\n\t\tcurrentProperties: VNodeProperties = {},\n\t\tnextWrapper: VNodeWrapper,\n\t\tincludesEventsAndAttributes = true\n\t): void {\n\t\tconst propNames = Object.keys(nextWrapper.node.properties);\n\t\tconst propCount = propNames.length;\n\t\tif (propNames.indexOf('classes') === -1 && currentProperties.classes) {\n\t\t\tdomNode.removeAttribute('class');\n\t\t}\n\n\t\tincludesEventsAndAttributes && removeOrphanedEvents(domNode, currentProperties, nextWrapper.node.properties);\n\n\t\tfor (let i = 0; i < propCount; i++) {\n\t\t\tconst propName = propNames[i];\n\t\t\tlet propValue = nextWrapper.node.properties[propName];\n\t\t\tconst previousValue = currentProperties[propName];\n\t\t\tif (propName === 'classes') {\n\t\t\t\tconst previousClassString = createClassPropValue(previousValue);\n\t\t\t\tlet currentClassString = createClassPropValue(propValue);\n\t\t\t\tif (previousClassString !== currentClassString) {\n\t\t\t\t\tif (currentClassString) {\n\t\t\t\t\t\tif (nextWrapper.merged) {\n\t\t\t\t\t\t\tconst domClasses = (domNode.getAttribute('class') || '').split(' ');\n\t\t\t\t\t\t\tfor (let i = 0; i < domClasses.length; i++) {\n\t\t\t\t\t\t\t\tif (currentClassString.indexOf(domClasses[i]) === -1) {\n\t\t\t\t\t\t\t\t\tcurrentClassString = `${domClasses[i]} ${currentClassString}`;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomNode.setAttribute('class', currentClassString);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdomNode.removeAttribute('class');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (nodeOperations.indexOf(propName) !== -1) {\n\t\t\t\tnodeOperation(propName, propValue, previousValue, domNode);\n\t\t\t} else if (propName === 'styles') {\n\t\t\t\tconst styleNames = Object.keys(propValue);\n\t\t\t\tconst styleCount = styleNames.length;\n\t\t\t\tfor (let j = 0; j < styleCount; j++) {\n\t\t\t\t\tconst styleName = styleNames[j];\n\t\t\t\t\tconst newStyleValue = propValue[styleName];\n\t\t\t\t\tconst oldStyleValue = previousValue && previousValue[styleName];\n\t\t\t\t\tif (newStyleValue === oldStyleValue) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t(domNode.style as any)[styleName] = newStyleValue || '';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!propValue && typeof previousValue === 'string') {\n\t\t\t\t\tpropValue = '';\n\t\t\t\t}\n\t\t\t\tif (propName === 'value') {\n\t\t\t\t\tif ((domNode as HTMLElement).tagName === 'SELECT') {\n\t\t\t\t\t\t(domNode as any)['select-value'] = propValue;\n\t\t\t\t\t}\n\t\t\t\t\tsetValue(domNode, propValue, previousValue);\n\t\t\t\t} else if (propName !== 'key' && propValue !== previousValue) {\n\t\t\t\t\tconst type = typeof propValue;\n\t\t\t\t\tif (type === 'function' && propName.lastIndexOf('on', 0) === 0 && includesEventsAndAttributes) {\n\t\t\t\t\t\tupdateEvent(domNode, propName.substr(2), propValue, nextWrapper.node.bind, previousValue);\n\t\t\t\t\t} else if (type === 'string' && propName !== 'innerHTML' && includesEventsAndAttributes) {\n\t\t\t\t\t\tupdateAttribute(domNode, propName, propValue, nextWrapper.namespace);\n\t\t\t\t\t} else if (propName === 'scrollLeft' || propName === 'scrollTop') {\n\t\t\t\t\t\tif ((domNode as any)[propName] !== propValue) {\n\t\t\t\t\t\t\t(domNode as any)[propName] = propValue;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t(domNode as any)[propName] = propValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction runDeferredRenderCallbacks() {\n\t\tconst { sync } = _mountOptions;\n\t\tconst callbacks = _deferredRenderCallbacks;\n\t\t_deferredRenderCallbacks = [];\n\t\tif (callbacks.length) {\n\t\t\tconst run = () => {\n\t\t\t\tlet callback: Function | undefined;\n\t\t\t\twhile ((callback = callbacks.shift())) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (sync) {\n\t\t\t\trun();\n\t\t\t} else {\n\t\t\t\tglobal.requestAnimationFrame(run);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction runAfterRenderCallbacks() {\n\t\tconst { sync } = _mountOptions;\n\t\tconst callbacks = _afterRenderCallbacks;\n\t\t_afterRenderCallbacks = [];\n\t\tif (callbacks.length) {\n\t\t\tconst run = () => {\n\t\t\t\tlet callback: Function | undefined;\n\t\t\t\twhile ((callback = callbacks.shift())) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (sync) {\n\t\t\t\trun();\n\t\t\t} else {\n\t\t\t\tif (global.requestIdleCallback) {\n\t\t\t\t\tglobal.requestIdleCallback(run);\n\t\t\t\t} else {\n\t\t\t\t\tsetTimeout(run);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction processProperties(next: VNodeWrapper, previousProperties: PreviousProperties) {\n\t\tif (next.node.attributes && next.node.events) {\n\t\t\tupdateAttributes(\n\t\t\t\tnext.domNode as HTMLElement,\n\t\t\t\tpreviousProperties.attributes || {},\n\t\t\t\tnext.node.attributes,\n\t\t\t\tnext.namespace\n\t\t\t);\n\t\t\tsetProperties(next.domNode as HTMLElement, previousProperties.properties, next, false);\n\t\t\tconst events = next.node.events || {};\n\t\t\tif (previousProperties.events) {\n\t\t\t\tremoveOrphanedEvents(\n\t\t\t\t\tnext.domNode as HTMLElement,\n\t\t\t\t\tpreviousProperties.events || {},\n\t\t\t\t\tnext.node.events,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t\tpreviousProperties.events = previousProperties.events || {};\n\t\t\tObject.keys(events).forEach((event) => {\n\t\t\t\tupdateEvent(\n\t\t\t\t\tnext.domNode as HTMLElement,\n\t\t\t\t\tevent,\n\t\t\t\t\tevents[event],\n\t\t\t\t\tnext.node.bind,\n\t\t\t\t\tpreviousProperties.events[event]\n\t\t\t\t);\n\t\t\t});\n\t\t} else {\n\t\t\tsetProperties(next.domNode as HTMLElement, previousProperties.properties, next);\n\t\t}\n\t}\n\n\tfunction mount(mountOptions: Partial<MountOptions> = {}) {\n\t\t_mountOptions = { ..._mountOptions, ...mountOptions };\n\t\tconst { domNode } = _mountOptions;\n\t\tconst renderResult = w(wrapNodes(renderer), {});\n\t\tconst nextWrapper = {\n\t\t\tnode: renderResult,\n\t\t\torder: 0,\n\t\t\tdepth: 1\n\t\t};\n\t\t_parentWrapperMap.set(nextWrapper, { depth: 0, order: 0, domNode, node: v('fake') });\n\t\t_processQueue.push({\n\t\t\tcurrent: [],\n\t\t\tnext: [nextWrapper],\n\t\t\tmeta: { mergeNodes: arrayFrom(domNode.childNodes) }\n\t\t});\n\t\t_runProcessQueue();\n\t\tlet mergedNode: Node | undefined;\n\t\twhile ((mergedNode = _allMergedNodes.pop())) {\n\t\t\tmergedNode.parentNode && mergedNode.parentNode.removeChild(mergedNode);\n\t\t}\n\t\t_runDomInstructionQueue();\n\t\t_mountOptions.merge = false;\n\t\t_insertBeforeMap = undefined;\n\t\t_runCallbacks();\n\t}\n\n\tfunction invalidate() {\n\t\tparentInvalidate && parentInvalidate();\n\t}\n\n\tfunction _schedule(): void {\n\t\tconst { sync } = _mountOptions;\n\t\tif (sync) {\n\t\t\t_runInvalidationQueue();\n\t\t} else if (!_renderScheduled) {\n\t\t\t_renderScheduled = global.requestAnimationFrame(() => {\n\t\t\t\t_runInvalidationQueue();\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction _runInvalidationQueue() {\n\t\t_renderScheduled = undefined;\n\t\tconst invalidationQueue = [..._invalidationQueue];\n\t\tconst previouslyRendered = [];\n\t\t_invalidationQueue = [];\n\t\tinvalidationQueue.sort((a, b) => {\n\t\t\tlet result = b.depth - a.depth;\n\t\t\tif (result === 0) {\n\t\t\t\tresult = b.order - a.order;\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t\tlet item: InvalidationQueueItem | undefined;\n\t\twhile ((item = invalidationQueue.pop())) {\n\t\t\tlet { instance } = item;\n\t\t\tif (previouslyRendered.indexOf(instance) === -1 && _instanceToWrapperMap.has(instance!)) {\n\t\t\t\tpreviouslyRendered.push(instance);\n\t\t\t\tconst current = _instanceToWrapperMap.get(instance)!;\n\t\t\t\tconst instanceData = widgetInstanceMap.get(instance)!;\n\t\t\t\tconst parent = _parentWrapperMap.get(current);\n\t\t\t\tconst sibling = _wrapperSiblingMap.get(current);\n\t\t\t\tconst { constructor, children } = instance;\n\t\t\t\tconst next = {\n\t\t\t\t\tnode: {\n\t\t\t\t\t\ttype: WNODE,\n\t\t\t\t\t\twidgetConstructor: constructor as WidgetBaseConstructor,\n\t\t\t\t\t\tproperties: instanceData.inputProperties,\n\t\t\t\t\t\tchildren: children,\n\t\t\t\t\t\tbind: current.node.bind\n\t\t\t\t\t},\n\t\t\t\t\tinstance,\n\t\t\t\t\tdepth: current.depth,\n\t\t\t\t\torder: current.order\n\t\t\t\t};\n\n\t\t\t\tparent && _parentWrapperMap.set(next, parent);\n\t\t\t\tsibling && _wrapperSiblingMap.set(next, sibling);\n\t\t\t\tconst { item } = _updateWidget({ current, next });\n\t\t\t\tif (item) {\n\t\t\t\t\t_processQueue.push(item);\n\t\t\t\t\tinstance && _instanceToWrapperMap.set(instance, next);\n\t\t\t\t\t_runProcessQueue();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_runDomInstructionQueue();\n\t\t_runCallbacks();\n\t}\n\n\tfunction _runProcessQueue() {\n\t\tlet item: DetachApplication | AttachApplication | ProcessItem | undefined;\n\t\twhile ((item = _processQueue.pop())) {\n\t\t\tif (isAttachApplication(item)) {\n\t\t\t\t_applicationQueue.push(item);\n\t\t\t} else {\n\t\t\t\tconst { current, next, meta } = item;\n\t\t\t\t_process(current || EMPTY_ARRAY, next || EMPTY_ARRAY, meta);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction _runDomInstructionQueue(): void {\n\t\t_applicationQueue.reverse();\n\t\tlet item: ApplicationInstruction | undefined;\n\t\twhile ((item = _applicationQueue.pop())) {\n\t\t\tif (item.type === 'create') {\n\t\t\t\tconst {\n\t\t\t\t\tparentDomNode,\n\t\t\t\t\tnext,\n\t\t\t\t\tnext: {\n\t\t\t\t\t\tdomNode,\n\t\t\t\t\t\tmerged,\n\t\t\t\t\t\trequiresInsertBefore,\n\t\t\t\t\t\tnode: { properties }\n\t\t\t\t\t}\n\t\t\t\t} = item;\n\n\t\t\t\tprocessProperties(next, { properties: {} });\n\t\t\t\trunDeferredProperties(next);\n\t\t\t\tif (!merged) {\n\t\t\t\t\tlet insertBefore: any;\n\t\t\t\t\tif (requiresInsertBefore) {\n\t\t\t\t\t\tinsertBefore = findInsertBefore(next);\n\t\t\t\t\t} else if (_insertBeforeMap) {\n\t\t\t\t\t\tinsertBefore = _insertBeforeMap.get(next);\n\t\t\t\t\t}\n\t\t\t\t\tparentDomNode.insertBefore(domNode!, insertBefore);\n\t\t\t\t\tif (isDomVNode(next.node) && next.node.onAttach) {\n\t\t\t\t\t\tnext.node.onAttach();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ((domNode as HTMLElement).tagName === 'OPTION' && domNode!.parentElement) {\n\t\t\t\t\tsetValue(domNode!.parentElement);\n\t\t\t\t}\n\t\t\t\trunEnterAnimation(next, _mountOptions.transition);\n\t\t\t\tconst instanceData = widgetInstanceMap.get(next.node.bind as WidgetBase);\n\t\t\t\tif (properties.key != null && instanceData) {\n\t\t\t\t\tinstanceData.nodeHandler.add(domNode as HTMLElement, `${properties.key}`);\n\t\t\t\t}\n\t\t\t\titem.next.inserted = true;\n\t\t\t} else if (item.type === 'update') {\n\t\t\t\tconst {\n\t\t\t\t\tnext,\n\t\t\t\t\tnext: { domNode, node },\n\t\t\t\t\tcurrent\n\t\t\t\t} = item;\n\t\t\t\tconst parent = _parentWrapperMap.get(next);\n\t\t\t\tif (parent && isWNodeWrapper(parent) && parent.instance) {\n\t\t\t\t\tconst instanceData = widgetInstanceMap.get(parent.instance);\n\t\t\t\t\tinstanceData && instanceData.nodeHandler.addRoot();\n\t\t\t\t}\n\n\t\t\t\tconst previousProperties = buildPreviousProperties(domNode, current, next);\n\t\t\t\tconst instanceData = widgetInstanceMap.get(next.node.bind as WidgetBase);\n\n\t\t\t\tprocessProperties(next, previousProperties);\n\t\t\t\trunDeferredProperties(next);\n\n\t\t\t\tif (instanceData && node.properties.key != null) {\n\t\t\t\t\tinstanceData.nodeHandler.add(next.domNode as HTMLElement, `${node.properties.key}`);\n\t\t\t\t}\n\t\t\t} else if (item.type === 'delete') {\n\t\t\t\tconst { current } = item;\n\t\t\t\tconst { exitAnimation } = current.node.properties;\n\t\t\t\tif (exitAnimation && exitAnimation !== true) {\n\t\t\t\t\trunExitAnimation(current, _mountOptions.transition, exitAnimation);\n\t\t\t\t} else {\n\t\t\t\t\tcurrent.domNode!.parentNode!.removeChild(current.domNode!);\n\t\t\t\t\tcurrent.domNode = undefined;\n\t\t\t\t}\n\t\t\t} else if (item.type === 'attach') {\n\t\t\t\tconst { instance, attached } = item;\n\t\t\t\tconst instanceData = widgetInstanceMap.get(instance)!;\n\t\t\t\tinstanceData.nodeHandler.addRoot();\n\t\t\t\tattached && instanceData.onAttach();\n\t\t\t} else if (item.type === 'detach') {\n\t\t\t\tif (item.current.instance) {\n\t\t\t\t\tconst instanceData = widgetInstanceMap.get(item.current.instance);\n\t\t\t\t\tinstanceData && instanceData.onDetach();\n\t\t\t\t}\n\t\t\t\titem.current.domNode = undefined;\n\t\t\t\titem.current.node.bind = undefined;\n\t\t\t\titem.current.instance = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction _runCallbacks() {\n\t\trunAfterRenderCallbacks();\n\t\trunDeferredRenderCallbacks();\n\t}\n\n\tfunction _processMergeNodes(next: DNodeWrapper, mergeNodes: Node[]) {\n\t\tconst { merge } = _mountOptions;\n\t\tif (merge && mergeNodes.length) {\n\t\t\tif (isVNodeWrapper(next)) {\n\t\t\t\tlet {\n\t\t\t\t\tnode: { tag }\n\t\t\t\t} = next;\n\t\t\t\tfor (let i = 0; i < mergeNodes.length; i++) {\n\t\t\t\t\tconst domElement = mergeNodes[i] as Element;\n\t\t\t\t\tif (tag.toUpperCase() === (domElement.tagName || '')) {\n\t\t\t\t\t\tconst mergeNodeIndex = _allMergedNodes.indexOf(domElement);\n\t\t\t\t\t\tif (mergeNodeIndex !== -1) {\n\t\t\t\t\t\t\t_allMergedNodes.splice(mergeNodeIndex, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmergeNodes.splice(i, 1);\n\t\t\t\t\t\tnext.domNode = domElement;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnext.mergeNodes = mergeNodes;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction registerDistinguishableCallback(childNodes: DNodeWrapper[], index: number) {\n\t\t_afterRenderCallbacks.push(() => {\n\t\t\tconst parentWNodeWrapper = findParentWNodeWrapper(childNodes[index]);\n\t\t\tcheckDistinguishable(childNodes, index, parentWNodeWrapper);\n\t\t});\n\t}\n\n\tfunction _process(current: DNodeWrapper[], next: DNodeWrapper[], meta: ProcessMeta = {}): void {\n\t\tlet { mergeNodes = [], oldIndex = 0, newIndex = 0 } = meta;\n\t\tconst currentLength = current.length;\n\t\tconst nextLength = next.length;\n\t\tconst hasPreviousSiblings = currentLength > 1 || (currentLength > 0 && currentLength < nextLength);\n\t\tconst instructions: Instruction[] = [];\n\t\tif (newIndex < nextLength) {\n\t\t\tlet currentWrapper = oldIndex < currentLength ? current[oldIndex] : undefined;\n\t\t\tconst nextWrapper = next[newIndex];\n\t\t\tnextWrapper.hasPreviousSiblings = hasPreviousSiblings;\n\n\t\t\t_processMergeNodes(nextWrapper, mergeNodes);\n\n\t\t\tif (currentWrapper && same(currentWrapper, nextWrapper)) {\n\t\t\t\toldIndex++;\n\t\t\t\tnewIndex++;\n\t\t\t\tif (isVNodeWrapper(currentWrapper) && isVNodeWrapper(nextWrapper)) {\n\t\t\t\t\tnextWrapper.inserted = currentWrapper.inserted;\n\t\t\t\t}\n\t\t\t\tinstructions.push({ current: currentWrapper, next: nextWrapper });\n\t\t\t} else if (!currentWrapper || findIndexOfChild(current, nextWrapper, oldIndex + 1) === -1) {\n\t\t\t\thas('dojo-debug') && current.length && registerDistinguishableCallback(next, newIndex);\n\t\t\t\tinstructions.push({ current: undefined, next: nextWrapper });\n\t\t\t\tnewIndex++;\n\t\t\t} else if (findIndexOfChild(next, currentWrapper, newIndex + 1) === -1) {\n\t\t\t\thas('dojo-debug') && registerDistinguishableCallback(current, oldIndex);\n\t\t\t\tinstructions.push({ current: currentWrapper, next: undefined });\n\t\t\t\toldIndex++;\n\t\t\t} else {\n\t\t\t\thas('dojo-debug') && registerDistinguishableCallback(next, newIndex);\n\t\t\t\thas('dojo-debug') && registerDistinguishableCallback(current, oldIndex);\n\t\t\t\tinstructions.push({ current: currentWrapper, next: undefined });\n\t\t\t\tinstructions.push({ current: undefined, next: nextWrapper });\n\t\t\t\toldIndex++;\n\t\t\t\tnewIndex++;\n\t\t\t}\n\t\t}\n\n\t\tif (newIndex < nextLength) {\n\t\t\t_processQueue.push({ current, next, meta: { mergeNodes, oldIndex, newIndex } });\n\t\t}\n\n\t\tif (currentLength > oldIndex && newIndex >= nextLength) {\n\t\t\tfor (let i = oldIndex; i < currentLength; i++) {\n\t\t\t\thas('dojo-debug') && registerDistinguishableCallback(current, i);\n\t\t\t\tinstructions.push({ current: current[i], next: undefined });\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < instructions.length; i++) {\n\t\t\tconst { item, dom, widget } = _processOne(instructions[i]);\n\t\t\twidget && _processQueue.push(widget);\n\t\t\titem && _processQueue.push(item);\n\t\t\tdom && _applicationQueue.push(dom);\n\t\t}\n\t}\n\n\tfunction _processOne({ current, next }: Instruction): ProcessResult {\n\t\tif (current !== next) {\n\t\t\tif (!current && next) {\n\t\t\t\tif (isVNodeWrapper(next)) {\n\t\t\t\t\treturn _createDom({ next });\n\t\t\t\t} else {\n\t\t\t\t\treturn _createWidget({ next });\n\t\t\t\t}\n\t\t\t} else if (current && next) {\n\t\t\t\tif (isVNodeWrapper(current) && isVNodeWrapper(next)) {\n\t\t\t\t\treturn _updateDom({ current, next });\n\t\t\t\t} else if (isWNodeWrapper(current) && isWNodeWrapper(next)) {\n\t\t\t\t\treturn _updateWidget({ current, next });\n\t\t\t\t}\n\t\t\t} else if (current && !next) {\n\t\t\t\tif (isVNodeWrapper(current)) {\n\t\t\t\t\treturn _removeDom({ current });\n\t\t\t\t} else if (isWNodeWrapper(current)) {\n\t\t\t\t\treturn _removeWidget({ current });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn {};\n\t}\n\n\tfunction _createWidget({ next }: CreateWidgetInstruction): ProcessResult {\n\t\tlet {\n\t\t\tnode: { widgetConstructor }\n\t\t} = next;\n\t\tlet { registry } = _mountOptions;\n\t\tif (!isWidgetBaseConstructor(widgetConstructor)) {\n\t\t\treturn {};\n\t\t}\n\t\tconst instance = new widgetConstructor() as WidgetBase;\n\t\tif (registry) {\n\t\t\tinstance.registry.base = registry;\n\t\t}\n\t\tconst instanceData = widgetInstanceMap.get(instance)!;\n\t\tinstanceData.invalidate = () => {\n\t\t\tinstanceData.dirty = true;\n\t\t\tif (!instanceData.rendering && _instanceToWrapperMap.has(instance)) {\n\t\t\t\t_invalidationQueue.push({ instance, depth: next.depth, order: next.order });\n\t\t\t\t_schedule();\n\t\t\t}\n\t\t};\n\t\tinstanceData.rendering = true;\n\t\tinstance.__setProperties__(next.node.properties, next.node.bind);\n\t\tinstance.__setChildren__(next.node.children);\n\t\tnext.instance = instance;\n\t\tlet rendered = instance.__render__();\n\t\tinstanceData.rendering = false;\n\t\tif (rendered) {\n\t\t\trendered = Array.isArray(rendered) ? rendered : [rendered];\n\t\t\tnext.childrenWrappers = renderedToWrapper(rendered, next, null);\n\t\t}\n\t\tif (next.instance) {\n\t\t\t_instanceToWrapperMap.set(next.instance, next);\n\t\t\tif (!parentInvalidate && !(next.instance as any).isWNodeWrapper) {\n\t\t\t\tparentInvalidate = next.instance.invalidate.bind(next.instance);\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\titem: { next: next.childrenWrappers, meta: { mergeNodes: next.mergeNodes } },\n\t\t\twidget: { type: 'attach', instance, attached: true }\n\t\t};\n\t}\n\n\tfunction _updateWidget({ current, next }: UpdateWidgetInstruction): ProcessResult {\n\t\tcurrent = (current.instance && _instanceToWrapperMap.get(current.instance)) || current;\n\t\tconst { instance, domNode, hasAnimations } = current;\n\t\tif (!instance) {\n\t\t\treturn [] as ProcessResult;\n\t\t}\n\t\tconst instanceData = widgetInstanceMap.get(instance)!;\n\t\tnext.instance = instance;\n\t\tnext.domNode = domNode;\n\t\tnext.hasAnimations = hasAnimations;\n\t\tinstanceData.rendering = true;\n\t\tinstance!.__setProperties__(next.node.properties, next.node.bind);\n\t\tinstance!.__setChildren__(next.node.children);\n\t\t_instanceToWrapperMap.set(next.instance!, next);\n\t\tif (instanceData.dirty) {\n\t\t\tlet rendered = instance!.__render__();\n\t\t\tinstanceData.rendering = false;\n\t\t\tif (rendered) {\n\t\t\t\trendered = Array.isArray(rendered) ? rendered : [rendered];\n\t\t\t\tnext.childrenWrappers = renderedToWrapper(rendered, next, current);\n\t\t\t}\n\t\t\treturn {\n\t\t\t\titem: { current: current.childrenWrappers, next: next.childrenWrappers, meta: {} },\n\t\t\t\twidget: { type: 'attach', instance, attached: false }\n\t\t\t};\n\t\t}\n\t\tinstanceData.rendering = false;\n\t\tnext.childrenWrappers = current.childrenWrappers;\n\t\treturn {\n\t\t\twidget: { type: 'attach', instance, attached: false }\n\t\t};\n\t}\n\n\tfunction _removeWidget({ current }: RemoveWidgetInstruction): ProcessResult {\n\t\tcurrent = current.instance ? _instanceToWrapperMap.get(current.instance)! : current;\n\t\t_wrapperSiblingMap.delete(current);\n\t\t_parentWrapperMap.delete(current);\n\t\t_instanceToWrapperMap.delete(current.instance!);\n\n\t\treturn {\n\t\t\titem: { current: current.childrenWrappers, meta: {} },\n\t\t\twidget: { type: 'detach', current }\n\t\t};\n\t}\n\n\tfunction _createDom({ next }: CreateDomInstruction): ProcessResult {\n\t\tlet mergeNodes: Node[] = [];\n\t\tconst parentDomNode = findParentDomNode(next)!;\n\t\tif (!next.domNode) {\n\t\t\tif ((next.node as any).domNode) {\n\t\t\t\tnext.domNode = (next.node as any).domNode;\n\t\t\t} else {\n\t\t\t\tif (next.node.tag === 'svg') {\n\t\t\t\t\tnext.namespace = NAMESPACE_SVG;\n\t\t\t\t}\n\t\t\t\tif (next.node.tag) {\n\t\t\t\t\tif (next.namespace) {\n\t\t\t\t\t\tnext.domNode = global.document.createElementNS(next.namespace, next.node.tag);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnext.domNode = global.document.createElement(next.node.tag);\n\t\t\t\t\t}\n\t\t\t\t} else if (next.node.text != null) {\n\t\t\t\t\tnext.domNode = global.document.createTextNode(next.node.text);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (_insertBeforeMap && _allMergedNodes.length) {\n\t\t\t\tif (parentDomNode === _allMergedNodes[0].parentNode) {\n\t\t\t\t\t_insertBeforeMap.set(next, _allMergedNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (_mountOptions.merge) {\n\t\t\t\tmergeNodes = arrayFrom(next.domNode.childNodes);\n\t\t\t\t_allMergedNodes = [..._allMergedNodes, ...mergeNodes];\n\t\t\t}\n\t\t\tnext.merged = true;\n\t\t}\n\t\tif (next.domNode) {\n\t\t\tif (next.node.children) {\n\t\t\t\tnext.childrenWrappers = renderedToWrapper(next.node.children, next, null);\n\t\t\t}\n\t\t}\n\t\tconst parentWNodeWrapper = findParentWNodeWrapper(next);\n\t\tif (parentWNodeWrapper && !parentWNodeWrapper.domNode) {\n\t\t\tparentWNodeWrapper.domNode = next.domNode;\n\t\t}\n\t\tconst dom: ApplicationInstruction = {\n\t\t\tnext: next!,\n\t\t\tparentDomNode: parentDomNode,\n\t\t\ttype: 'create'\n\t\t};\n\t\tif (next.childrenWrappers) {\n\t\t\treturn {\n\t\t\t\titem: { current: [], next: next.childrenWrappers, meta: { mergeNodes } },\n\t\t\t\tdom\n\t\t\t};\n\t\t}\n\t\treturn { dom };\n\t}\n\n\tfunction _updateDom({ current, next }: UpdateDomInstruction): ProcessResult {\n\t\tconst parentDomNode = findParentDomNode(current);\n\t\tnext.domNode = current.domNode;\n\t\tnext.namespace = current.namespace;\n\t\tif (next.node.text && next.node.text !== current.node.text) {\n\t\t\tconst updatedTextNode = parentDomNode!.ownerDocument.createTextNode(next.node.text!);\n\t\t\tparentDomNode!.replaceChild(updatedTextNode, next.domNode!);\n\t\t\tnext.domNode = updatedTextNode;\n\t\t} else if (next.node.children) {\n\t\t\tconst children = renderedToWrapper(next.node.children, next, current);\n\t\t\tnext.childrenWrappers = children;\n\t\t}\n\t\treturn {\n\t\t\titem: { current: current.childrenWrappers, next: next.childrenWrappers, meta: {} },\n\t\t\tdom: { type: 'update', next, current }\n\t\t};\n\t}\n\n\tfunction _removeDom({ current }: RemoveDomInstruction): ProcessResult {\n\t\t_wrapperSiblingMap.delete(current);\n\t\t_parentWrapperMap.delete(current);\n\t\tcurrent.node.bind = undefined;\n\t\tif (current.hasAnimations) {\n\t\t\treturn {\n\t\t\t\titem: { current: current.childrenWrappers, meta: {} },\n\t\t\t\tdom: { type: 'delete', current }\n\t\t\t};\n\t\t}\n\n\t\tif (current.childrenWrappers) {\n\t\t\t_afterRenderCallbacks.push(() => {\n\t\t\t\tlet wrappers = current.childrenWrappers || [];\n\t\t\t\tlet wrapper: DNodeWrapper | undefined;\n\t\t\t\twhile ((wrapper = wrappers.pop())) {\n\t\t\t\t\tif (wrapper.childrenWrappers) {\n\t\t\t\t\t\twrappers.push(...wrapper.childrenWrappers);\n\t\t\t\t\t\twrapper.childrenWrappers = undefined;\n\t\t\t\t\t}\n\t\t\t\t\tif (isWNodeWrapper(wrapper)) {\n\t\t\t\t\t\tif (wrapper.instance) {\n\t\t\t\t\t\t\t_instanceToWrapperMap.delete(wrapper.instance);\n\t\t\t\t\t\t\tconst instanceData = widgetInstanceMap.get(wrapper.instance);\n\t\t\t\t\t\t\tinstanceData && instanceData.onDetach();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twrapper.instance = undefined;\n\t\t\t\t\t}\n\t\t\t\t\t_wrapperSiblingMap.delete(wrapper);\n\t\t\t\t\t_parentWrapperMap.delete(wrapper);\n\t\t\t\t\twrapper.domNode = undefined;\n\t\t\t\t\twrapper.node.bind = undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tdom: { type: 'delete', current }\n\t\t};\n\t}\n\n\treturn {\n\t\tmount,\n\t\tinvalidate\n\t};\n}\n\nexport default renderer;\n","import global from './global';\nimport has from '../has/has';\nimport { wrapNative } from './support/util';\n\nexport interface StringNormalize {\n\t/**\n\t * Returns the String value result of normalizing the string into the normalization form\n\t * named by form as specified in Unicode Standard Annex #15, Unicode Normalization Forms.\n\t * @param target The target string\n\t * @param form Applicable values: \"NFC\", \"NFD\", \"NFKC\", or \"NFKD\", If not specified default\n\t * is \"NFC\"\n\t */\n\t(target: string, form: 'NFC' | 'NFD' | 'NFKC' | 'NFKD'): string;\n\n\t/**\n\t * Returns the String value result of normalizing the string into the normalization form\n\t * named by form as specified in Unicode Standard Annex #15, Unicode Normalization Forms.\n\t * @param target The target string\n\t * @param form Applicable values: \"NFC\", \"NFD\", \"NFKC\", or \"NFKD\", If not specified default\n\t * is \"NFC\"\n\t */\n\t(target: string, form?: string): string;\n}\n\n/**\n * The minimum location of high surrogates\n */\nexport const HIGH_SURROGATE_MIN = 0xd800;\n\n/**\n * The maximum location of high surrogates\n */\nexport const HIGH_SURROGATE_MAX = 0xdbff;\n\n/**\n * The minimum location of low surrogates\n */\nexport const LOW_SURROGATE_MIN = 0xdc00;\n\n/**\n * The maximum location of low surrogates\n */\nexport const LOW_SURROGATE_MAX = 0xdfff;\n\n/* ES6 static methods */\n\n/**\n * Return the String value whose elements are, in order, the elements in the List elements.\n * If length is 0, the empty string is returned.\n * @param codePoints The code points to generate the string\n */\nexport let fromCodePoint: (...codePoints: number[]) => string;\n\n/**\n * `raw` is intended for use as a tag function of a Tagged Template String. When called\n * as such the first argument will be a well formed template call site object and the rest\n * parameter will contain the substitution values.\n * @param template A well-formed template string call site representation.\n * @param substitutions A set of substitution values.\n */\nexport let raw: (template: TemplateStringsArray, ...substitutions: any[]) => string;\n\n/* ES6 instance methods */\n\n/**\n * Returns a nonnegative integer Number less than 1114112 (0x110000) that is the code point\n * value of the UTF-16 encoded code point starting at the string element at position pos in\n * the String resulting from converting this object to a String.\n * If there is no element at that position, the result is undefined.\n * If a valid UTF-16 surrogate pair does not begin at pos, the result is the code unit at pos.\n */\nexport let codePointAt: (target: string, pos?: number) => number | undefined;\n\n/**\n * Returns true if the sequence of elements of searchString converted to a String is the\n * same as the corresponding elements of this object (converted to a String) starting at\n * endPosition  length(this). Otherwise returns false.\n */\nexport let endsWith: (target: string, searchString: string, endPosition?: number) => boolean;\n\n/**\n * Returns true if searchString appears as a substring of the result of converting this\n * object to a String, at one or more positions that are\n * greater than or equal to position; otherwise, returns false.\n * @param target The target string\n * @param searchString search string\n * @param position If position is undefined, 0 is assumed, so as to search all of the String.\n */\nexport let includes: (target: string, searchString: string, position?: number) => boolean;\n\n/**\n * Returns the String value result of normalizing the string into the normalization form\n * named by form as specified in Unicode Standard Annex #15, Unicode Normalization Forms.\n * @param target The target string\n * @param form Applicable values: \"NFC\", \"NFD\", \"NFKC\", or \"NFKD\", If not specified default\n * is \"NFC\"\n */\nexport let normalize: StringNormalize;\n\n/**\n * Returns a String value that is made from count copies appended together. If count is 0,\n * T is the empty String is returned.\n * @param count number of copies to append\n */\nexport let repeat: (target: string, count?: number) => string;\n\n/**\n * Returns true if the sequence of elements of searchString converted to a String is the\n * same as the corresponding elements of this object (converted to a String) starting at\n * position. Otherwise returns false.\n */\nexport let startsWith: (target: string, searchString: string, position?: number) => boolean;\n\n/* ES7 instance methods */\n\n/**\n * Pads the current string with a given string (possibly repeated) so that the resulting string reaches a given length.\n * The padding is applied from the end (right) of the current string.\n *\n * @param target The target string\n * @param maxLength The length of the resulting string once the current string has been padded.\n *        If this parameter is smaller than the current string's length, the current string will be returned as it is.\n *\n * @param fillString The string to pad the current string with.\n *        If this string is too long, it will be truncated and the left-most part will be applied.\n *        The default value for this parameter is \" \" (U+0020).\n */\nexport let padEnd: (target: string, maxLength: number, fillString?: string) => string;\n\n/**\n * Pads the current string with a given string (possibly repeated) so that the resulting string reaches a given length.\n * The padding is applied from the start (left) of the current string.\n *\n * @param target The target string\n * @param maxLength The length of the resulting string once the current string has been padded.\n *        If this parameter is smaller than the current string's length, the current string will be returned as it is.\n *\n * @param fillString The string to pad the current string with.\n *        If this string is too long, it will be truncated and the left-most part will be applied.\n *        The default value for this parameter is \" \" (U+0020).\n */\nexport let padStart: (target: string, maxLength: number, fillString?: string) => string;\n\nif (has('es6-string') && has('es6-string-raw')) {\n\tfromCodePoint = global.String.fromCodePoint;\n\traw = global.String.raw;\n\n\tcodePointAt = wrapNative(global.String.prototype.codePointAt);\n\tendsWith = wrapNative(global.String.prototype.endsWith);\n\tincludes = wrapNative(global.String.prototype.includes);\n\tnormalize = wrapNative(global.String.prototype.normalize);\n\trepeat = wrapNative(global.String.prototype.repeat);\n\tstartsWith = wrapNative(global.String.prototype.startsWith);\n} else {\n\t/**\n\t * Validates that text is defined, and normalizes position (based on the given default if the input is NaN).\n\t * Used by startsWith, includes, and endsWith.\n\t *\n\t * @return Normalized position.\n\t */\n\tconst normalizeSubstringArgs = function(\n\t\tname: string,\n\t\ttext: string,\n\t\tsearch: string,\n\t\tposition: number,\n\t\tisEnd: boolean = false\n\t): [string, string, number] {\n\t\tif (text == null) {\n\t\t\tthrow new TypeError('string.' + name + ' requires a valid string to search against.');\n\t\t}\n\n\t\tconst length = text.length;\n\t\tposition = position !== position ? (isEnd ? length : 0) : position;\n\t\treturn [text, String(search), Math.min(Math.max(position, 0), length)];\n\t};\n\n\tfromCodePoint = function fromCodePoint(...codePoints: number[]): string {\n\t\t// Adapted from https://github.com/mathiasbynens/String.fromCodePoint\n\t\tconst length = arguments.length;\n\t\tif (!length) {\n\t\t\treturn '';\n\t\t}\n\n\t\tconst fromCharCode = String.fromCharCode;\n\t\tconst MAX_SIZE = 0x4000;\n\t\tlet codeUnits: number[] = [];\n\t\tlet index = -1;\n\t\tlet result = '';\n\n\t\twhile (++index < length) {\n\t\t\tlet codePoint = Number(arguments[index]);\n\n\t\t\t// Code points must be finite integers within the valid range\n\t\t\tlet isValid =\n\t\t\t\tisFinite(codePoint) && Math.floor(codePoint) === codePoint && codePoint >= 0 && codePoint <= 0x10ffff;\n\t\t\tif (!isValid) {\n\t\t\t\tthrow RangeError('string.fromCodePoint: Invalid code point ' + codePoint);\n\t\t\t}\n\n\t\t\tif (codePoint <= 0xffff) {\n\t\t\t\t// BMP code point\n\t\t\t\tcodeUnits.push(codePoint);\n\t\t\t} else {\n\t\t\t\t// Astral code point; split in surrogate halves\n\t\t\t\t// https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n\t\t\t\tcodePoint -= 0x10000;\n\t\t\t\tlet highSurrogate = (codePoint >> 10) + HIGH_SURROGATE_MIN;\n\t\t\t\tlet lowSurrogate = (codePoint % 0x400) + LOW_SURROGATE_MIN;\n\t\t\t\tcodeUnits.push(highSurrogate, lowSurrogate);\n\t\t\t}\n\n\t\t\tif (index + 1 === length || codeUnits.length > MAX_SIZE) {\n\t\t\t\tresult += fromCharCode.apply(null, codeUnits);\n\t\t\t\tcodeUnits.length = 0;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t};\n\n\traw = function raw(callSite: TemplateStringsArray, ...substitutions: any[]): string {\n\t\tlet rawStrings = callSite.raw;\n\t\tlet result = '';\n\t\tlet numSubstitutions = substitutions.length;\n\n\t\tif (callSite == null || callSite.raw == null) {\n\t\t\tthrow new TypeError('string.raw requires a valid callSite object with a raw value');\n\t\t}\n\n\t\tfor (let i = 0, length = rawStrings.length; i < length; i++) {\n\t\t\tresult += rawStrings[i] + (i < numSubstitutions && i < length - 1 ? substitutions[i] : '');\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tcodePointAt = function codePointAt(text: string, position: number = 0): number | undefined {\n\t\t// Adapted from https://github.com/mathiasbynens/String.prototype.codePointAt\n\t\tif (text == null) {\n\t\t\tthrow new TypeError('string.codePointAt requries a valid string.');\n\t\t}\n\t\tconst length = text.length;\n\n\t\tif (position !== position) {\n\t\t\tposition = 0;\n\t\t}\n\t\tif (position < 0 || position >= length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Get the first code unit\n\t\tconst first = text.charCodeAt(position);\n\t\tif (first >= HIGH_SURROGATE_MIN && first <= HIGH_SURROGATE_MAX && length > position + 1) {\n\t\t\t// Start of a surrogate pair (high surrogate and there is a next code unit); check for low surrogate\n\t\t\t// https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n\t\t\tconst second = text.charCodeAt(position + 1);\n\t\t\tif (second >= LOW_SURROGATE_MIN && second <= LOW_SURROGATE_MAX) {\n\t\t\t\treturn (first - HIGH_SURROGATE_MIN) * 0x400 + second - LOW_SURROGATE_MIN + 0x10000;\n\t\t\t}\n\t\t}\n\t\treturn first;\n\t};\n\n\tendsWith = function endsWith(text: string, search: string, endPosition?: number): boolean {\n\t\tif (search === '') {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (typeof endPosition === 'undefined') {\n\t\t\tendPosition = text.length;\n\t\t} else if (endPosition === null || isNaN(endPosition)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t[text, search, endPosition] = normalizeSubstringArgs('endsWith', text, search, endPosition, true);\n\n\t\tconst start = endPosition - search.length;\n\t\tif (start < 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn text.slice(start, endPosition) === search;\n\t};\n\n\tincludes = function includes(text: string, search: string, position: number = 0): boolean {\n\t\t[text, search, position] = normalizeSubstringArgs('includes', text, search, position);\n\t\treturn text.indexOf(search, position) !== -1;\n\t};\n\n\trepeat = function repeat(text: string, count: number = 0): string {\n\t\t// Adapted from https://github.com/mathiasbynens/String.prototype.repeat\n\t\tif (text == null) {\n\t\t\tthrow new TypeError('string.repeat requires a valid string.');\n\t\t}\n\t\tif (count !== count) {\n\t\t\tcount = 0;\n\t\t}\n\t\tif (count < 0 || count === Infinity) {\n\t\t\tthrow new RangeError('string.repeat requires a non-negative finite count.');\n\t\t}\n\n\t\tlet result = '';\n\t\twhile (count) {\n\t\t\tif (count % 2) {\n\t\t\t\tresult += text;\n\t\t\t}\n\t\t\tif (count > 1) {\n\t\t\t\ttext += text;\n\t\t\t}\n\t\t\tcount >>= 1;\n\t\t}\n\t\treturn result;\n\t};\n\n\tstartsWith = function startsWith(text: string, search: string, position: number = 0): boolean {\n\t\tsearch = String(search);\n\t\t[text, search, position] = normalizeSubstringArgs('startsWith', text, search, position);\n\n\t\tconst end = position + search.length;\n\t\tif (end > text.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn text.slice(position, end) === search;\n\t};\n}\n\nif (has('es2017-string')) {\n\tpadEnd = wrapNative(global.String.prototype.padEnd);\n\tpadStart = wrapNative(global.String.prototype.padStart);\n} else {\n\tpadEnd = function padEnd(text: string, maxLength: number, fillString: string = ' '): string {\n\t\tif (text === null || text === undefined) {\n\t\t\tthrow new TypeError('string.repeat requires a valid string.');\n\t\t}\n\n\t\tif (maxLength === Infinity) {\n\t\t\tthrow new RangeError('string.padEnd requires a non-negative finite count.');\n\t\t}\n\n\t\tif (maxLength === null || maxLength === undefined || maxLength < 0) {\n\t\t\tmaxLength = 0;\n\t\t}\n\n\t\tlet strText = String(text);\n\t\tconst padding = maxLength - strText.length;\n\n\t\tif (padding > 0) {\n\t\t\tstrText +=\n\t\t\t\trepeat(fillString, Math.floor(padding / fillString.length)) +\n\t\t\t\tfillString.slice(0, padding % fillString.length);\n\t\t}\n\n\t\treturn strText;\n\t};\n\n\tpadStart = function padStart(text: string, maxLength: number, fillString: string = ' '): string {\n\t\tif (text === null || text === undefined) {\n\t\t\tthrow new TypeError('string.repeat requires a valid string.');\n\t\t}\n\n\t\tif (maxLength === Infinity) {\n\t\t\tthrow new RangeError('string.padStart requires a non-negative finite count.');\n\t\t}\n\n\t\tif (maxLength === null || maxLength === undefined || maxLength < 0) {\n\t\t\tmaxLength = 0;\n\t\t}\n\n\t\tlet strText = String(text);\n\t\tconst padding = maxLength - strText.length;\n\n\t\tif (padding > 0) {\n\t\t\tstrText =\n\t\t\t\trepeat(fillString, Math.floor(padding / fillString.length)) +\n\t\t\t\tfillString.slice(0, padding % fillString.length) +\n\t\t\t\tstrText;\n\t\t}\n\n\t\treturn strText;\n\t};\n}\n","import { VNodeProperties } from './../interfaces';\n\nlet browserSpecificTransitionEndEventName = '';\nlet browserSpecificAnimationEndEventName = '';\n\nfunction determineBrowserStyleNames(element: HTMLElement) {\n\tif ('WebkitTransition' in element.style) {\n\t\tbrowserSpecificTransitionEndEventName = 'webkitTransitionEnd';\n\t\tbrowserSpecificAnimationEndEventName = 'webkitAnimationEnd';\n\t} else if ('transition' in element.style || 'MozTransition' in element.style) {\n\t\tbrowserSpecificTransitionEndEventName = 'transitionend';\n\t\tbrowserSpecificAnimationEndEventName = 'animationend';\n\t} else {\n\t\tthrow new Error('Your browser is not supported');\n\t}\n}\n\nfunction initialize(element: HTMLElement) {\n\tif (browserSpecificAnimationEndEventName === '') {\n\t\tdetermineBrowserStyleNames(element);\n\t}\n}\n\nfunction runAndCleanUp(element: HTMLElement, startAnimation: () => void, finishAnimation: () => void) {\n\tinitialize(element);\n\n\tlet finished = false;\n\n\tlet transitionEnd = function() {\n\t\tif (!finished) {\n\t\t\tfinished = true;\n\t\t\telement.removeEventListener(browserSpecificTransitionEndEventName, transitionEnd);\n\t\t\telement.removeEventListener(browserSpecificAnimationEndEventName, transitionEnd);\n\n\t\t\tfinishAnimation();\n\t\t}\n\t};\n\n\tstartAnimation();\n\n\telement.addEventListener(browserSpecificAnimationEndEventName, transitionEnd);\n\telement.addEventListener(browserSpecificTransitionEndEventName, transitionEnd);\n}\n\nfunction exit(node: HTMLElement, properties: VNodeProperties, exitAnimation: string, removeNode: () => void) {\n\tconst activeClass = properties.exitAnimationActive || `${exitAnimation}-active`;\n\n\trunAndCleanUp(\n\t\tnode,\n\t\t() => {\n\t\t\tnode.classList.add(exitAnimation);\n\n\t\t\trequestAnimationFrame(function() {\n\t\t\t\tnode.classList.add(activeClass);\n\t\t\t});\n\t\t},\n\t\t() => {\n\t\t\tremoveNode();\n\t\t}\n\t);\n}\n\nfunction enter(node: HTMLElement, properties: VNodeProperties, enterAnimation: string) {\n\tconst activeClass = properties.enterAnimationActive || `${enterAnimation}-active`;\n\n\trunAndCleanUp(\n\t\tnode,\n\t\t() => {\n\t\t\tnode.classList.add(enterAnimation);\n\n\t\t\trequestAnimationFrame(function() {\n\t\t\t\tnode.classList.add(activeClass);\n\t\t\t});\n\t\t},\n\t\t() => {\n\t\t\tnode.classList.remove(enterAnimation);\n\t\t\tnode.classList.remove(activeClass);\n\t\t}\n\t);\n}\n\nexport default {\n\tenter,\n\texit\n};\n","import global from './global';\nimport has from '../has/has';\nimport { isSymbol } from './Symbol';\n\nexport interface ObjectAssign {\n\t/**\n\t * Copy the values of all of the enumerable own properties from one or more source objects to a\n\t * target object. Returns the target object.\n\t * @param target The target object to copy to.\n\t * @param source The source object from which to copy properties.\n\t */\n\t<T, U>(target: T, source: U): T & U;\n\n\t/**\n\t * Copy the values of all of the enumerable own properties from one or more source objects to a\n\t * target object. Returns the target object.\n\t * @param target The target object to copy to.\n\t * @param source1 The first source object from which to copy properties.\n\t * @param source2 The second source object from which to copy properties.\n\t */\n\t<T, U, V>(target: T, source1: U, source2: V): T & U & V;\n\n\t/**\n\t * Copy the values of all of the enumerable own properties from one or more source objects to a\n\t * target object. Returns the target object.\n\t * @param target The target object to copy to.\n\t * @param source1 The first source object from which to copy properties.\n\t * @param source2 The second source object from which to copy properties.\n\t * @param source3 The third source object from which to copy properties.\n\t */\n\t<T, U, V, W>(target: T, source1: U, source2: V, source3: W): T & U & V & W;\n\n\t/**\n\t * Copy the values of all of the enumerable own properties from one or more source objects to a\n\t * target object. Returns the target object.\n\t * @param target The target object to copy to.\n\t * @param sources One or more source objects from which to copy properties\n\t */\n\t(target: object, ...sources: any[]): any;\n}\n\nexport interface ObjectEnteries {\n\t/**\n\t * Returns an array of key/values of the enumerable properties of an object\n\t * @param o Object that contains the properties and methods. This can be an object that you created or an existing Document Object Model (DOM) object.\n\t */\n\t<T extends { [key: string]: any }, K extends keyof T>(o: T): [keyof T, T[K]][];\n\n\t/**\n\t * Returns an array of key/values of the enumerable properties of an object\n\t * @param o Object that contains the properties and methods. This can be an object that you created or an existing Document Object Model (DOM) object.\n\t */\n\t(o: object): [string, any][];\n}\n\nexport interface ObjectGetOwnPropertyDescriptors {\n\t<T>(o: T): { [K in keyof T]: PropertyDescriptor };\n\t(o: any): { [key: string]: PropertyDescriptor };\n}\n\nexport interface ObjectValues {\n\t/**\n\t * Returns an array of values of the enumerable properties of an object\n\t * @param o Object that contains the properties and methods. This can be an object that you created or an existing Document Object Model (DOM) object.\n\t */\n\t<T>(o: { [s: string]: T }): T[];\n\n\t/**\n\t * Returns an array of values of the enumerable properties of an object\n\t * @param o Object that contains the properties and methods. This can be an object that you created or an existing Document Object Model (DOM) object.\n\t */\n\t(o: object): any[];\n}\n\nexport let assign: ObjectAssign;\n\n/**\n * Gets the own property descriptor of the specified object.\n * An own property descriptor is one that is defined directly on the object and is not\n * inherited from the object's prototype.\n * @param o Object that contains the property.\n * @param p Name of the property.\n */\nexport let getOwnPropertyDescriptor: <T, K extends keyof T>(o: T, propertyKey: K) => PropertyDescriptor | undefined;\n\n/**\n * Returns the names of the own properties of an object. The own properties of an object are those that are defined directly\n * on that object, and are not inherited from the object's prototype. The properties of an object include both fields (objects) and functions.\n * @param o Object that contains the own properties.\n */\nexport let getOwnPropertyNames: (o: any) => string[];\n\n/**\n * Returns an array of all symbol properties found directly on object o.\n * @param o Object to retrieve the symbols from.\n */\nexport let getOwnPropertySymbols: (o: any) => symbol[];\n\n/**\n * Returns true if the values are the same value, false otherwise.\n * @param value1 The first value.\n * @param value2 The second value.\n */\nexport let is: (value1: any, value2: any) => boolean;\n\n/**\n * Returns the names of the enumerable properties and methods of an object.\n * @param o Object that contains the properties and methods. This can be an object that you created or an existing Document Object Model (DOM) object.\n */\nexport let keys: (o: object) => string[];\n\n/* ES7 Object static methods */\n\nexport let getOwnPropertyDescriptors: ObjectGetOwnPropertyDescriptors;\n\nexport let entries: ObjectEnteries;\n\nexport let values: ObjectValues;\n\nif (has('es6-object')) {\n\tconst globalObject = global.Object;\n\tassign = globalObject.assign;\n\tgetOwnPropertyDescriptor = globalObject.getOwnPropertyDescriptor;\n\tgetOwnPropertyNames = globalObject.getOwnPropertyNames;\n\tgetOwnPropertySymbols = globalObject.getOwnPropertySymbols;\n\tis = globalObject.is;\n\tkeys = globalObject.keys;\n} else {\n\tkeys = function symbolAwareKeys(o: object): string[] {\n\t\treturn Object.keys(o).filter((key) => !Boolean(key.match(/^@@.+/)));\n\t};\n\n\tassign = function assign(target: any, ...sources: any[]) {\n\t\tif (target == null) {\n\t\t\t// TypeError if undefined or null\n\t\t\tthrow new TypeError('Cannot convert undefined or null to object');\n\t\t}\n\n\t\tconst to = Object(target);\n\t\tsources.forEach((nextSource) => {\n\t\t\tif (nextSource) {\n\t\t\t\t// Skip over if undefined or null\n\t\t\t\tkeys(nextSource).forEach((nextKey) => {\n\t\t\t\t\tto[nextKey] = nextSource[nextKey];\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn to;\n\t};\n\n\tgetOwnPropertyDescriptor = function<T, K extends keyof T>(o: T, prop: K): PropertyDescriptor | undefined {\n\t\tif (isSymbol(prop)) {\n\t\t\treturn Object.getOwnPropertyDescriptor(o, prop);\n\t\t} else {\n\t\t\treturn Object.getOwnPropertyDescriptor(o, prop);\n\t\t}\n\t};\n\n\tgetOwnPropertyNames = function getOwnPropertyNames(o: any): string[] {\n\t\treturn Object.getOwnPropertyNames(o).filter((key) => !Boolean(key.match(/^@@.+/)));\n\t};\n\n\tgetOwnPropertySymbols = function getOwnPropertySymbols(o: any): symbol[] {\n\t\treturn Object.getOwnPropertyNames(o)\n\t\t\t.filter((key) => Boolean(key.match(/^@@.+/)))\n\t\t\t.map((key) => Symbol.for(key.substring(2)));\n\t};\n\n\tis = function is(value1: any, value2: any): boolean {\n\t\tif (value1 === value2) {\n\t\t\treturn value1 !== 0 || 1 / value1 === 1 / value2; // -0\n\t\t}\n\t\treturn value1 !== value1 && value2 !== value2; // NaN\n\t};\n}\n\nif (has('es2017-object')) {\n\tconst globalObject = global.Object;\n\tgetOwnPropertyDescriptors = globalObject.getOwnPropertyDescriptors;\n\tentries = globalObject.entries;\n\tvalues = globalObject.values;\n} else {\n\tgetOwnPropertyDescriptors = function getOwnPropertyDescriptors(o: any) {\n\t\treturn getOwnPropertyNames(o).reduce(\n\t\t\t(previous, key) => {\n\t\t\t\tprevious[key] = getOwnPropertyDescriptor(o, key)!;\n\t\t\t\treturn previous;\n\t\t\t},\n\t\t\t{} as { [key: string]: PropertyDescriptor }\n\t\t);\n\t};\n\n\tentries = function entries(o: any): [string, any][] {\n\t\treturn keys(o).map((key) => [key, o[key]] as [string, any]);\n\t};\n\n\tvalues = function values(o: any): any[] {\n\t\treturn keys(o).map((key) => o[key]);\n\t};\n}\n","import Promise from '../shim/Promise';\n\n/**\n * Used through the toolkit as a consistent API to manage how callers can \"cleanup\"\n * when doing a function.\n */\nexport interface Handle {\n\t/**\n\t * Perform the destruction/cleanup logic associated with this Handle\n\t */\n\tdestroy(): void;\n}\n\n/**\n * No op function used to replace a Destroyable instance's `destroy` method, once the instance has been destroyed\n */\nfunction noop(): Promise<boolean> {\n\treturn Promise.resolve(false);\n}\n\n/**\n * No op function used to replace a Destroyable instance's `own` method, once the instance has been destroyed\n */\nfunction destroyed(): never {\n\tthrow new Error('Call made to destroyed method');\n}\n\nexport class Destroyable {\n\t/**\n\t * The instance's handles\n\t */\n\tprivate handles: Handle[];\n\n\t/**\n\t * @constructor\n\t */\n\tconstructor() {\n\t\tthis.handles = [];\n\t}\n\n\t/**\n\t * Register handles for the instance that will be destroyed when `this.destroy` is called\n\t *\n\t * @param {Handle} handle The handle to add for the instance\n\t * @returns {Handle} A wrapper Handle. When the wrapper Handle's `destroy` method is invoked, the original handle is\n\t *                   removed from the instance, and its `destroy` method is invoked.\n\t */\n\town(handle: Handle): Handle {\n\t\tconst { handles: _handles } = this;\n\t\t_handles.push(handle);\n\t\treturn {\n\t\t\tdestroy() {\n\t\t\t\t_handles.splice(_handles.indexOf(handle));\n\t\t\t\thandle.destroy();\n\t\t\t}\n\t\t};\n\t}\n\n\t/**\n\t * Destroys all handlers registered for the instance\n\t *\n\t * @returns {Promise<any} A Promise that resolves once all handles have been destroyed\n\t */\n\tdestroy(): Promise<any> {\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.handles.forEach((handle) => {\n\t\t\t\thandle && handle.destroy && handle.destroy();\n\t\t\t});\n\t\t\tthis.destroy = noop;\n\t\t\tthis.own = destroyed;\n\t\t\tresolve(true);\n\t\t});\n\t}\n}\n\nexport default Destroyable;\n","import { Map } from '../shim/Map';\nimport { Evented, EventObject } from '../core/Evented';\nimport { Constructor, InjectorFactory, InjectorItem, RegistryLabel, WidgetBaseInterface } from './interfaces';\nimport { Registry, RegistryEventObject, RegistryItem } from './Registry';\n\nexport type RegistryHandlerEventMap = {\n\tinvalidate: EventObject<'invalidate'>;\n};\n\nexport class RegistryHandler extends Evented<RegistryHandlerEventMap> {\n\tprivate _registry = new Registry();\n\tprivate _registryWidgetLabelMap: Map<Registry, RegistryLabel[]> = new Map();\n\tprivate _registryInjectorLabelMap: Map<Registry, RegistryLabel[]> = new Map();\n\tprotected baseRegistry?: Registry;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.own(this._registry);\n\t\tconst destroy = () => {\n\t\t\tif (this.baseRegistry) {\n\t\t\t\tthis._registryWidgetLabelMap.delete(this.baseRegistry);\n\t\t\t\tthis._registryInjectorLabelMap.delete(this.baseRegistry);\n\t\t\t\tthis.baseRegistry = undefined;\n\t\t\t}\n\t\t};\n\t\tthis.own({ destroy });\n\t}\n\n\tpublic set base(baseRegistry: Registry) {\n\t\tif (this.baseRegistry) {\n\t\t\tthis._registryWidgetLabelMap.delete(this.baseRegistry);\n\t\t\tthis._registryInjectorLabelMap.delete(this.baseRegistry);\n\t\t}\n\t\tthis.baseRegistry = baseRegistry;\n\t}\n\n\tpublic define(label: RegistryLabel, widget: RegistryItem): void {\n\t\tthis._registry.define(label, widget);\n\t}\n\n\tpublic defineInjector(label: RegistryLabel, injector: InjectorFactory): void {\n\t\tthis._registry.defineInjector(label, injector);\n\t}\n\n\tpublic has(label: RegistryLabel): boolean {\n\t\treturn this._registry.has(label) || Boolean(this.baseRegistry && this.baseRegistry.has(label));\n\t}\n\n\tpublic hasInjector(label: RegistryLabel): boolean {\n\t\treturn this._registry.hasInjector(label) || Boolean(this.baseRegistry && this.baseRegistry.hasInjector(label));\n\t}\n\n\tpublic get<T extends WidgetBaseInterface = WidgetBaseInterface>(\n\t\tlabel: RegistryLabel,\n\t\tglobalPrecedence: boolean = false\n\t): Constructor<T> | null {\n\t\treturn this._get(label, globalPrecedence, 'get', this._registryWidgetLabelMap);\n\t}\n\n\tpublic getInjector<T>(label: RegistryLabel, globalPrecedence: boolean = false): InjectorItem<T> | null {\n\t\treturn this._get(label, globalPrecedence, 'getInjector', this._registryInjectorLabelMap);\n\t}\n\n\tprivate _get(\n\t\tlabel: RegistryLabel,\n\t\tglobalPrecedence: boolean,\n\t\tgetFunctionName: 'getInjector' | 'get',\n\t\tlabelMap: Map<Registry, RegistryLabel[]>\n\t): any {\n\t\tconst registries = globalPrecedence ? [this.baseRegistry, this._registry] : [this._registry, this.baseRegistry];\n\t\tfor (let i = 0; i < registries.length; i++) {\n\t\t\tconst registry: any = registries[i];\n\t\t\tif (!registry) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst item = registry[getFunctionName](label);\n\t\t\tconst registeredLabels = labelMap.get(registry) || [];\n\t\t\tif (item) {\n\t\t\t\treturn item;\n\t\t\t} else if (registeredLabels.indexOf(label) === -1) {\n\t\t\t\tconst handle = registry.on(label, (event: RegistryEventObject) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\tevent.action === 'loaded' &&\n\t\t\t\t\t\t(this as any)[getFunctionName](label, globalPrecedence) === event.item\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.emit({ type: 'invalidate' });\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.own(handle);\n\t\t\t\tlabelMap.set(registry, [...registeredLabels, label]);\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}\n\nexport default RegistryHandler;\n","import { Evented, EventObject } from '../core/Evented';\nimport Map from '../shim/Map';\nimport { NodeHandlerInterface } from './interfaces';\n\n/**\n * Enum to identify the type of event.\n * Listening to 'Projector' will notify when projector is created or updated\n * Listening to 'Widget' will notify when widget root is created or updated\n */\nexport enum NodeEventType {\n\tProjector = 'Projector',\n\tWidget = 'Widget'\n}\n\nexport type NodeHandlerEventMap = {\n\tProjector: EventObject<NodeEventType.Projector>;\n\tWidget: EventObject<NodeEventType.Widget>;\n};\n\nexport class NodeHandler extends Evented<NodeHandlerEventMap> implements NodeHandlerInterface {\n\tprivate _nodeMap = new Map<string, Element>();\n\n\tpublic get(key: string): Element | undefined {\n\t\treturn this._nodeMap.get(key);\n\t}\n\n\tpublic has(key: string): boolean {\n\t\treturn this._nodeMap.has(key);\n\t}\n\n\tpublic add(element: Element, key: string): void {\n\t\tthis._nodeMap.set(key, element);\n\t\tthis.emit({ type: key });\n\t}\n\n\tpublic addRoot(): void {\n\t\tthis.emit({ type: NodeEventType.Widget });\n\t}\n\n\tpublic addProjector(): void {\n\t\tthis.emit({ type: NodeEventType.Projector });\n\t}\n\n\tpublic clear(): void {\n\t\tthis._nodeMap.clear();\n\t}\n}\n\nexport default NodeHandler;\n","import { Registry } from '../widget-core/Registry';\nimport { RegistryLabel } from '../widget-core/interfaces';\n\nimport { Router } from './Router';\nimport { RouteConfig, RouterOptions } from './interfaces';\n\n/**\n * Router Injector Options\n *\n */\nexport interface RouterInjectorOptions extends RouterOptions {\n\tkey?: RegistryLabel;\n}\n\n/**\n * Creates a router instance for a specific History manager (default is `HashHistory`) and registers\n * the route configuration.\n *\n * @param config The route config to register for the router\n * @param registry An optional registry that defaults to the global registry\n * @param options The router injector options\n */\nexport function registerRouterInjector(\n\tconfig: RouteConfig[],\n\tregistry: Registry,\n\toptions: RouterInjectorOptions = {}\n): Router {\n\tconst { key = 'router', ...routerOptions } = options;\n\n\tif (registry.hasInjector(key)) {\n\t\tthrow new Error('Router has already been defined');\n\t}\n\tconst router = new Router(config, routerOptions);\n\tregistry.defineInjector(key, (invalidator: () => void) => {\n\t\trouter.on('nav', () => invalidator());\n\t\treturn () => router;\n\t});\n\treturn router;\n}\n","import QueuingEvented from '../core/QueuingEvented';\nimport { RouteConfig, History, OutletContext, Params, RouterInterface, Route, RouterOptions } from './interfaces';\nimport { HashHistory } from './history/HashHistory';\nimport { EventObject } from '../core/Evented';\n\nconst PARAM = '__PARAM__';\n\nconst paramRegExp = new RegExp(/^{.+}$/);\n\ninterface RouteWrapper {\n\troute: Route;\n\tsegments: string[];\n\tparent?: RouteWrapper;\n\ttype?: string;\n\tparams: Params;\n}\n\nexport interface NavEvent extends EventObject<string> {\n\toutlet?: string;\n\tcontext?: OutletContext;\n}\n\nexport interface OutletEvent extends EventObject<string> {\n\toutlet: OutletContext;\n\taction: 'enter' | 'exit';\n}\n\nconst ROUTE_SEGMENT_SCORE = 7;\nconst DYNAMIC_SEGMENT_PENALTY = 2;\n\nfunction matchingParams({ params: previousParams }: OutletContext, { params }: OutletContext) {\n\tconst matching = Object.keys(previousParams).every((key) => previousParams[key] === params[key]);\n\tif (!matching) {\n\t\treturn false;\n\t}\n\treturn Object.keys(params).every((key) => previousParams[key] === params[key]);\n}\n\nexport class Router extends QueuingEvented<{ nav: NavEvent; outlet: OutletEvent }> implements RouterInterface {\n\tprivate _routes: Route[] = [];\n\tprivate _outletMap: { [index: string]: Route } = Object.create(null);\n\tprivate _matchedOutlets: { [index: string]: OutletContext } = Object.create(null);\n\tprivate _currentParams: Params = {};\n\tprivate _currentQueryParams: Params = {};\n\tprivate _defaultOutlet: string | undefined;\n\tprivate _history: History;\n\n\tconstructor(config: RouteConfig[], options: RouterOptions = {}) {\n\t\tsuper();\n\t\tconst { HistoryManager = HashHistory, base, window } = options;\n\t\tthis._register(config);\n\t\tthis._history = new HistoryManager({ onChange: this._onChange, base, window });\n\t\tif (this._matchedOutlets.errorOutlet && this._defaultOutlet) {\n\t\t\tconst path = this.link(this._defaultOutlet);\n\t\t\tif (path) {\n\t\t\t\tthis.setPath(path);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Sets the path against the registered history manager\n\t *\n\t * @param path The path to set on the history manager\n\t */\n\tpublic setPath(path: string): void {\n\t\tthis._history.set(path);\n\t}\n\n\t/**\n\t * Generate a link for a given outlet identifier and optional params.\n\t *\n\t * @param outlet The outlet to generate a link for\n\t * @param params Optional Params for the generated link\n\t */\n\tpublic link(outlet: string, params: Params = {}): string | undefined {\n\t\tconst { _outletMap, _currentParams, _currentQueryParams } = this;\n\t\tlet route = _outletMap[outlet];\n\t\tif (route === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet linkPath: string | undefined = route.fullPath;\n\t\tif (route.fullQueryParams.length > 0) {\n\t\t\tlet queryString = route.fullQueryParams.reduce((queryParamString, param, index) => {\n\t\t\t\tif (index > 0) {\n\t\t\t\t\treturn `${queryParamString}&${param}={${param}}`;\n\t\t\t\t}\n\t\t\t\treturn `?${param}={${param}}`;\n\t\t\t}, '');\n\t\t\tlinkPath = `${linkPath}${queryString}`;\n\t\t}\n\t\tparams = { ...route.defaultParams, ..._currentQueryParams, ..._currentParams, ...params };\n\n\t\tif (Object.keys(params).length === 0 && route.fullParams.length > 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst fullParams = [...route.fullParams, ...route.fullQueryParams];\n\t\tfor (let i = 0; i < fullParams.length; i++) {\n\t\t\tconst param = fullParams[i];\n\t\t\tif (params[param]) {\n\t\t\t\tlinkPath = linkPath.replace(`{${param}}`, params[param]);\n\t\t\t} else {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\t\treturn this._history.prefix(linkPath);\n\t}\n\n\t/**\n\t * Returns the outlet context for the outlet identifier if one has been matched\n\t *\n\t * @param outletIdentifier The outlet identifer\n\t */\n\tpublic getOutlet(outletIdentifier: string): OutletContext | undefined {\n\t\treturn this._matchedOutlets[outletIdentifier];\n\t}\n\n\t/**\n\t * Returns all the params for the current matched outlets\n\t */\n\tpublic get currentParams() {\n\t\treturn this._currentParams;\n\t}\n\n\t/**\n\t * Strips the leading slash on a path if one exists\n\t *\n\t * @param path The path to strip a leading slash\n\t */\n\tprivate _stripLeadingSlash(path: string): string {\n\t\tif (path[0] === '/') {\n\t\t\treturn path.slice(1);\n\t\t}\n\t\treturn path;\n\t}\n\n\t/**\n\t * Registers the routing configuration\n\t *\n\t * @param config The configuration\n\t * @param routes The routes\n\t * @param parentRoute The parent route\n\t */\n\tprivate _register(config: RouteConfig[], routes?: Route[], parentRoute?: Route): void {\n\t\troutes = routes ? routes : this._routes;\n\t\tfor (let i = 0; i < config.length; i++) {\n\t\t\tlet { path, outlet, children, defaultRoute = false, defaultParams = {} } = config[i];\n\t\t\tlet [parsedPath, queryParamString] = path.split('?');\n\t\t\tlet queryParams: string[] = [];\n\t\t\tparsedPath = this._stripLeadingSlash(parsedPath);\n\n\t\t\tconst segments: string[] = parsedPath.split('/');\n\t\t\tconst route: Route = {\n\t\t\t\tparams: [],\n\t\t\t\toutlet,\n\t\t\t\tpath: parsedPath,\n\t\t\t\tsegments,\n\t\t\t\tdefaultParams: parentRoute ? { ...parentRoute.defaultParams, ...defaultParams } : defaultParams,\n\t\t\t\tchildren: [],\n\t\t\t\tfullPath: parentRoute ? `${parentRoute.fullPath}/${parsedPath}` : parsedPath,\n\t\t\t\tfullParams: [],\n\t\t\t\tfullQueryParams: [],\n\t\t\t\tscore: parentRoute ? parentRoute.score : 0\n\t\t\t};\n\t\t\tif (defaultRoute) {\n\t\t\t\tthis._defaultOutlet = outlet;\n\t\t\t}\n\t\t\tfor (let i = 0; i < segments.length; i++) {\n\t\t\t\tconst segment = segments[i];\n\t\t\t\troute.score += ROUTE_SEGMENT_SCORE;\n\t\t\t\tif (paramRegExp.test(segment)) {\n\t\t\t\t\troute.score -= DYNAMIC_SEGMENT_PENALTY;\n\t\t\t\t\troute.params.push(segment.replace('{', '').replace('}', ''));\n\t\t\t\t\tsegments[i] = PARAM;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (queryParamString) {\n\t\t\t\tqueryParams = queryParamString.split('&').map((queryParam) => {\n\t\t\t\t\treturn queryParam.replace('{', '').replace('}', '');\n\t\t\t\t});\n\t\t\t}\n\t\t\troute.fullQueryParams = parentRoute ? [...parentRoute.fullQueryParams, ...queryParams] : queryParams;\n\n\t\t\troute.fullParams = parentRoute ? [...parentRoute.fullParams, ...route.params] : route.params;\n\n\t\t\tif (children && children.length > 0) {\n\t\t\t\tthis._register(children, route.children, route);\n\t\t\t}\n\t\t\tthis._outletMap[outlet] = route;\n\t\t\troutes.push(route);\n\t\t}\n\t}\n\n\t/**\n\t * Returns an object of query params\n\t *\n\t * @param queryParamString The string of query params, e.g `paramOne=one&paramTwo=two`\n\t */\n\tprivate _getQueryParams(queryParamString?: string): { [index: string]: string } {\n\t\tconst queryParams: { [index: string]: string } = {};\n\t\tif (queryParamString) {\n\t\t\tconst queryParameters = queryParamString.split('&');\n\t\t\tfor (let i = 0; i < queryParameters.length; i++) {\n\t\t\t\tconst [key, value] = queryParameters[i].split('=');\n\t\t\t\tqueryParams[key] = value;\n\t\t\t}\n\t\t}\n\t\treturn queryParams;\n\t}\n\n\t/**\n\t * Called on change of the route by the the registered history manager. Matches the path against\n\t * the registered outlets.\n\t *\n\t * @param requestedPath The path of the requested route\n\t */\n\tprivate _onChange = (requestedPath: string): void => {\n\t\trequestedPath = this._stripLeadingSlash(requestedPath);\n\t\tconst previousMatchedOutlets = this._matchedOutlets;\n\t\tthis._matchedOutlets = Object.create(null);\n\t\tconst [path, queryParamString] = requestedPath.split('?');\n\t\tthis._currentQueryParams = this._getQueryParams(queryParamString);\n\t\tconst segments = path.split('/');\n\t\tlet routeConfigs: RouteWrapper[] = this._routes.map((route) => ({\n\t\t\troute,\n\t\t\tsegments: [...segments],\n\t\t\tparent: undefined,\n\t\t\tparams: {}\n\t\t}));\n\t\tlet routeConfig: RouteWrapper | undefined;\n\t\tlet matchedRoutes: RouteWrapper[] = [];\n\t\twhile ((routeConfig = routeConfigs.pop())) {\n\t\t\tconst { route, parent, segments, params } = routeConfig;\n\t\t\tlet segmentIndex = 0;\n\t\t\tlet type = 'index';\n\t\t\tlet paramIndex = 0;\n\t\t\tlet routeMatch = true;\n\t\t\tif (segments.length < route.segments.length) {\n\t\t\t\trouteMatch = false;\n\t\t\t} else {\n\t\t\t\twhile (segments.length > 0) {\n\t\t\t\t\tif (route.segments[segmentIndex] === undefined) {\n\t\t\t\t\t\ttype = 'partial';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tconst segment = segments.shift()!;\n\t\t\t\t\tif (route.segments[segmentIndex] === PARAM) {\n\t\t\t\t\t\tparams[route.params[paramIndex++]] = segment;\n\t\t\t\t\t\tthis._currentParams = { ...this._currentParams, ...params };\n\t\t\t\t\t} else if (route.segments[segmentIndex] !== segment) {\n\t\t\t\t\t\trouteMatch = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsegmentIndex++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (routeMatch) {\n\t\t\t\trouteConfig.type = type;\n\t\t\t\tmatchedRoutes.push({ route, parent, type, params, segments: [] });\n\t\t\t\tif (segments.length) {\n\t\t\t\t\trouteConfigs = [\n\t\t\t\t\t\t...routeConfigs,\n\t\t\t\t\t\t...route.children.map((childRoute) => ({\n\t\t\t\t\t\t\troute: childRoute,\n\t\t\t\t\t\t\tsegments: [...segments],\n\t\t\t\t\t\t\tparent: routeConfig,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\tparams: { ...params }\n\t\t\t\t\t\t}))\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet matchedOutletName: string | undefined = undefined;\n\t\tlet matchedRoute: any = matchedRoutes.reduce((match: any, matchedRoute: any) => {\n\t\t\tif (!match) {\n\t\t\t\treturn matchedRoute;\n\t\t\t}\n\t\t\tif (match.route.score > matchedRoute.route.score) {\n\t\t\t\treturn match;\n\t\t\t}\n\t\t\treturn matchedRoute;\n\t\t}, undefined);\n\n\t\tif (matchedRoute) {\n\t\t\tif (matchedRoute.type === 'partial') {\n\t\t\t\tmatchedRoute.type = 'error';\n\t\t\t}\n\t\t\tmatchedOutletName = matchedRoute.route.outlet;\n\t\t\twhile (matchedRoute) {\n\t\t\t\tlet { type, params, parent, route } = matchedRoute;\n\t\t\t\tconst matchedOutlet = {\n\t\t\t\t\tid: route.outlet,\n\t\t\t\t\tqueryParams: this._currentQueryParams,\n\t\t\t\t\tparams,\n\t\t\t\t\ttype,\n\t\t\t\t\tisError: () => type === 'error',\n\t\t\t\t\tisExact: () => type === 'index'\n\t\t\t\t};\n\t\t\t\tconst previousMatchedOutlet = previousMatchedOutlets[route.outlet];\n\t\t\t\tthis._matchedOutlets[route.outlet] = matchedOutlet;\n\t\t\t\tif (!previousMatchedOutlet || !matchingParams(previousMatchedOutlet, matchedOutlet)) {\n\t\t\t\t\tthis.emit({ type: 'outlet', outlet: matchedOutlet, action: 'enter' });\n\t\t\t\t}\n\t\t\t\tmatchedRoute = parent;\n\t\t\t}\n\t\t} else {\n\t\t\tthis._matchedOutlets.errorOutlet = {\n\t\t\t\tid: 'errorOutlet',\n\t\t\t\tqueryParams: {},\n\t\t\t\tparams: {},\n\t\t\t\tisError: () => true,\n\t\t\t\tisExact: () => false,\n\t\t\t\ttype: 'error'\n\t\t\t};\n\t\t}\n\n\t\tconst previousMatchedOutletKeys = Object.keys(previousMatchedOutlets);\n\t\tfor (let i = 0; i < previousMatchedOutletKeys.length; i++) {\n\t\t\tconst key = previousMatchedOutletKeys[i];\n\t\t\tconst matchedOutlet = this._matchedOutlets[key];\n\t\t\tif (!matchedOutlet || !matchingParams(previousMatchedOutlets[key], matchedOutlet)) {\n\t\t\t\tthis.emit({ type: 'outlet', outlet: previousMatchedOutlets[key], action: 'exit' });\n\t\t\t}\n\t\t}\n\t\tthis.emit({\n\t\t\ttype: 'nav',\n\t\t\toutlet: matchedOutletName,\n\t\t\tcontext: matchedOutletName ? this._matchedOutlets[matchedOutletName] : undefined\n\t\t});\n\t};\n}\n\nexport default Router;\n","import Map from '../shim/Map';\nimport Evented, { CustomEventTypes, isGlobMatch, EventedCallbackOrArray, EventType, EventObject } from './Evented';\nimport { Handle } from './Destroyable';\n\n/**\n * An implementation of the Evented class that queues up events when no listeners are\n * listening. When a listener is subscribed, the queue will be published to the listener.\n * When the queue is full, the oldest events will be discarded to make room for the newest ones.\n *\n * @property maxEvents  The number of events to queue before old events are discarded. If zero (default), an unlimited number of events is queued.\n */\nclass QueuingEvented<\n\tM extends CustomEventTypes = {},\n\tT = EventType,\n\tO extends EventObject<T> = EventObject<T>\n> extends Evented<M, T, O> {\n\tprivate _queue: Map<string | symbol, EventObject[]> = new Map();\n\n\tpublic maxEvents = 0;\n\n\temit<K extends keyof M>(event: M[K]): void;\n\temit(event: O): void;\n\temit(event: any): void {\n\t\tsuper.emit(event);\n\n\t\tlet hasMatch = false;\n\n\t\tthis.listenersMap.forEach((method, type) => {\n\t\t\t// Since `type` is generic, the compiler doesn't know what type it is and `isGlobMatch` requires `string | symbol`\n\t\t\tif (isGlobMatch(type as any, event.type)) {\n\t\t\t\thasMatch = true;\n\t\t\t}\n\t\t});\n\n\t\tif (!hasMatch) {\n\t\t\tlet queue = this._queue.get(event.type);\n\n\t\t\tif (!queue) {\n\t\t\t\tqueue = [];\n\t\t\t\tthis._queue.set(event.type, queue);\n\t\t\t}\n\n\t\t\tqueue.push(event);\n\n\t\t\tif (this.maxEvents > 0) {\n\t\t\t\twhile (queue.length > this.maxEvents) {\n\t\t\t\t\tqueue.shift();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\ton<K extends keyof M>(type: K, listener: EventedCallbackOrArray<K, M[K]>): Handle;\n\ton(type: T, listener: EventedCallbackOrArray<T, O>): Handle;\n\ton(type: any, listener: EventedCallbackOrArray<any, any>): Handle {\n\t\tlet handle = super.on(type, listener);\n\n\t\tthis.listenersMap.forEach((method, listenerType) => {\n\t\t\tthis._queue.forEach((events, queuedType) => {\n\t\t\t\tif (isGlobMatch(listenerType as any, queuedType)) {\n\t\t\t\t\tevents.forEach((event) => this.emit(event));\n\t\t\t\t\tthis._queue.delete(queuedType);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn handle;\n\t}\n}\n\nexport default QueuingEvented;\n","import global from '../../shim/global';\nimport { History, HistoryOptions, OnChangeFunction } from './../interfaces';\n\nexport class HashHistory implements History {\n\tprivate _onChangeFunction: OnChangeFunction;\n\tprivate _current: string;\n\tprivate _window: Window;\n\n\tconstructor({ window = global.window, onChange }: HistoryOptions) {\n\t\tthis._onChangeFunction = onChange;\n\t\tthis._window = window;\n\t\tthis._window.addEventListener('hashchange', this._onChange, false);\n\t\tthis._current = this.normalizePath(this._window.location.hash);\n\t\tthis._onChangeFunction(this._current);\n\t}\n\n\tpublic normalizePath(path: string): string {\n\t\treturn path.replace('#', '');\n\t}\n\n\tpublic prefix(path: string) {\n\t\tif (path[0] !== '#') {\n\t\t\treturn `#${path}`;\n\t\t}\n\t\treturn path;\n\t}\n\n\tpublic set(path: string) {\n\t\tthis._window.location.hash = this.prefix(path);\n\t\tthis._onChange();\n\t}\n\n\tpublic get current(): string {\n\t\treturn this._current;\n\t}\n\n\tpublic destroy() {\n\t\tthis._window.removeEventListener('hashchange', this._onChange);\n\t}\n\n\tprivate _onChange = () => {\n\t\tconst path = this.normalizePath(this._window.location.hash);\n\t\tif (path !== this._current) {\n\t\t\tthis._current = path;\n\t\t\tthis._onChangeFunction(this._current);\n\t\t}\n\t};\n}\n\nexport default HashHistory;\n","import Map from '@dojo/framework/shim/Map';\nimport { uuid } from '@dojo/framework/core/util';\nimport WidgetBase from '@dojo/framework/widget-core/WidgetBase';\nimport { ThemedMixin, theme } from '@dojo/framework/widget-core/mixins/Themed';\nimport { w, v } from '@dojo/framework/widget-core/d';\nimport Outlet from '@dojo/framework/routing/Outlet';\nimport { MatchDetails } from '@dojo/framework/routing/interfaces';\n\nimport TodoHeader from './TodoHeader';\nimport TodoList from './TodoList';\nimport TodoFooter from './TodoFooter';\n\nimport * as css from './styles/todoApp.m.css';\n\nexport interface Todo {\n\tid: string;\n\tlabel: string;\n\tcompleted: boolean;\n\tediting?: boolean;\n}\n\n@theme(css)\nexport default class TodoApp extends ThemedMixin(WidgetBase) {\n\n\tprivate todos: Map<string, Todo> = new Map<string, Todo>();\n\tprivate todoItem = '';\n\tprivate completedCount = 0;\n\tprivate updated: string = uuid();\n\n\tprotected render() {\n\t\tconst { todoItem, updateTodo, updated, todos, completedCount, clearCompleted, editTodo, removeTodo, toggleTodo, toggleAllTodos } = this;\n\t\tconst allCompleted = todos.size !== 0 && completedCount === todos.size;\n\t\tconst activeCount = todos.size - completedCount;\n\t\tconst completedItems = completedCount > 0;\n\n\t\treturn v('section', { classes: this.theme(css.todoapp) }, [\n\t\t\tw(TodoHeader, { value: todoItem, updateTodo, allCompleted, addTodo: this.setTodo, toggleAllTodos }),\n\t\t\tv('section', [\n\t\t\t\tw(Outlet, { id: 'filter', renderer: (match: MatchDetails) => {\n\t\t\t\t\treturn w(TodoList, { updated, todos, editTodo, removeTodo, toggleTodo, updateTodo: this.setTodo, activeFilter: match.params.filter });\n\t\t\t\t} })\n\t\t\t]),\n\t\t\ttodos.size ? w(TodoFooter, { clearCompleted, activeCount, completedItems }) : null\n\t\t]);\n\t}\n\n\tprivate removeTodo = (id: string) => {\n\t\tconst todo = this.todos.get(id);\n\t\tif (todo) {\n\t\t\tthis.todos.delete(id);\n\t\t\ttodo.completed && --this.completedCount;\n\t\t\tthis.onUpdate();\n\t\t}\n\t}\n\n\tprivate toggleTodo = (id: string) => {\n\t\tconst todo = this.todos.get(id);\n\t\tif (todo) {\n\t\t\tconst completed = !todo.completed;\n\t\t\tcompleted ? ++this.completedCount : --this.completedCount;\n\t\t\tthis.setTodo({ completed }, id);\n\t\t}\n\t}\n\n\tprivate toggleAllTodos = () => {\n\t\tconst completed = this.completedCount !== this.todos.size;\n\t\tthis.todos.forEach((todo, key) => {\n\t\t\tthis.setTodo({ completed }, key);\n\t\t});\n\t\tthis.completedCount = completed ? this.todos.size : 0;\n\t\tthis.onUpdate();\n\t}\n\n\tprivate editTodo = (id: string) => {\n\t\tconst todo = this.todos.get(id);\n\t\tif (todo) {\n\t\t\tthis.setTodo({ editing: true}, id);\n\t\t\tthis.onUpdate();\n\t\t}\n\t}\n\n\tprivate clearCompleted = () => {\n\t\tthis.todos.forEach((todo, key) => {\n\t\t\tif (todo.completed) {\n\t\t\t\tthis.todos.delete(key);\n\t\t\t}\n\t\t});\n\t\tthis.completedCount = 0;\n\t\tthis.onUpdate();\n\t}\n\n\tprivate updateTodo = (todo: string) => {\n\t\tthis.todoItem = todo;\n\t\tthis.invalidate();\n\t}\n\n\tprivate setTodo = (todo: Partial<Todo>, id?: string) => {\n\t\tif (!id) {\n\t\t\tid = uuid();\n\t\t\tthis.todoItem = '';\n\t\t}\n\t\tif (todo.label) {\n\t\t\ttodo.label = todo.label.trim();\n\t\t\tif (!todo.label) {\n\t\t\t\tthis.removeTodo(id);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis.todos.set(id, { id,  ...this.todos.get(id)!, ...todo });\n\t\tthis.onUpdate();\n\t}\n\n\tprivate onUpdate = () => {\n\t\tthis.updated = uuid();\n\t\tthis.invalidate();\n\t}\n}\n","import { Handle } from './Destroyable';\n\nconst slice = Array.prototype.slice;\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\n/**\n * Type guard that ensures that the value can be coerced to Object\n * to weed out host objects that do not derive from Object.\n * This function is used to check if we want to deep copy an object or not.\n * Note: In ES6 it is possible to modify an object's Symbol.toStringTag property, which will\n * change the value returned by `toString`. This is a rare edge case that is difficult to handle,\n * so it is not handled here.\n * @param  value The value to check\n * @return       If the value is coercible into an Object\n */\nfunction shouldDeepCopyObject(value: any): value is Object {\n\treturn Object.prototype.toString.call(value) === '[object Object]';\n}\n\nfunction copyArray<T>(array: T[], inherited: boolean): T[] {\n\treturn array.map(function(item: T): T {\n\t\tif (Array.isArray(item)) {\n\t\t\treturn copyArray(item, inherited) as any;\n\t\t}\n\n\t\treturn !shouldDeepCopyObject(item)\n\t\t\t? item\n\t\t\t: _mixin({\n\t\t\t\t\tdeep: true,\n\t\t\t\t\tinherited: inherited,\n\t\t\t\t\tsources: <Array<T>>[item],\n\t\t\t\t\ttarget: <T>{}\n\t\t\t  });\n\t});\n}\n\ninterface MixinArgs<T extends {}, U extends {}> {\n\tdeep: boolean;\n\tinherited: boolean;\n\tsources: (U | null | undefined)[];\n\ttarget: T;\n\tcopied?: any[];\n}\n\nfunction _mixin<T extends {}, U extends {}>(kwArgs: MixinArgs<T, U>): T & U {\n\tconst deep = kwArgs.deep;\n\tconst inherited = kwArgs.inherited;\n\tconst target: any = kwArgs.target;\n\tconst copied = kwArgs.copied || [];\n\tconst copiedClone = [...copied];\n\n\tfor (let i = 0; i < kwArgs.sources.length; i++) {\n\t\tconst source = kwArgs.sources[i];\n\n\t\tif (source === null || source === undefined) {\n\t\t\tcontinue;\n\t\t}\n\t\tfor (let key in source) {\n\t\t\tif (inherited || hasOwnProperty.call(source, key)) {\n\t\t\t\tlet value: any = source[key];\n\n\t\t\t\tif (copiedClone.indexOf(value) !== -1) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (deep) {\n\t\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\t\tvalue = copyArray(value, inherited);\n\t\t\t\t\t} else if (shouldDeepCopyObject(value)) {\n\t\t\t\t\t\tconst targetValue: any = target[key] || {};\n\t\t\t\t\t\tcopied.push(source);\n\t\t\t\t\t\tvalue = _mixin({\n\t\t\t\t\t\t\tdeep: true,\n\t\t\t\t\t\t\tinherited: inherited,\n\t\t\t\t\t\t\tsources: [value],\n\t\t\t\t\t\t\ttarget: targetValue,\n\t\t\t\t\t\t\tcopied\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttarget[key] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn <T & U>target;\n}\n\n/**\n * Copies the values of all enumerable own properties of one or more source objects to the target object,\n * recursively copying all nested objects and arrays as well.\n *\n * @param target The target object to receive values from source objects\n * @param sources Any number of objects whose enumerable own properties will be copied to the target object\n * @return The modified target object\n */\nexport function deepAssign<\n\tT extends {},\n\tU extends {},\n\tV extends {},\n\tW extends {},\n\tX extends {},\n\tY extends {},\n\tZ extends {}\n>(target: T, source1: U, source2: V, source3: W, source4: X, source5: Y, source6: Z): T & U & V & W & X & Y & Z;\nexport function deepAssign<T extends {}, U extends {}, V extends {}, W extends {}, X extends {}, Y extends {}>(\n\ttarget: T,\n\tsource1: U,\n\tsource2: V,\n\tsource3: W,\n\tsource4: X,\n\tsource5: Y\n): T & U & V & W & X & Y;\nexport function deepAssign<T extends {}, U extends {}, V extends {}, W extends {}, X extends {}>(\n\ttarget: T,\n\tsource1: U,\n\tsource2: V,\n\tsource3: W,\n\tsource4: X\n): T & U & V & W & X;\nexport function deepAssign<T extends {}, U extends {}, V extends {}, W extends {}>(\n\ttarget: T,\n\tsource1: U,\n\tsource2: V,\n\tsource3: W\n): T & U & V & W;\nexport function deepAssign<T extends {}, U extends {}, V extends {}>(target: T, source1: U, source2: V): T & U & V;\nexport function deepAssign<T extends {}, U extends {}>(target: T, source: U): T & U;\nexport function deepAssign(target: any, ...sources: any[]): any {\n\treturn _mixin({\n\t\tdeep: true,\n\t\tinherited: false,\n\t\tsources: sources,\n\t\ttarget: target\n\t});\n}\n\n/**\n * Copies the values of all enumerable (own or inherited) properties of one or more source objects to the\n * target object, recursively copying all nested objects and arrays as well.\n *\n * @param target The target object to receive values from source objects\n * @param sources Any number of objects whose enumerable properties will be copied to the target object\n * @return The modified target object\n */\nexport function deepMixin<\n\tT extends {},\n\tU extends {},\n\tV extends {},\n\tW extends {},\n\tX extends {},\n\tY extends {},\n\tZ extends {}\n>(target: T, source1: U, source2: V, source3: W, source4: X, source5: Y, source6: Z): T & U & V & W & X & Y & Z;\nexport function deepMixin<T extends {}, U extends {}, V extends {}, W extends {}, X extends {}, Y extends {}>(\n\ttarget: T,\n\tsource1: U,\n\tsource2: V,\n\tsource3: W,\n\tsource4: X,\n\tsource5: Y\n): T & U & V & W & X & Y;\nexport function deepMixin<T extends {}, U extends {}, V extends {}, W extends {}, X extends {}>(\n\ttarget: T,\n\tsource1: U,\n\tsource2: V,\n\tsource3: W,\n\tsource4: X\n): T & U & V & W & X;\nexport function deepMixin<T extends {}, U extends {}, V extends {}, W extends {}>(\n\ttarget: T,\n\tsource1: U,\n\tsource2: V,\n\tsource3: W\n): T & U & V & W;\nexport function deepMixin<T extends {}, U extends {}, V extends {}>(target: T, source1: U, source2: V): T & U & V;\nexport function deepMixin<T extends {}, U extends {}>(target: T, source: U): T & U;\nexport function deepMixin(target: any, ...sources: any[]): any {\n\treturn _mixin({\n\t\tdeep: true,\n\t\tinherited: true,\n\t\tsources: sources,\n\t\ttarget: target\n\t});\n}\n\n/**\n * Copies the values of all enumerable (own or inherited) properties of one or more source objects to the\n * target object.\n *\n * @return The modified target object\n */\nexport function mixin<T extends {}, U extends {}, V extends {}, W extends {}, X extends {}, Y extends {}, Z extends {}>(\n\ttarget: T,\n\tsource1: U,\n\tsource2: V,\n\tsource3: W,\n\tsource4: X,\n\tsource5: Y,\n\tsource6: Z\n): T & U & V & W & X & Y & Z;\nexport function mixin<T extends {}, U extends {}, V extends {}, W extends {}, X extends {}, Y extends {}>(\n\ttarget: T,\n\tsource1: U,\n\tsource2: V,\n\tsource3: W,\n\tsource4: X,\n\tsource5: Y\n): T & U & V & W & X & Y;\nexport function mixin<T extends {}, U extends {}, V extends {}, W extends {}, X extends {}>(\n\ttarget: T,\n\tsource1: U,\n\tsource2: V,\n\tsource3: W,\n\tsource4: X\n): T & U & V & W & X;\nexport function mixin<T extends {}, U extends {}, V extends {}, W extends {}>(\n\ttarget: T,\n\tsource1: U,\n\tsource2: V,\n\tsource3: W\n): T & U & V & W;\nexport function mixin<T extends {}, U extends {}, V extends {}>(target: T, source1: U, source2: V): T & U & V;\nexport function mixin<T extends {}, U extends {}>(target: T, source: U): T & U;\nexport function mixin(target: any, ...sources: any[]): any {\n\treturn _mixin({\n\t\tdeep: false,\n\t\tinherited: true,\n\t\tsources: sources,\n\t\ttarget: target\n\t});\n}\n\n/**\n * Returns a function which invokes the given function with the given arguments prepended to its argument list.\n * Like `Function.prototype.bind`, but does not alter execution context.\n *\n * @param targetFunction The function that needs to be bound\n * @param suppliedArgs An optional array of arguments to prepend to the `targetFunction` arguments list\n * @return The bound function\n */\nexport function partial(targetFunction: (...args: any[]) => any, ...suppliedArgs: any[]): (...args: any[]) => any {\n\treturn function(this: any) {\n\t\tconst args: any[] = arguments.length ? suppliedArgs.concat(slice.call(arguments)) : suppliedArgs;\n\n\t\treturn targetFunction.apply(this, args);\n\t};\n}\n\nexport function guaranteeMinimumTimeout(callback: (...args: any[]) => void, delay?: number): Handle {\n\tconst startTime = Date.now();\n\tlet timerId: any;\n\n\tfunction timeoutHandler() {\n\t\tconst delta = Date.now() - startTime;\n\t\tif (delay == null || delta >= delay) {\n\t\t\tcallback();\n\t\t} else {\n\t\t\ttimerId = setTimeout(timeoutHandler, delay - delta);\n\t\t}\n\t}\n\ttimerId = setTimeout(timeoutHandler, delay);\n\treturn {\n\t\tdestroy: () => {\n\t\t\tif (timerId != null) {\n\t\t\t\tclearTimeout(timerId);\n\t\t\t\ttimerId = null;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport function debounce<T extends (this: any, ...args: any[]) => void>(callback: T, delay: number): T {\n\tlet timer: Handle | null;\n\n\treturn <T>function() {\n\t\ttimer && timer.destroy();\n\n\t\tlet context = this;\n\t\tlet args: IArguments | null = arguments;\n\n\t\ttimer = guaranteeMinimumTimeout(function() {\n\t\t\tcallback.apply(context, args);\n\t\t\targs = context = timer = null;\n\t\t}, delay);\n\t};\n}\n\nexport function throttle<T extends (this: any, ...args: any[]) => void>(callback: T, delay: number): T {\n\tlet ran: boolean | null;\n\n\treturn <T>function() {\n\t\tif (ran) {\n\t\t\treturn;\n\t\t}\n\n\t\tran = true;\n\n\t\tcallback.apply(this, arguments);\n\t\tguaranteeMinimumTimeout(function() {\n\t\t\tran = null;\n\t\t}, delay);\n\t};\n}\n\nexport function uuid(): string {\n\treturn 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n\t\tconst r = (Math.random() * 16) | 0,\n\t\t\tv = c === 'x' ? r : (r & 0x3) | 0x8;\n\t\treturn v.toString(16);\n\t});\n}\n","import { Evented, EventObject } from '../core/Evented';\n\nexport type InjectorEventMap = {\n\tinvalidate: EventObject<'invalidate'>;\n};\n\nexport class Injector<T = any> extends Evented<InjectorEventMap> {\n\tprivate _payload: T;\n\tprivate _invalidator: undefined | (() => void);\n\n\tconstructor(payload: T) {\n\t\tsuper();\n\t\tthis._payload = payload;\n\t}\n\n\tpublic setInvalidator(invalidator: () => void) {\n\t\tthis._invalidator = invalidator;\n\t}\n\n\tpublic get(): T {\n\t\treturn this._payload;\n\t}\n\n\tpublic set(payload: T): void {\n\t\tthis._payload = payload;\n\t\tif (this._invalidator) {\n\t\t\tthis._invalidator();\n\t\t}\n\t}\n}\n\nexport default Injector;\n","import WeakMap from '../../shim/WeakMap';\nimport { WidgetBase } from './../WidgetBase';\nimport { handleDecorator } from './handleDecorator';\nimport { beforeProperties } from './beforeProperties';\nimport { InjectorItem, RegistryLabel } from './../interfaces';\n\n/**\n * Map of instances against registered injectors.\n */\nconst registeredInjectorsMap: WeakMap<WidgetBase, InjectorItem[]> = new WeakMap();\n\n/**\n * Defines the contract requires for the get properties function\n * used to map the injected properties.\n */\nexport interface GetProperties<T = any> {\n\t(payload: any, properties: T): T;\n}\n\n/**\n * Defines the inject configuration required for use of the `inject` decorator\n */\nexport interface InjectConfig {\n\t/**\n\t * The label of the registry injector\n\t */\n\tname: RegistryLabel;\n\n\t/**\n\t * Function that returns propertues to inject using the passed properties\n\t * and the injected payload.\n\t */\n\tgetProperties: GetProperties;\n}\n\n/**\n * Decorator retrieves an injector from an available registry using the name and\n * calls the `getProperties` function with the payload from the injector\n * and current properties with the the injected properties returned.\n *\n * @param InjectConfig the inject configuration\n */\nexport function inject({ name, getProperties }: InjectConfig) {\n\treturn handleDecorator((target, propertyKey) => {\n\t\tbeforeProperties(function(this: WidgetBase & { own: Function }, properties: any) {\n\t\t\tconst injectorItem = this.registry.getInjector(name);\n\t\t\tif (injectorItem) {\n\t\t\t\tconst { injector, invalidator } = injectorItem;\n\t\t\t\tconst registeredInjectors = registeredInjectorsMap.get(this) || [];\n\t\t\t\tif (registeredInjectors.length === 0) {\n\t\t\t\t\tregisteredInjectorsMap.set(this, registeredInjectors);\n\t\t\t\t}\n\t\t\t\tif (registeredInjectors.indexOf(injectorItem) === -1) {\n\t\t\t\t\tthis.own(\n\t\t\t\t\t\tinvalidator.on('invalidate', () => {\n\t\t\t\t\t\t\tthis.invalidate();\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t\tregisteredInjectors.push(injectorItem);\n\t\t\t\t}\n\t\t\t\treturn getProperties(injector(), properties);\n\t\t\t}\n\t\t})(target);\n\t});\n}\n\nexport default inject;\n","import { WidgetBase } from './../WidgetBase';\nimport { handleDecorator } from './handleDecorator';\nimport { beforeProperties } from './beforeProperties';\n\nexport function alwaysRender() {\n\treturn handleDecorator((target, propertyKey) => {\n\t\tbeforeProperties(function(this: WidgetBase) {\n\t\t\tthis.invalidate();\n\t\t})(target);\n\t});\n}\n\nexport default alwaysRender;\n","import WidgetBase from '@dojo/framework/widget-core/WidgetBase';\nimport { ThemedMixin, theme } from '@dojo/framework/widget-core/mixins/Themed';\nimport { v } from '@dojo/framework/widget-core/d';\n\nimport * as css from './styles/todoHeader.m.css';\n\nexport interface TodoHeaderProperties {\n\tallCompleted: boolean;\n\taddTodo: Function;\n\ttoggleAllTodos: Function;\n\tupdateTodo: Function;\n\tvalue: string;\n}\n\n@theme(css)\nexport default class TodoHeader extends ThemedMixin(WidgetBase)<TodoHeaderProperties> {\n\n\tprotected render() {\n\t\tconst { properties: { value, allCompleted } } = this;\n\t\tconst newTodoProperties: any = {\n\t\t\tkey: 'new-todo',\n\t\t\tfocus: true,\n\t\t\tclasses: this.theme(css.newTodo),\n\t\t\tonkeyup: this.addTodo,\n\t\t\toninput: this.updateTodo,\n\t\t\tvalue,\n\t\t\tplaceholder: 'What needs to be done?'\n\t\t};\n\n\t\treturn v('header', [\n\t\t\tv('h1', { classes: this.theme(css.title) }, [ 'todos' ]),\n\t\t\tv('input', newTodoProperties),\n\t\t\tv('input', { onchange: this.toggleAllTodos, checked: allCompleted, type: 'checkbox', classes: this.theme(css.toggleAll) })\n\t\t]);\n\t}\n\n\tprivate addTodo({ which, target: { value: label } }: any) {\n\t\tif (which === 13 && label) {\n\t\t\tthis.properties.addTodo({ label, completed: false });\n\t\t}\n\t}\n\n\tprivate updateTodo({ target: { value } }: any) {\n\t\tthis.properties.updateTodo(value);\n\t}\n\n\tprivate toggleAllTodos() {\n\t\tthis.properties.toggleAllTodos();\n\t}\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\" _key\":\"dojo2-todo-mvc/todoHeader\",\"title\":\"todoHeader-m__title__3tjiT\",\"newTodo\":\"todoHeader-m__newTodo__3Rwh3\",\"toggleAll\":\"todoHeader-m__toggleAll__15rbk\"};","import Map from '@dojo/framework/shim/Map';\nimport { from as arrayFrom } from '@dojo/framework/shim/array';\nimport WidgetBase from '@dojo/framework/widget-core/WidgetBase';\nimport { ThemedMixin, theme } from '@dojo/framework/widget-core/mixins/Themed';\nimport { Outlet } from '@dojo/framework/routing/Outlet';\n\nimport { v, w } from '@dojo/framework/widget-core/d';\nimport { Todo } from './TodoApp';\nimport TodoItem from './TodoItem';\n\nimport * as css from './styles/todoList.m.css';\n\nexport interface TodoListProperties {\n\ttodos: Map<string, Todo>;\n\tupdated: string;\n\tactiveFilter?: string;\n\ttoggleTodo: Function;\n\tremoveTodo: Function;\n\teditTodo: Function;\n\tupdateTodo: Function;\n}\n\nfunction filter(filterName: string = 'all', todo: Todo): boolean {\n\tswitch (filterName) {\n\t\tcase 'completed':\n\t\t\treturn !!todo.completed;\n\t\tcase 'active':\n\t\t\treturn !todo.completed;\n\t\tdefault:\n\t\t\treturn true;\n\t}\n}\n\n@theme(css)\nexport default class TodoList extends ThemedMixin(WidgetBase)<TodoListProperties> {\n\tprotected render() {\n\t\tconst { activeFilter, todos, toggleTodo, editTodo, updateTodo, removeTodo } = this.properties;\n\t\tconst todoItems = arrayFrom(todos.entries()).filter(([ , value ]) => filter(activeFilter, value));\n\n\t\treturn v('ul', { classes: this.theme(css.todoList) }, todoItems.map(([ key, todo ]) => {\n\t\t\treturn w(TodoItem, { key, todo, toggleTodo, editTodo, removeTodo, updateTodo });\n\t\t}));\n\t}\n}\n","import global from './global';\nimport { isArrayLike, isIterable, Iterable } from './iterator';\nimport { MAX_SAFE_INTEGER } from './number';\nimport has from '../has/has';\nimport { wrapNative } from './support/util';\n\nexport interface MapCallback<T, U> {\n\t/**\n\t * A callback function when mapping\n\t *\n\t * @param element The element that is currently being mapped\n\t * @param index The current index of the element\n\t */\n\t(element: T, index: number): U;\n}\n\nexport interface FindCallback<T> {\n\t/**\n\t * A callback function when using find\n\t *\n\t * @param element The element that is currenty being analysed\n\t * @param index The current index of the element that is being analysed\n\t * @param array The source array\n\t */\n\t(element: T, index: number, array: ArrayLike<T>): boolean;\n}\n\ninterface WritableArrayLike<T> {\n\treadonly length: number;\n\t[n: number]: T;\n}\n\n/* ES6 Array static methods */\n\nexport interface From {\n\t/**\n\t * The Array.from() method creates a new Array instance from an array-like or iterable object.\n\t *\n\t * @param source An array-like or iterable object to convert to an array\n\t * @param mapFunction A map function to call on each element in the array\n\t * @param thisArg The execution context for the map function\n\t * @return The new Array\n\t */\n\t<T, U>(source: ArrayLike<T> | Iterable<T>, mapFunction: MapCallback<T, U>, thisArg?: any): Array<U>;\n\n\t/**\n\t * The Array.from() method creates a new Array instance from an array-like or iterable object.\n\t *\n\t * @param source An array-like or iterable object to convert to an array\n\t * @return The new Array\n\t */\n\t<T>(source: ArrayLike<T> | Iterable<T>): Array<T>;\n}\n\nexport let from: From;\n\n/**\n * Creates a new array from the function parameters.\n *\n * @param arguments Any number of arguments for the array\n * @return An array from the given arguments\n */\nexport let of: <T>(...items: T[]) => Array<T>;\n\n/* ES6 Array instance methods */\n\n/**\n * Copies data internally within an array or array-like object.\n *\n * @param target The target array-like object\n * @param offset The index to start copying values to; if negative, it counts backwards from length\n * @param start The first (inclusive) index to copy; if negative, it counts backwards from length\n * @param end The last (exclusive) index to copy; if negative, it counts backwards from length\n * @return The target\n */\nexport let copyWithin: <T>(target: ArrayLike<T>, offset: number, start: number, end?: number) => ArrayLike<T>;\n\n/**\n * Fills elements of an array-like object with the specified value.\n *\n * @param target The target to fill\n * @param value The value to fill each element of the target with\n * @param start The first index to fill\n * @param end The (exclusive) index at which to stop filling\n * @return The filled target\n */\nexport let fill: <T>(target: ArrayLike<T>, value: T, start?: number, end?: number) => ArrayLike<T>;\n\n/**\n * Finds and returns the first instance matching the callback or undefined if one is not found.\n *\n * @param target An array-like object\n * @param callback A function returning if the current value matches a criteria\n * @param thisArg The execution context for the find function\n * @return The first element matching the callback, or undefined if one does not exist\n */\nexport let find: <T>(target: ArrayLike<T>, callback: FindCallback<T>, thisArg?: {}) => T | undefined;\n\n/**\n * Performs a linear search and returns the first index whose value satisfies the passed callback,\n * or -1 if no values satisfy it.\n *\n * @param target An array-like object\n * @param callback A function returning true if the current value satisfies its criteria\n * @param thisArg The execution context for the find function\n * @return The first index whose value satisfies the passed callback, or -1 if no values satisfy it\n */\nexport let findIndex: <T>(target: ArrayLike<T>, callback: FindCallback<T>, thisArg?: {}) => number;\n\n/* ES7 Array instance methods */\n\n/**\n * Determines whether an array includes a given value\n *\n * @param target the target array-like object\n * @param searchElement the item to search for\n * @param fromIndex the starting index to search from\n * @return `true` if the array includes the element, otherwise `false`\n */\nexport let includes: <T>(target: ArrayLike<T>, searchElement: T, fromIndex?: number) => boolean;\n\nif (has('es6-array') && has('es6-array-fill')) {\n\tfrom = global.Array.from;\n\tof = global.Array.of;\n\tcopyWithin = wrapNative(global.Array.prototype.copyWithin);\n\tfill = wrapNative(global.Array.prototype.fill);\n\tfind = wrapNative(global.Array.prototype.find);\n\tfindIndex = wrapNative(global.Array.prototype.findIndex);\n} else {\n\t// It is only older versions of Safari/iOS that have a bad fill implementation and so aren't in the wild\n\t// To make things easier, if there is a bad fill implementation, the whole set of functions will be filled\n\n\t/**\n\t * Ensures a non-negative, non-infinite, safe integer.\n\t *\n\t * @param length The number to validate\n\t * @return A proper length\n\t */\n\tconst toLength = function toLength(length: number): number {\n\t\tif (isNaN(length)) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tlength = Number(length);\n\t\tif (isFinite(length)) {\n\t\t\tlength = Math.floor(length);\n\t\t}\n\t\t// Ensure a non-negative, real, safe integer\n\t\treturn Math.min(Math.max(length, 0), MAX_SAFE_INTEGER);\n\t};\n\n\t/**\n\t * From ES6 7.1.4 ToInteger()\n\t *\n\t * @param value A value to convert\n\t * @return An integer\n\t */\n\tconst toInteger = function toInteger(value: any): number {\n\t\tvalue = Number(value);\n\t\tif (isNaN(value)) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (value === 0 || !isFinite(value)) {\n\t\t\treturn value;\n\t\t}\n\n\t\treturn (value > 0 ? 1 : -1) * Math.floor(Math.abs(value));\n\t};\n\n\t/**\n\t * Normalizes an offset against a given length, wrapping it if negative.\n\t *\n\t * @param value The original offset\n\t * @param length The total length to normalize against\n\t * @return If negative, provide a distance from the end (length); otherwise provide a distance from 0\n\t */\n\tconst normalizeOffset = function normalizeOffset(value: number, length: number): number {\n\t\treturn value < 0 ? Math.max(length + value, 0) : Math.min(value, length);\n\t};\n\n\tfrom = function from(\n\t\tthis: ArrayConstructor,\n\t\tarrayLike: Iterable<any> | ArrayLike<any>,\n\t\tmapFunction?: MapCallback<any, any>,\n\t\tthisArg?: any\n\t): Array<any> {\n\t\tif (arrayLike == null) {\n\t\t\tthrow new TypeError('from: requires an array-like object');\n\t\t}\n\n\t\tif (mapFunction && thisArg) {\n\t\t\tmapFunction = mapFunction.bind(thisArg);\n\t\t}\n\n\t\t/* tslint:disable-next-line:variable-name */\n\t\tconst Constructor = this;\n\t\tconst length: number = toLength((arrayLike as any).length);\n\n\t\t// Support extension\n\t\tconst array: any[] =\n\t\t\ttypeof Constructor === 'function' ? <any[]>Object(new Constructor(length)) : new Array(length);\n\n\t\tif (!isArrayLike(arrayLike) && !isIterable(arrayLike)) {\n\t\t\treturn array;\n\t\t}\n\n\t\t// if this is an array and the normalized length is 0, just return an empty array. this prevents a problem\n\t\t// with the iteration on IE when using a NaN array length.\n\t\tif (isArrayLike(arrayLike)) {\n\t\t\tif (length === 0) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < arrayLike.length; i++) {\n\t\t\t\tarray[i] = mapFunction ? mapFunction(arrayLike[i], i) : arrayLike[i];\n\t\t\t}\n\t\t} else {\n\t\t\tlet i = 0;\n\t\t\tfor (const value of arrayLike) {\n\t\t\t\tarray[i] = mapFunction ? mapFunction(value, i) : value;\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\n\t\tif ((arrayLike as any).length !== undefined) {\n\t\t\tarray.length = length;\n\t\t}\n\n\t\treturn array;\n\t};\n\n\tof = function of<T>(...items: T[]): Array<T> {\n\t\treturn Array.prototype.slice.call(items);\n\t};\n\n\tcopyWithin = function copyWithin<T>(\n\t\ttarget: ArrayLike<T>,\n\t\toffset: number,\n\t\tstart: number,\n\t\tend?: number\n\t): ArrayLike<T> {\n\t\tif (target == null) {\n\t\t\tthrow new TypeError('copyWithin: target must be an array-like object');\n\t\t}\n\n\t\tconst length = toLength(target.length);\n\t\toffset = normalizeOffset(toInteger(offset), length);\n\t\tstart = normalizeOffset(toInteger(start), length);\n\t\tend = normalizeOffset(end === undefined ? length : toInteger(end), length);\n\t\tlet count = Math.min(end - start, length - offset);\n\n\t\tlet direction = 1;\n\t\tif (offset > start && offset < start + count) {\n\t\t\tdirection = -1;\n\t\t\tstart += count - 1;\n\t\t\toffset += count - 1;\n\t\t}\n\n\t\twhile (count > 0) {\n\t\t\tif (start in target) {\n\t\t\t\t(target as WritableArrayLike<T>)[offset] = target[start];\n\t\t\t} else {\n\t\t\t\tdelete (target as WritableArrayLike<T>)[offset];\n\t\t\t}\n\n\t\t\toffset += direction;\n\t\t\tstart += direction;\n\t\t\tcount--;\n\t\t}\n\n\t\treturn target;\n\t};\n\n\tfill = function fill<T>(target: ArrayLike<T>, value: any, start?: number, end?: number): ArrayLike<T> {\n\t\tconst length = toLength(target.length);\n\t\tlet i = normalizeOffset(toInteger(start), length);\n\t\tend = normalizeOffset(end === undefined ? length : toInteger(end), length);\n\n\t\twhile (i < end) {\n\t\t\t(target as WritableArrayLike<T>)[i++] = value;\n\t\t}\n\n\t\treturn target;\n\t};\n\n\tfind = function find<T>(target: ArrayLike<T>, callback: FindCallback<T>, thisArg?: {}): T | undefined {\n\t\tconst index = findIndex<T>(target, callback, thisArg);\n\t\treturn index !== -1 ? target[index] : undefined;\n\t};\n\n\tfindIndex = function findIndex<T>(target: ArrayLike<T>, callback: FindCallback<T>, thisArg?: {}): number {\n\t\tconst length = toLength(target.length);\n\n\t\tif (!callback) {\n\t\t\tthrow new TypeError('find: second argument must be a function');\n\t\t}\n\n\t\tif (thisArg) {\n\t\t\tcallback = callback.bind(thisArg);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tif (callback(target[i], i, target)) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t};\n}\n\nif (has('es7-array')) {\n\tincludes = wrapNative(global.Array.prototype.includes);\n} else {\n\t/**\n\t * Ensures a non-negative, non-infinite, safe integer.\n\t *\n\t * @param length The number to validate\n\t * @return A proper length\n\t */\n\tconst toLength = function toLength(length: number): number {\n\t\tlength = Number(length);\n\t\tif (isNaN(length)) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (isFinite(length)) {\n\t\t\tlength = Math.floor(length);\n\t\t}\n\t\t// Ensure a non-negative, real, safe integer\n\t\treturn Math.min(Math.max(length, 0), MAX_SAFE_INTEGER);\n\t};\n\n\tincludes = function includes<T>(target: ArrayLike<T>, searchElement: T, fromIndex: number = 0): boolean {\n\t\tlet len = toLength(target.length);\n\n\t\tfor (let i = fromIndex; i < len; ++i) {\n\t\t\tconst currentElement = target[i];\n\t\t\tif (\n\t\t\t\tsearchElement === currentElement ||\n\t\t\t\t(searchElement !== searchElement && currentElement !== currentElement)\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n}\n","import global from './global';\n\n/**\n * The smallest interval between two representable numbers.\n */\nexport const EPSILON = 1;\n\n/**\n * The maximum safe integer in JavaScript\n */\nexport const MAX_SAFE_INTEGER = Math.pow(2, 53) - 1;\n\n/**\n * The minimum safe integer in JavaScript\n */\nexport const MIN_SAFE_INTEGER = -MAX_SAFE_INTEGER;\n\n/**\n * Determines whether the passed value is NaN without coersion.\n *\n * @param value The value to test\n * @return true if the value is NaN, false if it is not\n */\nexport function isNaN(value: any): boolean {\n\treturn typeof value === 'number' && global.isNaN(value);\n}\n\n/**\n * Determines whether the passed value is a finite number without coersion.\n *\n * @param value The value to test\n * @return true if the value is finite, false if it is not\n */\nexport function isFinite(value: any): value is number {\n\treturn typeof value === 'number' && global.isFinite(value);\n}\n\n/**\n * Determines whether the passed value is an integer.\n *\n * @param value The value to test\n * @return true if the value is an integer, false if it is not\n */\nexport function isInteger(value: any): value is number {\n\treturn isFinite(value) && Math.floor(value) === value;\n}\n\n/**\n * Determines whether the passed value is an integer that is 'safe,' meaning:\n *   1. it can be expressed as an IEEE-754 double precision number\n *   2. it has a one-to-one mapping to a mathematical integer, meaning its\n *      IEEE-754 representation cannot be the result of rounding any other\n *      integer to fit the IEEE-754 representation\n *\n * @param value The value to test\n * @return true if the value is an integer, false if it is not\n */\nexport function isSafeInteger(value: any): value is number {\n\treturn isInteger(value) && Math.abs(value) <= MAX_SAFE_INTEGER;\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\" _key\":\"dojo2-todo-mvc/todoList\",\"todoList\":\"todoList-m__todoList___yRMt\"};","\nmodule.exports = function () {\n\treturn new Promise(function (resolve) {\n\trequire.ensure([], function (require) {\n\t\tresolve(require(\"!!../../node_modules/@dojo/webpack-contrib/static-build-loader/index.js??ref--10-0!../../node_modules/umd-compat-loader/index.js??ref--10-1!../../node_modules/ts-loader/index.js??ref--10-2!../../node_modules/tslint-loader/index.js??ref--6!../../node_modules/@dojo/webpack-contrib/css-module-dts-loader/index.js?type=ts&instanceName=0_dojo!./TodoItem.ts\"));\n\t}, \"lazy\");\n\t});\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\" _key\":\"dojo2-todo-mvc/todoApp\",\"todoapp\":\"todoApp-m__todoapp__2CgWv\",\"main\":\"todoApp-m__main__1O82E\"};","\nmodule.exports = function () {\n\treturn new Promise(function (resolve) {\n\trequire.ensure([], function (require) {\n\t\tresolve(require(\"!!../../node_modules/@dojo/webpack-contrib/static-build-loader/index.js??ref--10-0!../../node_modules/umd-compat-loader/index.js??ref--10-1!../../node_modules/ts-loader/index.js??ref--10-2!../../node_modules/tslint-loader/index.js??ref--6!../../node_modules/@dojo/webpack-contrib/css-module-dts-loader/index.js?type=ts&instanceName=0_dojo!./TodoFooter.ts\"));\n\t}, \"lazy\");\n\t});\n}"],"sourceRoot":""}